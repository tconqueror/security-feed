# Phần mềm độc hại Godfather trên Android giờ đây sử dụng ảo hóa để chiếm đoạt ứng dụng ngân hàng

![Android](https://www.bleepstatic.com/content/hl-images/2023/11/29/android-in-a-container.jpg)

Một phiên bản mới của phần mềm độc hại Android "Godfather" tạo ra các môi trường ảo hóa biệt lập trên các thiết bị di động nhằm đánh cắp dữ liệu tài khoản và giao dịch từ các ứng dụng ngân hàng hợp pháp.

Những ứng dụng độc hại này được thực hiện bên trong một môi trường ảo hóa được kiểm soát trên thiết bị, cho phép theo dõi theo thời gian thực, đánh cắp thông tin xác thực và thao tác giao dịch trong khi vẫn duy trì được sự đánh lừa hoàn hảo về hình ảnh.

Chiến thuật này tương tự như chiến thuật đã thấy trong phần mềm độc hại Android [FjordPhantom](https://www.bleepingcomputer.com/news/security/fjordphantom-android-malware-uses-virtualization-to-evade-detection/) vào cuối năm 2023, cũng đã sử dụng công nghệ ảo hóa để thực hiện các ứng dụng ngân hàng SEA bên trong các container nhằm né tránh phát hiện.

Tuy nhiên, phạm vi mục tiêu của Godfather rộng hơn nhiều, nhắm vào hơn 500 ứng dụng ngân hàng, tiền điện tử và thương mại điện tử trên toàn cầu bằng cách sử dụng một hệ thống tệp ảo đầy đủ, ID quy trình ảo, giả mạo ý định (intent spoofing) và StubActivity.

Theo [Zimperium](https://zimperium.com/blog/your-mobile-app-their-playground-the-dark-side-of-the-virtualization), tổ chức đã phân tích nó, mức độ đánh lừa rất cao. Người dùng thấy giao diện ứng dụng thật, và các biện pháp bảo vệ của Android không xác định được khía cạnh hoạt động độc hại, vì chỉ các hoạt động của ứng dụng chủ (host app) mới được khai báo trong manifest.

## Đánh cắp dữ liệu ảo hóa

Godfather xuất hiện dưới dạng một ứng dụng APK chứa một khung ảo hóa nhúng, tận dụng các công cụ mã nguồn mở như engine VirtualApp và Xposed để gắn kết (hooking).

Khi đã hoạt động trên thiết bị, nó kiểm tra các ứng dụng mục tiêu đã được cài đặt, và nếu tìm thấy, nó sẽ đặt chúng vào trong môi trường ảo của mình và sử dụng một StubActivity để khởi động chúng bên trong container chủ.

StubActivity là một hoạt động placeholder được khai báo trong ứng dụng đang chạy engine ảo hóa (phần mềm độc hại) mà hoạt động như một shell hoặc proxy để khởi chạy và thực thi các hoạt động từ các ứng dụng ảo hóa.

Nó không chứa giao diện người dùng (UI) hoặc logic của riêng mình mà thay vào đó, ủy quyền hành vi cho ứng dụng chủ, lừa Android nghĩ rằng một ứng dụng hợp pháp đang được chạy trong khi thực tế đang bị chặn và kiểm soát.

![Tạo môi trường ảo hóa](https://www.bleepstatic.com/images/news/u/1220909/2025/June/creating-env.jpg)

**Tạo môi trường ảo hóa**  
_Nguồn: Zimperium_

Khi nạn nhân khởi động ứng dụng ngân hàng thật, quyền truy cập dịch vụ của Godfather sẽ chặn 'Intent' và chuyển hướng đến một StubActivity bên trong ứng dụng chủ, khởi động phiên bản ảo của ứng dụng ngân hàng bên trong container.

Người dùng thấy giao diện của ứng dụng thật, nhưng tất cả dữ liệu nhạy cảm liên quan đến các tương tác của họ có thể dễ dàng bị đánh cắp.

Bằng cách sử dụng Xposed để gắn kết API, Godfather có thể ghi lại thông tin xác thực tài khoản, mật khẩu, mã PIN, các sự kiện chạm và thu thập phản hồi từ backend ngân hàng.

![Móc mạng được sử dụng bởi Godfather](https://www.bleepstatic.com/images/news/u/1220909/2025/June/network-hooks.jpg)

**Móc mạng được sử dụng bởi Godfather**  
_Nguồn: Zimperium_

Phần mềm độc hại này hiển thị một lớp màn hình khóa giả vào những thời điểm quan trọng để khiến nạn nhân nhập mã PIN/mật khẩu của họ.

Khi đã thu thập và xuất khẩu tất cả dữ liệu đó, nó chờ lệnh từ những kẻ vận hành để mở khóa thiết bị, thực hiện điều hướng UI, mở ứng dụng, và kích hoạt thanh toán/chuyển khoản từ bên trong ứng dụng ngân hàng thật.

Trong suốt quá trình này, người dùng thấy một màn hình "cập nhật" giả hoặc một màn hình đen để không làm dấy lên nghi ngờ của họ.

## Mối đe dọa đang phát triển

Godfather lần đầu xuất hiện trong không gian phần mềm độc hại Android vào tháng 3 năm 2021, được phát hiện bởi ThreatFabric, và đã theo một quỹ đạo tiến hóa ấn tượng kể từ đó.

Phiên bản Godfather mới nhất là một sự tiến hóa đáng kể so với mẫu lần trước được [Group-IB](https://www.bleepingcomputer.com/news/security/godfather-android-malware-targets-400-banks-crypto-exchanges/) phân tích vào tháng 12 năm 2022, đã nhắm vào 400 ứng dụng và 16 quốc gia sử dụng các lớp màn hình đăng nhập HTML trên các ứng dụng ngân hàng và trao đổi tiền điện tử.

Mặc dù chiến dịch mà Zimperium phát hiện chỉ nhắm vào một tá ứng dụng ngân hàng Thổ Nhĩ Kỳ, các kẻ vận hành Godfather khác có thể tùy chọn kích hoạt các tập hợp con khác của 500 ứng dụng mà chúng đang nhắm đến để tấn công các khu vực khác nhau.

Để bảo vệ bản thân khỏi phần mềm độc hại này, chỉ tải các ứng dụng từ Google Play hoặc APK từ các nhà phát hành mà bạn tin tưởng, đảm bảo rằng Play Protect đang hoạt động và chú ý đến các quyền yêu cầu.