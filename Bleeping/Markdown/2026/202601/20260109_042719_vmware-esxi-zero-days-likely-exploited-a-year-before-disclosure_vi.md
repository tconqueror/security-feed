# VMware ESXi zero-days có khả năng bị khai thác một năm trước khi công bố

![VMware ESXi zero-days có khả năng bị khai thác một năm trước khi công bố](https://www.bleepstatic.com/content/hl-images/2025/03/04/VMware.jpg)

Các nhóm mối đe dọa nói tiếng Trung đã sử dụng một thiết bị SonicWall VPN bị xâm nhập để phân phối một bộ công cụ khai thác VMware ESXi dường như được phát triển hơn một năm trước khi các lỗ hổng bị nhắm tới được công khai.

Trong các cuộc tấn công từ tháng 12 năm 2025 được phân tích bởi Huntress, công ty bảo mật được quản lý, các hacker đã sử dụng một kỹ thuật thoát khỏi máy ảo (VM escape) tinh vi có khả năng khai thác ba lỗ hổng VMware được tiết lộ là zero-day vào tháng 3 năm 2025.

Trong ba lỗi này, chỉ có một lỗi nhận được điểm nghiêm trọng là "critical":

[![Wiz](https://www.bleepstatic.com/c/w/wiz/Securing-AI-Agents-970x250.png)](https://www.wiz.io/lp/securing-ai-agents-101?utm%5Fsource=bleepingcomputer&utm%5Fmedium=display&utm%5Fcampaign=FY26Q3%5FINB%5FFORM%5FSecuring-AI-Agents-101&sfcid=701Py00000RTEWMIA5&utm%5Fterm=FY26Q4-bleepingcomputer-970x250&utm%5Fcontent=AIAgents101) 

* **CVE-2025-22226** (7.1 severity score): Một lỗi đọc vượt giới hạn (out-of-bounds read) trong HGFS cho phép rò rỉ bộ nhớ từ tiến trình VMX
* **CVE-2025-22224** (9.3 severity score): Một lỗ hổng TOCTOU trong Virtual Machine Communication Interface (VMCI) dẫn đến ghi vượt giới hạn (out-of-bounds write), cho phép thực thi mã với quyền của tiến trình VMX
* **CVE-2025-22225** (8.2 severity score): Một lỗ hổng ghi tùy ý (arbitrary write) trong ESXi cho phép thoát khỏi sandbox của VMX lên kernel

Tại thời điểm công bố, [Broadcom đã cảnh báo](https://www.bleepingcomputer.com/news/security/broadcom-fixes-three-vmware-zero-days-exploited-in-attacks/) rằng các vấn đề bảo mật có thể bị chuỗi lại bởi kẻ tấn công có quyền administrator để thoát khỏi VM và truy cập vào hypervisor nền tảng.

Tuy nhiên, một báo cáo mới từ Huntress cung cấp manh mối cho thấy các lỗ hổng có thể đã được xâu chuỗi thành một exploit ít nhất từ tháng 2 năm 2024.

Các nhà nghiên cứu đã tìm thấy trong các PDB path của các nhị phân khai thác một thư mục tên "2024_02_19", gợi ý rằng gói công cụ được phát triển như một khả năng exploit zero-day.

```
C:\Users\test\Desktop\2024_02_19\全版本逃逸--交付\report\ESXI_8.0u3\
```

Hơn nữa, từ tên thư mục, dịch là "All/Full version escape - delivery", có thể suy ra rằng mục tiêu dự kiến là ESXi 8.0 Update 3\. 

Huntress đánh giá rằng quyền truy cập ban đầu có thể đến thông qua một SonicWall VPN bị xâm nhập. Kẻ tấn công đã sử dụng một tài khoản Domain Admin bị xâm nhập để chuyển hướng qua RDP đến các domain controllers, chuẩn bị dữ liệu để exfiltration, và chạy một chuỗi khai thác phá vỡ từ guest VM sang hypervisor ESXi.

Bộ công cụ khai thác bao gồm các thành phần sau:

* **MAESTRO (exploit.exe)** – Điều phối VM escape bằng cách vô hiệu hóa các thiết bị VMware VMCI, tải driver exploit chưa ký bằng KDU, theo dõi thành công của exploit, và khôi phục driver sau đó.
* **MyDriver.sys** – Driver kernel chưa ký thực thi VM escape, bao gồm phát hiện phiên bản ESXi, rò rỉ và hỏng bộ nhớ VMX, thoát sandbox, và triển khai backdoor hypervisor.
* **VSOCKpuppet** – Backdoor ELF chạy trên host ESXi cung cấp thực thi lệnh và truyền file qua VSOCK, vượt qua giám sát mạng truyền thống.
* **GetShell Plugin (client.exe)** – Client VSOCK trên Windows dùng để kết nối từ guest VM tới host ESXi bị xâm nhập và tương tác với backdoor VSOCKpuppet.

![MAESTRO's main function](https://www.bleepstatic.com/images/news/u/1220909/2026/January/maestro.jpg)

**Chức năng chính của MAESTRO**  
_Nguồn: Huntress_

Các nhà nghiên cứu cũng tìm thấy thêm manh mối chỉ ra ngày xây dựng của bộ công cụ. Một PDB path nhúng trong nhị phân 'client.exe' có thư mục tên "2023_11_02."

```
C:\Users\test\Desktop\2023_11_02\vmci_vm_escape\getshell\source\client\x64\Release\client.pdb
```

Rất có thể thành phần này là "phần của một bộ vmci_vm_escape rộng hơn với một thành phần getshell."

Các nhà nghiên cứu tin rằng tác nhân đe dọa có thể có một phương pháp mô-đun, tách các công cụ post-exploitation ra khỏi các exploit. Điều này cho phép họ dùng cùng cơ sở hạ tầng và chỉ chuyển sang các lỗ hổng mới.

Huntress nói với BleepingComputer rằng họ khá tự tin rằng bộ công cụ khai thác tận dụng ba lỗ hổng mà Broadcom đã tiết lộ vào tháng Ba trước đó. Đánh giá của họ dựa trên hành vi của exploit, bao gồm việc sử dụng HGFS cho rò rỉ thông tin, VMCI cho hỏng bộ nhớ, và shellcode thoát lên kernel.

Tuy nhiên, họ không thể xác nhận với độ chắc chắn 100% rằng đó là cùng một phương thức khai thác mà Broadcom đã công bố trong bản thông báo gốc về ba zero-day.

**Luồng khai thác đầy đủ**  
_Nguồn: Huntress_

Về dòng thời gian khai thác và các quan sát liên quan đến attribution, Huntress báo cáo rằng một số đường dẫn build có tiếng Trung giản thể, nhưng cũng có một README bằng tiếng Anh, có thể cho thấy ý định bán hoặc chia sẻ cho các tác nhân đe dọa khác.

Huntress bình luận rằng sự kết hợp này khả dĩ cho thấy bộ công cụ được phát triển bởi một nhà phát triển có nguồn lực tốt hoạt động trong một vùng nói tiếng Trung.

Mặc dù các nhà nghiên cứu rất tự tin rằng SonicWall VPN là vectơ xâm nhập ban đầu, họ khuyến nghị các tổ chức áp dụng các bản cập nhật bảo mật ESXi mới nhất và sử dụng các quy tắc YARA và Sigma được cung cấp để phát hiện sớm.