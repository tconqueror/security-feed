# SAP sửa lỗi zero-day NetWeaver nghi ngờ được khai thác trong các cuộc tấn công

![SAP](https://www.bleepstatic.com/content/hl-images/2022/02/09/SAP.jpg)

SAP đã phát hành các bản cập nhật khẩn cấp NetWeaver ngoài kế hoạch để sửa chữa một lỗ hổng nghi ngờ thực thi mã từ xa (RCE) zero-day đang bị khai thác một cách chủ động để kiểm soát các máy chủ.

Lỗ hổng này, được theo dõi dưới [CVE-2025-31324](https://nvd.nist.gov/vuln/detail/CVE-2025-31324) và được đánh giá là nghiêm trọng (điểm CVSS v3: 10.0), là lỗ hổng tải tệp không xác thực trong SAP NetWeaver Visual Composer, cụ thể là thành phần Metadata Uploader.

Nó cho phép các kẻ tấn công tải lên các tệp thực thi độc hại mà không cần phải đăng nhập, có thể dẫn đến thực thi mã từ xa và làm hỏng toàn bộ hệ thống.

Mặc dù [thông báo của nhà cung cấp](https://me.sap.com/notes/3594142) chưa công khai, ReliaQuest đã báo cáo vào đầu tuần này về một lỗ hổng bị khai thác một cách chủ động trên SAP NetWeaver Visual Composer, cụ thể là điểm cuối '/developmentserver/metadatauploader', phù hợp với CVE-2025-31324.

ReliaQuest [đã báo cáo](http://reliaquest.com/blog/threat-spotlight-reliaquest-uncovers-vulnerability-behind-sap-netweaver-compromise/) rằng nhiều khách hàng đã bị xâm phạm thông qua tải tệp không được phép trên SAP NetWeaver, với các kẻ tấn công đã tải lên các JSP webshell vào các thư mục công khai.

Những lần tải này đã cho phép thực thi mã từ xa qua các yêu cầu GET đơn giản tới các tệp JSP, cho phép thực thi lệnh từ trình duyệt, các hành động quản lý tệp (tải lên/tải xuống), và nhiều hơn nữa.

Trong giai đoạn sau khai thác, các kẻ tấn công đã triển khai công cụ 'Brute Ratel' của đội đỏ, kỹ thuật vượt qua bảo mật 'Heaven's Gate', và tiêm mã biên dịch MSBuild vào dllhost.exe để ẩn danh.

ReliaQuest đã lưu ý trong báo cáo rằng việc khai thác không yêu cầu xác thực và các hệ thống bị xâm phạm đã được vá hoàn toàn, cho thấy rằng chúng đã bị nhắm mục tiêu bởi một lỗ hổng zero-day.

Công ty bảo mật watchTowr cũng đã xác nhận với BleepingComputer rằng họ đang thấy việc khai thác chủ động liên quan đến CVE-2025-31324.

"Các kẻ tấn công không xác thực có thể lợi dụng chức năng tích hợp để tải lên các tệp tùy ý vào một phiên bản SAP NetWeaver, điều này có nghĩa là thực thi mã từ xa hoàn toàn và làm hỏng toàn bộ hệ thống," CEO của watchTowr, Benjamin Harris cho biết.

"watchTowr đang thấy việc khai thác chủ động của các tác nhân đe dọa, người đang sử dụng lỗ hổng này để cài đặt backdoors web shell vào hệ thống bị lộ và có được quyền truy cập thêm."

"Việc khai thác chủ động này trong môi trường và tác động rộng rãi khiến nó rất có khả năng rằng chúng ta sẽ sớm thấy việc khai thác bùng nổ bởi nhiều bên."

BleepingComputer đã liên hệ với SAP với các câu hỏi về việc khai thác chủ động nhưng chưa nhận được phản hồi vào thời điểm này.

## Bảo vệ chống lại các cuộc tấn công ngay bây giờ

Lỗ hổng này ảnh hưởng đến Visual Composer Framework 7.50 và hành động được khuyến nghị là áp dụng bản vá mới nhất.

Cập nhật bảo mật khẩn cấp này đã được phát hành sau bản cập nhật 'tháng 4 năm 2025' thường lệ của SAP ['April 2025' update](https://support.sap.com/en/my-support/knowledge-base/security-notes-news/april-2025.html), vì vậy nếu bạn đã áp dụng bản cập nhật đó vào đầu tháng này (phát hành vào ngày 8 tháng 4 năm 2025), bạn vẫn dễ bị tổn thương với CVE-2025-31324.

Hơn nữa, bản cập nhật khẩn cấp bao gồm các bản sửa cho hai lỗ hổng nghiêm trọng khác, cụ thể là CVE-2025-27429 (tiêm mã vào SAP S/4HANA) và CVE-2025-31330 (tiêm mã vào SAP Landscape Transformation).

Những người không thể áp dụng các bản cập nhật giải quyết CVE-2025-31324 được khuyến nghị thực hiện các biện pháp giảm thiểu sau:

1. Hạn chế quyền truy cập vào điểm cuối /developmentserver/metadatauploader.
2. Nếu Visual Composer không được sử dụng, hãy xem xét tắt hoàn toàn.
3. Chuyển tiếp các nhật ký tới SIEM và quét các tệp không được phép trong đường dẫn servlet.

ReliaQuest khuyến nghị thực hiện quét môi trường sâu để xác định và xóa các tệp nghi ngờ trước khi áp dụng các biện pháp giảm thiểu.