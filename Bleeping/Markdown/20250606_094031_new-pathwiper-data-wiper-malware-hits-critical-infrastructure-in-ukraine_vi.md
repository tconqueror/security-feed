# Phần mềm độc hại wiper PathWiper mới tấn công cơ sở hạ tầng quan trọng ở Ukraine

![Wiper](https://www.bleepstatic.com/content/hl-images/2022/10/07/hacker-hammer-destroying-data.jpg)

Một phần mềm độc hại wiper dữ liệu mới mang tên 'PathWiper' đang được sử dụng trong các cuộc tấn công có mục tiêu vào cơ sở hạ tầng quan trọng ở Ukraine, nhằm gây rối loạn hoạt động trong nước.

Tải trọng được triển khai thông qua một công cụ quản trị điểm cuối hợp pháp, cho thấy rằng các kẻ tấn công đã đạt được quyền truy cập quản trị vào hệ thống thông qua một cuộc xâm phạm trước đó.

Các nhà nghiên cứu của Cisco Talos đã [phát hiện cuộc tấn công](https://blog.talosintelligence.com/pathwiper-targets-ukraine/) đã gán cho nó một độ tin cậy cao với mối đe dọa tiên tiến liên kết với Nga (APT).

Các nhà nghiên cứu so sánh PathWiper với [HermeticWiper](https://www.bleepingcomputer.com/news/security/new-data-wiping-malware-used-in-destructive-attacks-on-ukraine/), trước đây đã được triển khai ở Ukraine bởi nhóm đe dọa 'Sandworm', có chức năng tương tự.

Do đó, PathWiper có thể là một sự phát triển của HermeticWiper, được sử dụng trong các cuộc tấn công bởi cùng một nhóm mối đe dọa hoặc các nhóm chồng chéo.

## Khả năng phá hoại của PathWiper

PathWiper thực thi trên các hệ thống mục tiêu thông qua một tệp batch của Windows khởi động một VBScript độc hại (uacinstall.vbs), từ đó thả và thực thi tải trọng chính (sha256sum.exe) \[[VirusTotal](https://www.virustotal.com/gui/file/7c792a2b005b240d30a6e22ef98b991744856f9ab55c74df220f32fe0d00b6b3)\].

Quá trình thực thi bắt chước hành vi và tên gọi liên quan đến một công cụ quản trị hợp pháp để tránh bị phát hiện.

Thay vì chỉ liệt kê các ổ đĩa vật lý như HermeticWiper, PathWiper xác định một cách có chương trình tất cả các ổ đĩa được kết nối (cục bộ, mạng, không gắn) trên hệ thống.

Tiếp theo, nó lạm dụng các API của Windows để tháo các khối lượng để chuẩn bị cho việc hỏng hóc và sau đó tạo các luồng cho mỗi khối lượng để ghi đè lên các cấu trúc NTFS quan trọng.

Trong số các tệp hệ thống có mục tiêu trong thư mục gốc của NTFS có:

* **MBR** (Master Boot Record): Khu vực đầu tiên của một đĩa vật lý chứa bootloader và bảng phân vùng.
* **$MFT** (Master File Table): Tệp hệ thống NTFS cốt lõi catalog tất cả các tệp và thư mục, bao gồm cả siêu dữ liệu và vị trí của chúng trên đĩa.
* **$LogFile**: Nhật ký được sử dụng cho ghi nhật ký giao dịch NTFS, theo dõi thay đổi tệp, và giúp kiểm tra tính toàn vẹn và phục hồi.
* **$Boot**: Tệp chứa thông tin quân thể khởi động và bố cục hệ thống tệp.

PathWiper ghi đè lên các tệp NTFS quan trọng trên đây và năm tệp NTFS quan trọng khác bằng các byte ngẫu nhiên, khiến các hệ thống bị ảnh hưởng hoàn toàn không thể hoạt động.

Các cuộc tấn công quan sát không liên quan đến ép buộc hoặc bất kỳ hình thức yêu cầu tài chính nào, vì vậy mục tiêu duy nhất của chúng là phá hủy và gây rối loạn hoạt động.

Cisco Talos đã công bố các băm tệp và quy tắc snort để giúp phát hiện mối đe dọa và ngăn chặn nó trước khi nó làm hỏng các ổ đĩa.

Các phần mềm wiper đã trở thành một công cụ mạnh mẽ trong các cuộc tấn công vào Ukraine kể từ khi chiến tranh bắt đầu, với các tác nhân đe dọa Nga thường xuyên sử dụng chúng để gây rối loạn các hoạt động quan trọng trong nước.

Điều này bao gồm các phần mềm wiper mang tên [DoubleZero](https://cert.gov.ua/article/38088), [CaddyWiper](https://www.bleepingcomputer.com/news/security/ukraine-sandworm-hackers-hit-news-agency-with-5-data-wipers/), [HermeticWiper](https://www.bleepingcomputer.com/news/security/new-data-wiping-malware-used-in-destructive-attacks-on-ukraine/), [IsaacWiper](https://www.bleepingcomputer.com/news/security/new-worm-and-data-wiper-malware-seen-hitting-ukrainian-networks/), [WhisperKill](https://cip.gov.ua/ua/news/informaciya-shodo-imovirnoyi-provokaciyi), [WhisperGate](https://www.bleepingcomputer.com/news/security/microsoft-fake-ransomware-targets-ukraine-in-data-wiping-attacks/), và [AcidRain](https://www.bleepingcomputer.com/news/security/viasat-confirms-satellite-modems-were-wiped-with-acidrain-malware/).