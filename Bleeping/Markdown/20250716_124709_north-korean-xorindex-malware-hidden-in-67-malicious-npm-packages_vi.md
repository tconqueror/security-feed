# Phần mềm độc XORIndex của Bắc Triều Tiên ẩn trong 67 gói npm độc hại

![Phần mềm độc XORIndex của Bắc Triều Tiên ẩn trong 67 gói npm độc hại](https://www.bleepstatic.com/content/hl-images/2022/07/05/NPM_head_pic.jpg)

Các tác nhân đe dọa Bắc Triều Tiên đã cài đặt 67 gói độc hại trong kho lưu trữ trực tuyến Node Package Manager (npm) để phát tán một loader phần mềm độc mới gọi là XORIndex tới hệ thống của các nhà phát triển.

Các gói này đã có tổng cộng hơn 17.000 lượt tải xuống và được phát hiện bởi các nhà nghiên cứu tại nền tảng bảo mật gói Socket, những người đánh giá chúng là một phần của chiến dịch Contagious Interview đang tiếp diễn.

Các nhà nghiên cứu của Socket cho biết chiến dịch này theo sau các hoạt động đe dọa được phát hiện kể từ tháng Tư. Tháng trước, cùng một đối tượng đã thâm nhập npm với [35 gói](https://www.bleepingcomputer.com/news/security/new-wave-of-fake-interviews-use-35-npm-packages-to-spread-malware/) đã rải các phần mềm đánh cắp thông tin và backdoor vào thiết bị của các lập trình viên.

![Thời gian của các làn sóng tấn công gần đây](https://www.bleepstatic.com/images/news/u/1220909/2025/July/timeline.jpg)

**Thời gian của các làn sóng tấn công gần đây**  
_Nguồn: Socket_

## Tổng quan về các cuộc tấn công

[Contagious Interview](https://www.bleepingcomputer.com/news/security/new-ottercookie-malware-used-to-backdoor-devs-in-fake-job-offers/) là một chiến dịch được nhà nước Bắc Triều Tiên hỗ trợ, nhắm mục tiêu chủ yếu vào các nhà phát triển với những lời mời làm việc giả mạo để lừa họ chạy mã độc trên hệ thống của họ.

Mục đích khác nhau từ việc thu thập thông tin nhạy cảm cho phép xâm nhập vào các công ty tới việc đánh cắp tài sản tiền điện tử.

Node Package Manager (npm) là trình quản lý gói mặc định cho Node.js, một nền tảng mà trên đó các nhà phát triển phát hành và cài đặt các thư viện và công cụ JavaScript. Nó được sử dụng rộng rãi trong phát triển web, nhưng cũng thường xuyên bị các tác nhân đe dọa khai thác để phân phối phần mềm độc hại.

Trong số 67 gói mà các tác nhân đe dọa tải lên npm lần này, có một số gói có vẻ giống như hoặc hòa trộn tên với các dự án và thư viện phần mềm hợp pháp, chẳng hạn như:

* vite-meta-plugin
* vite-postcss-tools
* vite-logging-tool
* vite-proc-log
* pretty-chalk
* postcss-preloader
* js-prettier
* flowframe
* figwrap
* midd-js, middy-js

Khi nạn nhân cài đặt bất kỳ gói nào trong số này, một script ‘postinstall’ sẽ thực thi để khởi động XORIndex Loader, một công cụ mới có vẻ được sử dụng song song với HexEval Loader, một trình phát tán phần mềm độc đã được quan sát trong các cuộc tấn công trước đó.

XORIndex Loader thu thập dữ liệu của máy chủ để lập hồ sơ cho từng nạn nhân và gửi nó đến một địa chỉ command and control (C2) mã hóa sẵn, được lưu trữ trên hạ tầng từ công ty ứng dụng đám mây Vercel.

Máy chủ C2 phản hồi với một hoặc nhiều payload JavaScript, được thực thi trên hệ thống của nạn nhân bằng cách sử dụng eval(). Các payload này thường là backdoor BeaverTail và InvisibleFerret, cả hai đều được gán cho các hoạt động Contagious Interview của Bắc Triều Tiên.

Hai phần mềm độc này cung cấp quyền truy cập vào các máy tính bị xâm phạm, cho phép rò rỉ dữ liệu, và có thể tải xuống nhiều payload hơn.

Theo các nhà nghiên cứu, các hacker Bắc Triều Tiên pha trộn các công cụ cũ và mới với những sửa đổi tinh vi để né tránh phát hiện, và mỗi khi npm loại bỏ một cuộc tấn công, họ quay lại qua các tài khoản npm khác nhau và tên gói khác nhau.

"Các tác nhân đe dọa Contagious Interview sẽ tiếp tục đa dạng hóa danh mục phần mềm độc của họ, luân phiên qua các bí danh maintainer npm mới, tái sử dụng các loader như HexEval Loader và các họ phần mềm độc như BeaverTail và InvisibleFerret, và chủ động triển khai các biến thể mới được quan sát, bao gồm cả XORIndex Loader" - Socket

"Các nhà phòng thủ nên mong đợi sự lặp lại liên tục của những loader này trên các gói mới được xuất bản, thường với những biến thể nhẹ để né tránh phát hiện," các nhà nghiên cứu cảnh báo.

Các nhà nghiên cứu của Socket cho biết họ đã báo cáo tất cả các gói độc hại từ chiến dịch gần đây cho npm nhưng một số trong số chúng có thể vẫn có mặt trong kho lưu trữ.

Điều quan trọng là phải kiểm tra lại các gói nguồn để đảm bảo rằng chúng không phải là những mánh lới đánh lừa, chỉ tin tưởng các dự án và nhà xuất bản nổi tiếng với hồ sơ đã được chứng minh, và kiểm tra hoạt động gần đây của kho lưu trữ để tìm dấu hiệu tự động hóa.

Khi có thể, luôn xem xét mã nguồn để phát hiện sự mã hóa và thực thi các thư viện mới trong môi trường cách ly để đánh giá độ an toàn của chúng.