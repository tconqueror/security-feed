# Malware đánh cắp tiền điện tử NimDoor trên macOS tự phục hồi khi bị tiêu diệt

![Malware đánh cắp tiền điện tử NimDoor trên macOS tự phục hồi khi bị tiêu diệt](https://www.bleepstatic.com/content/hl-images/2023/11/07/North_Korean_hackers.jpg)

Các hacker được chính phủ Bắc Triều Tiên hậu thuẫn đã sử dụng một gia đình malware macOS mới có tên là NimDoor trong một chiến dịch nhắm tới các tổ chức web3 và tiền điện tử.

Các nhà nghiên cứu phân tích các tải trọng phát hiện rằng, kẻ tấn công đã dựa vào các kỹ thuật bất thường và một cơ chế duy trì dựa trên tín hiệu chưa từng thấy.

Chuỗi tấn công, có sự tham gia của việc liên hệ với các nạn nhân qua Telegram và dụ họ chạy một bản cập nhật SDK Zoom giả mạo, được gửi qua Calendly và email, tương tự như chuỗi mà nền tảng bảo mật quản lý Huntress gần đây đã [liên kết tới BlueNoroff](https://www.bleepingcomputer.com/news/security/north-korean-hackers-deepfake-execs-in-zoom-call-to-spread-mac-malware/).

### Malware macOS tiên tiến

Trong một báo cáo hôm nay, các nhà nghiên cứu tại công ty an ninh mạng SentinelOne cho biết, kẻ đe dọa đã sử dụng C++ và các nhị phân biên dịch Nim (tất cả được theo dõi là NimDoor) trên macOS, điều này "là một lựa chọn bất thường hơn."

Một trong những nhị phân biên dịch Nim, _'installer'_, chịu trách nhiệm cho việc thiết lập ban đầu và phân phối, chuẩn bị thư mục và đường dẫn cấu hình. Nó cũng thả hai nhị phân khác - _'GoogIe LLC,' 'CoreKitAgent'_ vào hệ thống của nạn nhân.

GoogIe LLC đảm nhận việc thu thập dữ liệu môi trường và tạo một tệp cấu hình mã hex, ghi vào một đường dẫn tạm thời. Nó thiết lập một LaunchAgent macOS (com.google.update.plist) để duy trì, khởi động lại GoogIe LLC khi đăng nhập và lưu trữ khóa xác thực cho các giai đoạn sau.

Thành phần tiên tiến nhất được sử dụng trong cuộc tấn công là _CoreKitAgent_, tải trọng chính của khung NimDoor, hoạt động như một nhị phân dựa trên sự kiện, sử dụng cơ chế kqueue của macOS để quản lý thực thi một cách không đồng bộ.

Nó triển khai một máy trạng thái 10 trường hợp với bảng chuyển trạng thái mã cứng, cho phép luồng điều khiển linh hoạt dựa trên các điều kiện tại thời điểm chạy.

Tính năng đặc trưng nhất là cơ chế duy trì dựa trên tín hiệu, trong đó nó cài đặt các bộ xử lý tùy chỉnh cho SIGINT và SIGTERM.

![Đăng ký các bộ xử lý tín hiệu tùy chỉnh cho SIGINT và SIGTERM](https://www.bleepstatic.com/images/news/u/1220909/2025/June/handlers.jpg)

**Đăng ký các bộ xử lý tín hiệu tùy chỉnh cho SIGINT và SIGTERM**  
_Nguồn: SentinelLABS_

Đây là các tín hiệu thường được sử dụng để kết thúc các quy trình, nhưng khi một trong hai tín hiệu này bị bắt, CoreKitAgent sẽ kích hoạt một quy trình cài đặt lại mà phục hồi GoogIe LLC, khôi phục chuỗi duy trì.

"Khi được kích hoạt, CoreKitAgent bắt các tín hiệu này và ghi LaunchAgent để duy trì, một bản sao của GoogIe LLC như bộ tải và một bản sao của chính nó như trojan, thiết lập các quyền thực thi cho hai yếu tố sau thông qua hàm addExecutionPermissions\_user95startup95mainZutils\_u32," [giải thích SentinelLABS](https://www.sentinelone.com/labs/macos-nimdoor-dprk-threat-actors-target-web3-and-crypto-platforms-with-nim-based-malware/).

"Hành vi này đảm bảo rằng bất kỳ sự chấm dứt nào do người dùng khởi xướng của malware sẽ dẫn đến việc triển khai các thành phần cốt lõi, làm cho mã này chống lại các hành động phòng thủ cơ bản."

![Viết các thành phần malware trở lại đĩa khi quy trình bị kết thúc](https://www.bleepstatic.com/images/news/u/1220909/2025/June/what.jpg)

**Viết các thành phần malware trở lại đĩa khi quy trình bị kết thúc**  
_Nguồn: SentinelLABS_

CoreKitAgent giải mã và thực thi một AppleScript mã hex mà báo cho cơ sở hạ tầng tấn công mỗi 30 giây, lấy cắp dữ liệu hệ thống và thực thi các lệnh từ xa thông qua osascript, cung cấp một backdoor nhẹ.

Song song với việc thực thi NimDoor, '_zoom\_sdk\_support.scpt_' kích hoạt một chuỗi tiêm thứ hai liên quan đến '_trojan1\_arm64_', điều này khởi động các cuộc giao tiếp C2 dựa trên WSS và tải về hai script (_upl_ và _tlgrm_) hỗ trợ việc đánh cắp dữ liệu.

Trong trường hợp của bộ tải 'zoom\_sdk\_support.scpt', các nhà nghiên cứu đã nhận thấy rằng nó bao gồm hơn 10.000 dòng trống để mục đích che giấu.

Upl trích xuất dữ liệu từ các trình duyệt web và lấy Keychain, .bash\_history, và .zsh\_history, và lấy cắp chúng bằng curl tới dataupload\[.\]store.

Tlgrm tập trung vào việc đánh cắp cơ sở dữ liệu Telegram cùng với .tempkeyEncrypted, có khả năng sử dụng những dữ liệu này để giải mã các tin nhắn mà mục tiêu đã trao đổi trên nền tảng.

**Script tlgrm nhắm vào dữ liệu Telegram**  
_Nguồn: SentinelLABS_

Tổng quan, khung NimDoor và các backdoor khác mà SentinelLABS phân tích là một trong những gia đình malware macOS phức tạp nhất có liên quan đến các tác nhân đe dọa Bắc Triều Tiên.

Tính modular của malware, điều này mang lại sự linh hoạt, và việc sử dụng các kỹ thuật mới như duy trì dựa trên tín hiệu cho thấy rằng các nhà điều hành DPRK đang phát triển bộ công cụ của họ để mở rộng khả năng đa nền tảng.

Báo cáo của SentinelLABS bao gồm các chỉ số xâm phạm cho các miền, đường dẫn tệp, script và nhị phân mà kẻ đe dọa Bắc Triều Tiên đã sử dụng trong các cuộc tấn công nhằm đánh cắp tài sản tiền điện tử và thông tin nhạy cảm.