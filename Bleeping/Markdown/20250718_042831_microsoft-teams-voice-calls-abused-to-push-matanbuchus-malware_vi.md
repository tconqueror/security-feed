# Cuộc gọi giọng nói Microsoft Teams bị lạm dụng để phát tán phần mềm độc hại Matanbuchus

![Cuộc gọi giọng nói Microsoft Teams bị lạm dụng để phát tán phần mềm độc hại Matanbuchus](https://www.bleepstatic.com/content/hl-images/2024/01/30/Teams_headpic.jpg)

Trình tải phần mềm độc hại Matanbuchus đã được phân phối thông qua kỹ thuật xã hội qua các cuộc gọi Microsoft Teams mạo danh bộ phận hỗ trợ IT.

Matanbuchus là một hoạt động phần mềm độc hại dưới dạng dịch vụ đã được quảng bá trên web đen lần đầu tiên vào [đầu năm 2021](https://unit42.paloaltonetworks.com/matanbuchus-malware-as-a-service/). Nó đã được quảng cáo là một trình tải Windows giá 2,500 đô la thực thi tải trọng độc hại trực tiếp trong bộ nhớ để tránh phát hiện.

Vào tháng 6 năm 2022, nhà phân tích mối đe dọa [Brad Duncan đã báo cáo](https://www.bleepingcomputer.com/news/security/new-phishing-attack-infects-devices-with-cobalt-strike/) rằng trình tải phần mềm độc hại này đã được sử dụng để phát tán các beacon Cobalt Strike trong một chiến dịch malspam quy mô lớn.

Các nhà nghiên cứu tại công ty ngăn chặn mối đe dọa đầu cuối Morphisec đã phát hiện rằng phiên bản Matanbuchus mới nhất được phân tích bao gồm khả năng né tránh, làm rối và các khả năng sau khi bị xâm nhập được cải tiến.

## Lạm dụng Microsoft Teams

Microsoft Teams đã bị lạm dụng [trong những năm qua](https://www.bleepingcomputer.com/news/security/hackers-slip-into-microsoft-teams-chats-to-distribute-malware/) để xâm nhập các tổ chức, sử dụng kỹ thuật xã hội để phát tán phần mềm độc hại giai đoạn đầu.

Thông thường, kẻ tấn công xâm nhập vào cuộc trò chuyện và lừa người dùng tải xuống một tệp độc hại mà sau đó đưa tải trọng ban đầu vào hệ thống.

Năm 2023, một nhà nghiên cứu đã tạo ra một [công cụ chuyên dụng](https://www.bleepingcomputer.com/news/security/new-tool-exploits-microsoft-teams-bug-to-send-malware-to-users/) khai thác [các lỗi trong phần mềm](https://www.bleepingcomputer.com/news/security/microsoft-teams-bug-allows-malware-delivery-from-external-accounts/) để cho phép phát tán phần mềm độc hại từ các tài khoản bên ngoài.

Năm ngoái, [các nhà vận hành phần mềm độc hại DarkGate](https://www.bleepingcomputer.com/news/security/microsoft-teams-phishing-pushes-darkgate-malware-via-group-chats/) đã lạm dụng Microsoft Teams để phát tán trình tải của họ lên các mục tiêu mà sử dụng cài đặt 'Truy cập bên ngoài' lỏng lẻo.

Theo Morphisec, các điều hành viên của biến thể Matanbuchus mới nhất, 3.0, cũng thể hiện sự ưa thích đối với Microsoft Teams để có được quyền truy cập ban đầu.

Kẻ tấn công khởi động một cuộc gọi Microsoft Teams bên ngoài, giả mạo bộ phận hỗ trợ IT hợp pháp, thuyết phục mục tiêu khởi động Quick Assist, công cụ hỗ trợ từ xa được tích hợp trong Windows.

Quick Assist cho phép kẻ tấn công có quyền truy cập từ xa tương tác và tiếp tục bằng cách chỉ dẫn người dùng thực thi một tập lệnh PowerShell.

Tập lệnh này tải xuống và giải nén một tệp ZIP chứa ba tệp được sử dụng để khởi chạy trình tải Matanbuchus trên thiết bị thông qua việc tải bên DLL.

![Chuỗi tấn công Matanbuchus](https://www.bleepstatic.com/images/news/u/1220909/2025/July/July14_Diagram_2.jpg)

**Chuỗi tấn công Matanbuchus**  
_Nguồn: Morphisec_

## Matanbuchus 3.0

Morphisec báo cáo rằng Matanbuchus 3.0 giới thiệu một số tính năng và cải tiến mới. Các nhà phát triển đã chuyển đổi giao tiếp command-and-control (C2) và làm rối chuỗi từ RC4 sang Salsa20.

Các tải trọng hiện được khởi chạy trong bộ nhớ, và có một quy trình xác minh chống sandbox mới để đảm bảo rằng phần mềm độc hại chỉ chạy trên các địa điểm đã xác định.

Thay vì gọi các hàm API Windows, phần mềm độc hại hiện thực thi syscalls thông qua shellcode tùy chỉnh vượt qua các lớp bọc API Windows và các điểm móc EDR, che giấu các hành động thường được công cụ bảo mật theo dõi.

Các cuộc gọi API cũng được làm rối thêm bằng cách sử dụng hàm băm phi mật mã 'MurmurHash3', điều này khiến việc đảo ngược kỹ thuật và phân tích tĩnh trở nên khó khăn hơn.

Về khả năng sau khi bị nhiễm của Matanbuchus 3.0, nó có thể thực thi các lệnh CMD, PowerShell hoặc tải trọng EXE, DLL, MSI và shellcode.

Phần mềm độc hại thu thập thông tin chi tiết như tên người dùng, miền, thông tin phiên bản hệ điều hành, quy trình EDR/AV đang chạy, và trạng thái nâng cao của quy trình của nó (quản trị viên hoặc người dùng thông thường).

Phân tích của Morphisec cũng phát hiện rằng phần mềm độc hại kiểm tra các quy trình đang chạy để xác định các công cụ bảo mật trên hệ thống, cho rằng rằng các phương pháp thực thi gửi lại từ C2 "có thể phụ thuộc vào tầng bảo mật hiện tại của nạn nhân."

Các nhà nghiên cứu đã công bố một [phân tích kỹ thuật chi tiết](https://engage.morphisec.com/hubfs/Matanbuchus%20Threat%20Analysis.pdf) về phần mềm độc hại và cho biết rằng Matanbuchus đã phát triển "thành một mối đe dọa tinh vi."

Họ cũng cung cấp các chỉ số về khả năng bị xâm nhập bao gồm các mẫu phần mềm độc hại và các miền được sử dụng bởi phần mềm độc hại.