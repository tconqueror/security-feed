# Gói PyPi độc hại ẩn dấu mã độc RAT, nhắm vào các nhà phát triển Discord từ năm 2022

![Discord](https://www.bleepstatic.com/content/hl-images/2025/05/08/Discord.jpg)

Một gói Python độc hại nhắm vào các nhà phát triển Discord với mã độc remote access trojan (RAT) đã được phát hiện trên Python Package Index (PyPI) sau hơn ba năm.

Được đặt tên là "discordpydebug," gói này giả dạng như một công cụ ghi lỗi cho các nhà phát triển làm việc trên các bot Discord và đã được tải xuống hơn 11.000 lần kể từ khi được tải lên vào ngày 21 tháng 3 năm 2022, mặc dù nó không có mô tả hay tài liệu nào.

Công ty an ninh mạng Socket, công ty đầu tiên phát hiện ra nó, cho biết mã độc này có thể được sử dụng để mở cửa hậu cho hệ thống của các nhà phát triển Discord và cung cấp cho kẻ tấn công khả năng đánh cắp dữ liệu và thực thi mã từ xa.

“Gói này nhắm vào các nhà phát triển tạo ra hoặc duy trì các bot Discord, thường là các nhà phát triển độc lập, kỹ sư tự động hóa hoặc các nhóm nhỏ có thể cài đặt các công cụ như vậy mà không kiểm tra kỹ lưỡng,” các nhà nghiên cứu của Socket [nói](https://socket.dev/blog/malicious-pypi-package-targets-discord-developers-with-RAT).

“Vì PyPI không thực thi các kiểm tra an ninh sâu cho các gói được tải lên, kẻ tấn công thường lợi dụng điều này bằng cách sử dụng mô tả sai lệch, tên gọi hợp pháp hoặc thậm chí sao chép mã từ các dự án phổ biến để trông có vẻ đáng tin cậy.”

Khi đã được cài đặt, gói độc hại này biến thiết bị thành một hệ thống điều khiển từ xa sẽ thực hiện các hướng dẫn được gửi từ một máy chủ chỉ huy và kiểm soát (C2) do kẻ tấn công kiểm soát.

Các kẻ tấn công có thể sử dụng mã độc để có được quyền truy cập trái phép vào thông tin xác thực và nhiều thứ khác (ví dụ: token, key và file cấu hình), đánh cắp dữ liệu và giám sát hoạt động của hệ thống mà không bị phát hiện, thực thi mã từ xa để triển khai thêm các tải trọng mã độc, và thu thập thông tin có thể hỗ trợ chúng di chuyển qua lại trong mạng.

![discordpydebug on PyPI](https://www.bleepstatic.com/images/news/u/1109292/2025/discordpydebug_on_PyPI.jpg)

_discordpydebug trên PyPI (BleepingComputer)_

Mặc dù mã độc này thiếu cơ chế bền bỉ hoặc nâng cao quyền hạn, nó sử dụng polling HTTP outbound thay vì các kết nối inbound, cho phép vượt qua tường lửa và phần mềm bảo mật, đặc biệt trong các môi trường phát triển được kiểm soát lỏng lẻo.

Khi đã được cài đặt, gói này âm thầm kết nối với máy chủ chỉ huy và kiểm soát (C2) do kẻ tấn công kiểm soát (backstabprotection.jamesx123.repl\[.\]co), gửi một yêu cầu POST với giá trị "name" để thêm máy chủ bị nhiễm vào hạ tầng của kẻ tấn công.

Mã độc cũng bao gồm các chức năng để đọc và ghi từ các file trên máy chủ của máy sử dụng các thao tác JSON khi được kích hoạt bởi các từ khóa cụ thể từ máy chủ C2, cho phép kẻ tấn công có được cái nhìn vào dữ liệu nhạy cảm.

Để giảm thiểu rủi ro khi cài đặt mã độc từ các kho mã trực tuyến, các nhà phát triển phần mềm nên đảm bảo rằng các gói mà họ tải xuống và cài đặt đến từ tác giả chính thức trước khi cài đặt, đặc biệt là đối với các gói phổ biến, để tránh typosquatting.

Ngoài ra, khi sử dụng các thư viện mã nguồn mở, họ nên xem xét mã cho các chức năng nghi ngờ hoặc bị làm mờ và cân nhắc sử dụng các công cụ bảo mật để phát hiện và chặn các gói độc hại.