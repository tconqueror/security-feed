# SAP khắc phục lỗi nghiêm trọng trong Netweaver bị khai thác trong các cuộc tấn công

![SAP](https://www.bleepstatic.com/content/hl-images/2022/02/09/SAP.jpg)

SAP đã phát hành các bản cập nhật khẩn cấp ngoài lịch trình cho NetWeaver để khắc phục một lỗ hổng thực thi mã từ xa (RCE) bị khai thác đang diễn ra, được sử dụng để chiếm đoạt máy chủ.

Lỗ hổng này được theo dõi dưới [CVE-2025-31324](https://nvd.nist.gov/vuln/detail/CVE-2025-31324) và được đánh giá là nghiêm trọng (điểm số CVSS v3: 10.0), là một lỗ hổng tải tệp chưa xác thực trong SAP NetWeaver Visual Composer, cụ thể là thành phần Metadata Uploader.

Lỗ hổng này cho phép kẻ tấn công tải lên các tệp thực thi độc hại mà không cần đăng nhập, có khả năng dẫn đến việc thực thi mã từ xa và xâm phạm toàn bộ hệ thống.

Mặc dù [thông báo của nhà cung cấp](https://me.sap.com/notes/3594142) không công khai, ReliaQuest đã báo cáo vào đầu tuần này về một lỗ hổng đang bị khai thác trên SAP NetWeaver Visual Composer, cụ thể là điểm cuối '/developmentserver/metadatauploader', phù hợp với CVE-2025-31324.

ReliaQuest [đã báo cáo](http://reliaquest.com/blog/threat-spotlight-reliaquest-uncovers-vulnerability-behind-sap-netweaver-compromise/) rằng nhiều khách hàng đã bị xâm phạm thông qua việc tải tệp không được phép trên SAP NetWeaver, với kẻ tấn công tải lên webshell JSP vào các thư mục có thể truy cập công khai.

Các bản tải lên này cho phép thực thi mã từ xa thông qua các yêu cầu GET đơn giản đến các tệp JSP, cho phép thực hiện lệnh từ trình duyệt, các hành động quản lý tệp (tải lên/tải xuống) và nhiều hơn nữa.

Trong giai đoạn sau khai thác, các kẻ tấn công đã triển khai công cụ 'Brute Ratel' của đội đỏ, kỹ thuật vượt qua bảo mật 'Heaven's Gate' và tiêm mã đã biên dịch MSBuild vào dllhost.exe để che giấu.

ReliaQuest đã lưu ý trong báo cáo rằng việc khai thác không yêu cầu xác thực và rằng các hệ thống bị xâm phạm đã được vá hoàn toàn, cho thấy rằng chúng đã bị tấn công bởi một lỗ hổng zero-day.

Công ty an ninh watchTowr cũng đã xác nhận với BleepingComputer rằng họ đang thấy các vụ khai thác hoạt động liên quan đến CVE-2025-31324.

"Các kẻ tấn công chưa xác thực có thể lạm dụng chức năng tích hợp sẵn để tải lên các tệp tùy ý vào một phiên bản SAP NetWeaver, điều này có nghĩa là thực thi mã từ xa đầy đủ và xâm phạm toàn bộ hệ thống," Giám đốc điều hành của watchTowr, Benjamin Harris cho biết.

"watchTowr đang thấy khai thác tích cực từ các tác nhân đe dọa, những người đang sử dụng lỗ hổng này để cài đặt backdoor web shell vào các hệ thống bị lộ và tăng cường quyền truy cập."

"Sự khai thác tích cực trong tự nhiên và tác động rộng rãi này làm cho khả năng chúng tôi sẽ sớm thấy nhiều bên khai thác lỗ hổng này trở nên cực kỳ cao."

BleepingComputer đã liên hệ với SAP với các câu hỏi về việc khai thác đang diễn ra nhưng chưa nhận được phản hồi tại thời điểm này.

## Bảo vệ chống lại các cuộc tấn công ngay bây giờ

Lỗ hổng này ảnh hưởng đến Visual Composer Framework 7.50 và hành động được khuyến nghị là áp dụng bản vá mới nhất.

Bản cập nhật bảo mật khẩn cấp này được cung cấp sau bản cập nhật thông thường của SAP ['April 2025'](https://support.sap.com/en/my-support/knowledge-base/security-notes-news/april-2025.html), do đó nếu bạn đã áp dụng bản cập nhật đó vào đầu tháng này (phát hành vào ngày 8 tháng 4 năm 2025), bạn vẫn dễ bị tổn thương với CVE-2025-31324.

Hơn nữa, bản cập nhật khẩn cấp này bao gồm các bản sửa lỗi cho hai lỗ hổng nghiêm trọng khác, cụ thể là CVE-2025-27429 (tiêm mã trong SAP S/4HANA) và CVE-2025-31330 (tiêm mã trong SAP Landscape Transformation).

Những ai không thể áp dụng các bản cập nhật giải quyết CVE-2025-31324 được khuyến nghị thực hiện các biện pháp giảm thiểu sau:

1. Hạn chế quyền truy cập vào điểm cuối /developmentserver/metadatauploader.
2. Nếu không sử dụng Visual Composer, xem xét tắt hẳn nó.
3. Chuyển tiếp nhật ký đến SIEM và quét các tệp không được phép trong đường dẫn servlet.

ReliaQuest khuyến nghị thực hiện quét môi trường sâu để xác định và xóa các tệp nghi ngờ trước khi áp dụng các biện pháp giảm thiểu.