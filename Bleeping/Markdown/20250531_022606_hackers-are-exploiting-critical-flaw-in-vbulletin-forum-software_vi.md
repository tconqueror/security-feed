# Các hacker đang khai thác lỗ hổng nghiêm trọng trong phần mềm diễn đàn vBulletin

![Box](https://www.bleepstatic.com/content/hl-images/2024/05/07/hacker-box.jpg)

Hai lỗ hổng nghiêm trọng ảnh hưởng đến phần mềm diễn đàn mã nguồn mở vBulletin đã được phát hiện, với một trong số đó được xác nhận là đang bị khai thác một cách chủ động.

Các lỗ hổng, được theo dõi dưới mã CVE-2025-48827 và CVE-2025-48828, và được đánh giá là nghiêm trọng (điểm số CVSS v3: 10.0 và 9.0 tương ứng), là một lệnh gọi phương thức API và một lỗi thực thi mã từ xa (RCE) thông qua việc lạm dụng động cơ mẫu.

Chúng ảnh hưởng đến các phiên bản vBulletin từ 5.0.0 đến 5.7.5 và từ 6.0.0 đến 6.0.3 khi nền tảng chạy trên PHP 8.1 hoặc cao hơn.

Các lỗ hổng có thể đã được vá âm thầm trong năm ngoái với việc phát hành Patch Level 1 cho tất cả các phiên bản trong nhánh phát hành 6.* và phiên bản 5.7.5 Patch Level 3, nhưng nhiều trang web vẫn còn bị lộ do không nâng cấp.

## PoC công khai và khai thác chủ động

Hai vấn đề này được phát hiện vào ngày 23 tháng 5 năm 2025, bởi nhà nghiên cứu an toàn thông tin [Egidio Romano](https://karmainsecurity.com/dont-call-that-protected-method-vbulletin-rce) (EgiX), người đã giải thích cách khai thác nó qua một bài viết kỹ thuật chi tiết trên blog của mình.

Nhà nghiên cứu đã chỉ rõ rằng lỗi nằm ở việc vBulletin lạm dụng Reflection API của PHP, mà do những thay đổi hành vi được giới thiệu trong PHP 8.1, cho phép các phương thức được bảo vệ được gọi mà không cần điều chỉnh quyền truy cập rõ ràng.

Chuỗi lỗ hổng nằm ở khả năng gọi các phương thức được bảo vệ thông qua các URL giả mạo và việc lạm dụng điều kiện mẫu bên trong động cơ mẫu của vBulletin.

Bằng cách tiêm mã mẫu chế tạo sử dụng phương thức 'replaceAdTemplate' bị lỗi, các hacker có thể vượt qua các bộ lọc "hàm không an toàn" bằng cách sử dụng các thủ thuật như gọi hàm biến PHP.

Điều này dẫn đến việc thực thi mã từ xa hoàn toàn, không cần xác thực trên máy chủ cơ sở — hiệu quả cho phép những kẻ tấn công truy cập shell như người dùng máy chủ web (www-data trên Linux, chẳng hạn).

Vào ngày 26 tháng 5, nhà nghiên cứu an toàn thông tin [Ryan Dewhurst báo cáo](https://blog.kevintel.com/vbulletin-replaceadtemplate-kev/) đã thấy các nỗ lực khai thác trên các log honeypot cho thấy có các yêu cầu đến điểm cuối 'ajax/api/ad/replaceAdTemplate' bị lỗi.

![Logs showing exploitation attempts](https://www.bleepstatic.com/images/news/u/1220909/2025/May/exploitation.png)

**Logs showing exploitation attempts**  
_Nguồn: blog.kevintel.com_

Dewhurst đã lần theo một trong những kẻ tấn công đến Ba Lan, thấy rằng có những nỗ lực để triển khai backdoors PHP nhằm thực hiện các lệnh hệ thống.

Nhà nghiên cứu đã lưu ý rằng các cuộc tấn công dường như tận dụng lỗ hổng được Romano công bố trước đó, mặc dù đã có các mẫu Nuclei dành cho lỗ hổng này từ ngày 24 tháng 5 năm 2025.

Cần làm rõ rằng Dewhurst chỉ quan sát thấy các nỗ lực khai thác cho CVE-2025-48827, nhưng chưa có bằng chứng nào cho thấy các kẻ tấn công đã thành công trong việc liên kết nó với RCE hoàn chỉnh, mặc dù điều này là rất có thể.

## Vấn đề của vBulletin

vBulletin là một trong những nền tảng diễn đàn thương mại dựa trên PHP/MySQL được sử dụng rộng rãi nhất, phục vụ cho hàng nghìn [cộng đồng trực tuyến](https://www.bleepingcomputer.com/news/security/epic-games-forums-hacked-and-info-for-800k-accounts-leaked/) trên toàn cầu.

Thiết kế mô-đun của nó, bao gồm các API di động và giao diện AJAX, làm cho nó trở thành một nền tảng phức tạp và linh hoạt. Tuy nhiên, nó cũng [phơi bày](https://www.bleepingcomputer.com/news/security/vbulletin-zero-day-exploited-for-years-gets-unofficial-patch/) một [bề mặt tấn công rộng](https://www.bleepingcomputer.com/news/security/cloudflare-now-blocks-the-vbulletin-rce-cve-2019-16759-exploit/).

Trong quá khứ, các hacker đã khai thác [các lỗ hổng nghiêm trọng](https://www.bleepingcomputer.com/news/security/vbulletin-fixes-ridiculously-easy-to-exploit-zero-day-rce-bug/) trong nền tảng này để [xâm phạm](https://www.bleepingcomputer.com/news/security/comodo-forums-breached-data-of-over-170-000-users-up-for-grabs/) các diễn đàn phổ biến và [đánh cắp dữ liệu nhạy cảm](https://www.bleepingcomputer.com/news/security/hacker-selling-user-info-stolen-from-prostitution-forums/) của [số lượng lớn người dùng](https://www.bleepingcomputer.com/news/security/female-escort-review-site-data-breach-affects-470-000-members/).

Các quản trị viên diễn đàn được khuyến cáo áp dụng các bản cập nhật bảo mật cho cài đặt vBulletin của họ hoặc chuyển sang phiên bản phát hành mới nhất, phiên bản 6.1.1, cái không bị ảnh hưởng bởi các lỗ hổng đã đề cập.