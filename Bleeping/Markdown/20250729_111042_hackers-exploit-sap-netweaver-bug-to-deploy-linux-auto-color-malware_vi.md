# Tin tặc khai thác lỗ hổng SAP NetWeaver để triển khai phần mềm độc hại Linux Auto-Color

![Auto Color](https://www.bleepstatic.com/content/hl-images/2025/02/25/Color-pengiun.jpg)

Tin tặc đã bị phát hiện khai thác một lỗ hổng nghiêm trọng trong SAP NetWeaver được theo dõi là CVE-2025-31324 để triển khai phần mềm độc hại Auto-Color Linux trong một cuộc tấn công mạng vào một công ty hóa chất có trụ sở tại Hoa Kỳ.

Công ty an ninh mạng [Darktrace đã phát hiện](https://www.darktrace.com/blog/auto-color-backdoor-how-darktrace-thwarted-a-stealthy-linux-intrusion) cuộc tấn công này trong một quá trình phản ứng sự cố vào tháng 4 năm 2025, nơi mà một cuộc điều tra đã tiết lộ rằng phần mềm độc hại Auto-Color đã phát triển để bao gồm các chiến thuật né tránh tiên tiến bổ sung.

Darktrace báo cáo rằng cuộc tấn công bắt đầu vào ngày 25 tháng 4, nhưng việc khai thác tích cực diễn ra hai ngày sau đó, cung cấp một tệp ELF (tệp thực thi Linux) đến máy bị mục tiêu.

Phần mềm độc hại Auto-Color lần đầu tiên được tài liệu hóa bởi các nhà nghiên cứu [Unit 42 của Palo Alto Networks](https://www.bleepingcomputer.com/news/security/new-auto-color-linux-backdoor-targets-north-american-govts-universities/) vào tháng 2 năm 2025, họ đã làm nổi bật tính chất tránh né của nó và sự khó khăn trong việc loại bỏ nó một khi đã thiết lập chỗ đứng trên một máy.

Backdoor tự điều chỉnh hành vi của nó dựa trên mức độ quyền truy cập của người dùng mà nó chạy từ đó, và sử dụng 'ld.so.preload' để duy trì vị trí một cách stealthy thông qua việc tiêm đối tượng chia sẻ.

Auto-Color có khả năng thực hiện các lệnh tùy ý, sửa đổi tệp, shell ngược để truy cập từ xa hoàn toàn, chuyển tiếp lưu lượng proxy và cập nhật cấu hình động. Nó cũng có một mô-đun rootkit ẩn các hoạt động độc hại của nó khỏi các công cụ an ninh.

Unit 42 không thể tìm ra vector lây nhiễm ban đầu từ các cuộc tấn công mà họ đã quan sát, nhằm vào các trường đại học và tổ chức chính phủ ở Bắc Mỹ và Châu Á.

Theo nghiên cứu mới nhất của Darktrace, những đối tượng đe dọa đứng sau Auto-Color khai thác CVE-2025-31324, một lỗ hổng nghiêm trọng trong NetWeaver cho phép các đối tượng tấn công không xác thực tải lên các nhị phân độc hại để đạt được thực thi mã từ xa (RCE).

![Thời gian của cuộc tấn công được quan sát](https://www.bleepstatic.com/images/news/u/1220909/2025/July/timeline(1).jpg)

**Thời gian của cuộc tấn công được quan sát**  
_Nguồn: Darktrace_

SAP [đã khắc phục lỗ hổng này vào tháng 4 năm 2025](https://www.bleepingcomputer.com/news/security/sap-fixes-suspected-netweaver-zero-day-exploited-in-attacks/), trong khi các công ty an ninh ReliaQuest, Onapsis và watchTowr đã báo cáo thấy các nỗ lực khai thác đang diễn ra, [kết thúc chỉ vài ngày sau đó](https://www.bleepingcomputer.com/news/security/over-1-200-sap-netweaver-servers-vulnerable-to-actively-exploited-flaw/).

Đến tháng 5, [các tác nhân ransomware](https://www.bleepingcomputer.com/news/security/ransomware-gangs-join-ongoing-sap-netweaver-attacks/) và [tin tặc nhà nước Trung Quốc](https://www.bleepingcomputer.com/news/security/chinese-hackers-behind-attacks-targeting-sap-netweaver-servers/) đã gia nhập vào hoạt động khai thác, trong khi Mandiant báo cáo đã phát hiện bằng chứng về việc khai thác zero-day cho CVE-2025-31324 kể từ ít nhất giữa tháng 3 năm 2025.

Ngoài vector truy cập ban đầu, Darktrace cũng đã phát hiện một biện pháp né tránh mới được triển khai trên phiên bản mới nhất của Auto-Color.

Nếu Auto-Color không thể kết nối với máy chủ Command-and-Control (C2) đã lập trình sẵn, nó sẽ kìm hãm hầu hết các hành vi độc hại của nó. Điều này áp dụng cho các môi trường đã được cách ly hoặc sandboxed, nơi phần mềm độc hại sẽ xuất hiện là vô hại đối với các nhà phân tích.

"Nếu máy chủ C2 không thể truy cập, Auto-Color thực sự dừng lại và không triển khai toàn bộ chức năng độc hại của nó, xuất hiện là vô hại đối với các nhà phân tích," Darktrace giải thích.

"Hành vi này ngăn cản nỗ lực phân tích ngược từ việc phát hiện ra payloads, cơ chế thu thập thông tin bảo mật hoặc các kỹ thuật duy trì."

Điều này được bổ sung thêm những gì Unit 42 đã ghi nhận trước đó, bao gồm logic thực thi dựa trên quyền truy cập, sử dụng tên tệp vô hại, hooking các hàm libc, sử dụng một thư mục nhật ký giả, C2 kết nối qua TLS, băm độc đáo cho mỗi mẫu, và sự tồn tại của một "công tắc tiêu diệt."

Với việc Auto-Color hiện đang tích cực khai thác CVE-2025-31324, các quản trị viên nên hành động nhanh chóng để áp dụng các bản cập nhật bảo mật hoặc biện pháp giảm thiểu được cung cấp trong [thông báo SAP chỉ dành cho khách hàng](https://me.sap.com/notes/3594142).