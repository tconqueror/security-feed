# Những cuộc tấn công mới của Fortinet FortiWeb có khả năng liên quan đến khai thác RCE công khai

![Box](https://www.bleepstatic.com/content/hl-images/2024/08/28/hacker.jpg)

Nhiều phiên bản Fortinet FortiWeb gần đây bị nhiễm web shell được cho là đã bị xâm nhập thông qua các khai thác công khai cho một lỗ hổng thực thi mã từ xa (RCE) vừa được vá, được theo dõi là CVE-2025-25257.

Tin tức về hoạt động khai thác đến từ nền tảng giám sát mối đe dọa The Shadowserver Foundation, đã quan sát thấy 85 ca nhiễm vào ngày 14 tháng 7 và 77 ca vào ngày tiếp theo.

Các nhà nghiên cứu [đã báo cáo](https://x.com/Shadowserver/status/1945407662805454871) rằng các phiên bản Fortinet FortiWeb này được cho là đã bị xâm nhập thông qua lỗ hổng CVE-2025-25257.

![Tweet](https://www.bleepstatic.com/images/news/u/1220909/2025/July/tweet.png)

CVE-2025-25257 là một lỗ hổng RCE quan trọng không cần xác thực thông qua SQL injection (SQLi) ảnh hưởng đến FortiWeb từ 7.6.0 đến 7.6.3, từ 7.4.0 đến 7.4.7, và từ 7.0.0 đến 7.0.10.

Fortinet đã phát hành bản vá vào ngày 8 tháng 7 năm 2025, kêu gọi người dùng nâng cấp lên FortiWeb 7.6.4, 7.4.8, 7.2.11 hoặc 7.0.11 và các phiên bản sau của mỗi nhánh.

"Một sự trung hòa không đúng cách của các yếu tố đặc biệt được sử dụng trong một câu lệnh SQL ('SQL Injection') trong FortiWeb có thể cho phép một kẻ tấn công không xác thực thực hiện mã SQL hoặc các lệnh không được phép thông qua các yêu cầu HTTP hoặc HTTPS được tinh chỉnh," [Fortinet đã giải thích](https://fortiguard.fortinet.com/psirt/FG-IR-25-151).

Vào ngày 11 tháng 7, [các khai thác đã được công khai](https://www.bleepingcomputer.com/news/security/exploits-for-pre-auth-fortinet-fortiweb-rce-flaw-released-patch-now/) bởi công ty an ninh mạng WatchTowr, và một đồng khám phá lỗ hổng, "faulty *ptrrr." Các khai thác này đã trình diễn các phương pháp để cài đặt webshell hoặc mở reverse shell trên các điểm cuối chưa được vá.

Sự khai thác liên quan đến việc thực hiện SQLi thông qua các tiêu đề Authorization được tinh chỉnh trong các yêu cầu HTTP gửi đến /api/fabric/device/status, nơi ghi một tệp .pth độc hại vào 'site-packages' của Python.

Một tập lệnh CGI hợp lệ của FortiWeb (/cgi-bin/ml-draw.py) sau đó được truy cập từ xa, gây ra mã trong tệp .pth độc hại được thực thi và đạt được thực thi mã từ xa trên thiết bị.

Tại thời điểm đó, không có bằng chứng nào về việc khai thác đang diễn ra ngoài thực địa, nhưng sự phát hành các khai thác công khai đã khiến việc vá vàng phát là điều thiết yếu cho các quản trị viên.

Sự xác nhận ngày hôm nay về việc khai thác đang diễn ra bởi The Shadowserver Foundation có thể được coi là một lời cảnh tỉnh cho những người chưa cài đặt phần mềm mới nhất trên thiết bị của họ.

Theo tổ chức tình báo mối đe dọa, 223 giao diện quản lý FortiWeb vẫn bị lộ ra ngoài tính đến ngày hôm qua, mặc dù không có cái nhìn nào về phiên bản họ đang chạy.

Trong số các điểm cuối bị xâm nhập, phần lớn (40) nằm ở Hoa Kỳ, tiếp theo là Hà Lan (5), Singapore (4) và Vương quốc Anh (4).

FortiWeb là một Web Application Firewall (WAF) được sử dụng bởi các doanh nghiệp lớn, cơ quan chính phủ, và các nhà cung cấp dịch vụ bảo mật quản lý để chặn và phát hiện lưu lượng HTTP không mong muốn.

Nếu việc nâng cấp ngay lên phiên bản an toàn không khả thi, nên tắt giao diện quản trị HTTP/HTTPS để hạn chế truy cập vào thành phần dễ bị tổn thương (/api/fabric/device/status).