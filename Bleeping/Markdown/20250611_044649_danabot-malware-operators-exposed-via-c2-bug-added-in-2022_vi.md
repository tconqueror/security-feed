# Các nhà điều hành phần mềm độc hại DanaBot bị phơi bày qua lỗi C2 được thêm vào năm 2022

![Theo dõi](https://www.bleepstatic.com/content/hl-images/2021/05/13/spyware.jpg)

Một lỗ hổng trong hoạt động phần mềm độc hại DanaBot được giới thiệu trong bản cập nhật tháng 6 năm 2022 đã dẫn đến việc xác định, truy tố và tháo dỡ hoạt động của họ trong một hành động thực thi pháp luật gần đây.

DanaBot là một nền tảng malware-as-a-service (MaaS) hoạt động từ năm 2018 đến năm 2025, được sử dụng cho gian lận ngân hàng, đánh cắp thông tin xác thực, truy cập từ xa và các cuộc tấn công từ chối dịch vụ phân tán (DDoS).

Các nhà nghiên cứu ThreatLabz của Zscaler, những người đã [phát hiện lỗ hổng](http://www.zscaler.com/blogs/security-research/danableed-danabot-c2-server-memory-leak-bug), được gọi là 'DanaBleed,' giải thích rằng một lỗ hổng rò rỉ bộ nhớ đã cho phép họ có cái nhìn sâu sắc về các hoạt động nội bộ của phần mềm độc hại và những người đứng sau nó.

Việc khai thác lỗi này để thu thập thông tin tình báo quý giá về các tội phạm mạng đã cho phép một hành động thực thi pháp luật quốc tế mang tên '[Operation Endgame](https://www.bleepingcomputer.com/news/security/police-takes-down-300-servers-in-ransomware-supply-chain-crackdown/)' giải quyết cơ sở hạ tầng DanaBot và truy tố 16 thành viên của nhóm đe dọa.

## DanaBleed

Lỗi DanaBleed được giới thiệu vào tháng 6 năm 2022 cùng với phiên bản DataBot 2380, đã thêm một giao thức command and control (C2) mới.

Một điểm yếu trong logic của giao thức mới nằm ở cơ chế tạo ra phản hồi của máy chủ C2 đối với khách hàng, điều này lẽ ra phải bao gồm các byte đệm được sinh ra ngẫu nhiên nhưng lại không khởi tạo bộ nhớ được cấp phát mới cho các byte này.

Các nhà nghiên cứu Zscaler đã thu thập và phân tích một số lượng lớn phản hồi C2 mà, do lỗi rò rỉ bộ nhớ, đã chứa các đoạn dữ liệu thừa từ bộ nhớ của máy chủ.

Sự phơi bày này tương tự như vấn đề [HeartBleed](https://heartbleed.com/) được phát hiện vào năm 2014, ảnh hưởng đến phần mềm OpenSSL phổ biến.

Kết quả của lỗi DanaBleed, một loạt dữ liệu cá nhân đã bị phơi bày cho các nhà nghiên cứu theo thời gian, bao gồm:

* Thông tin chi tiết về tác nhân đe dọa (tên người dùng, địa chỉ IP)
* Hạ tầng backend (địa chỉ IP / tên miền của máy chủ C2)
* Dữ liệu nạn nhân (địa chỉ IP, thông tin xác thực, thông tin đã bị rò rỉ)
* Nhật ký thay đổi phần mềm độc hại
* Khóa mã hóa riêng tư
* Truy vấn SQL và nhật ký gỡ lỗi
* Đoạn HTML và giao diện web từ bảng điều khiển C2

Trong hơn ba năm, DanaBot đã hoạt động trong chế độ bị xâm phạm mà không có các nhà phát triển hoặc khách hàng nhận ra rằng họ đang bị phơi bày cho các nhà nghiên cứu bảo mật.

Điều này đã cho phép các hành động thực thi pháp luật được nhắm mục tiêu sau khi đủ dữ liệu đã được thu thập.

![Dữ liệu HTML bị rò rỉ trên phản hồi máy chủ C2](https://www.bleepstatic.com/images/news/u/1220909/2025/June/leaked-html.jpg)

**Dữ liệu HTML bị rò rỉ trên phản hồi máy chủ C2**  
_Nguồn: Zscaler_

Mặc dù đội ngũ cốt lõi của DanaBot ở Nga chỉ bị truy tố và không bị bắt giữ, nhưng việc tịch thu các máy chủ C2 quan trọng, 650 tên miền và gần 4.000.000 đô la trong tiền điện tử đã trung hòa mối đe dọa hiệu quả cho đến nay.

Không có gì ngạc nhiên nếu các tác nhân đe dọa tìm cách trở lại hoạt động tội phạm mạng trong tương lai, nhưng niềm tin giảm từ cộng đồng hackers sẽ là một trở ngại lớn đối với họ.