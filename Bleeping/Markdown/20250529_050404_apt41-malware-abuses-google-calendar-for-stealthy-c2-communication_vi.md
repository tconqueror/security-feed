# Phần mềm độc APT41 lợi dụng Google Calendar cho giao tiếp C2 một cách kín đáo

![Google logo](https://www.bleepstatic.com/content/hl-images/2023/12/29/Google_headpic.jpg)

Nhóm hack APT41 của Trung Quốc sử dụng một phần mềm độc mới có tên 'ToughProgress' lợi dụng Google Calendar cho các hoạt động chỉ huy và kiểm soát (C2), ẩn giấu hoạt động độc hại phía sau một dịch vụ đám mây đáng tin cậy.

Chiến dịch này được phát hiện bởi [Nhóm Tình báo Đe dọa của Google](https://cloud.google.com/blog/topics/threat-intelligence/apt41-innovative-tactics), nhóm đã xác định và phá dỡ hạ tầng Google Calendar và Workspace do kẻ tấn công kiểm soát, và giới thiệu các biện pháp mục tiêu để ngăn chặn việc lạm dụng như vậy trong tương lai.

Việc sử dụng Google Calendar như một cơ chế C2 không phải là một kỹ thuật mới, và [Veracode gần đây đã báo cáo](https://www.bleepingcomputer.com/news/security/malicious-npm-package-uses-unicode-steganography-to-evade-detection/) về một gói độc hại trong chỉ mục Node Package Manager (NPM) theo cách tương tự.

Ngoài ra, APT41 đã được biết đến là đã lạm dụng các dịch vụ của Google trước đây, như việc sử dụng Google Sheets và Google Drive trong một [chiến dịch phần mềm độc Voldemort](https://www.bleepingcomputer.com/news/security/new-voldemort-malware-abuses-google-sheets-to-store-stolen-data/) vào tháng 4 năm 2023.

![Tổng quan về cuộc tấn công](https://www.bleepstatic.com/images/news/u/1220909/2025/May/attack.jpg)

**Tổng quan về cuộc tấn công**  
_Nguồn: Google_

## Luồng tấn công APT41

Cuộc tấn công bắt đầu bằng một email độc hại được gửi đến mục tiêu, liên kết đến một kho lưu trữ ZIP được lưu trữ trên một trang web chính phủ đã bị xâm phạm trước đó.

Kho lưu trữ chứa một tệp LNK của Windows giả làm tài liệu PDF, một payload chính ngụy trang như một tệp hình ảnh JPG và một tệp DLL được sử dụng để giải mã và khởi chạy payload, cũng ngụy trang dưới dạng tệp hình ảnh.

"Các tệp "6.jpg" và "7.jpg" là những hình ảnh giả. Tệp đầu tiên thực chất là một payload đã được mã hóa và được giải mã bởi tệp thứ hai, là một tệp DLL được khởi động khi mục tiêu nhấp vào LNK," Google giải thích.

DLL là 'PlusDrop', một thành phần giải mã và thực thi giai đoạn tiếp theo, 'PlusInject', hoàn toàn trong bộ nhớ.

Tiếp theo, PlusInject thực hiện quá trình hollowing trên tiến trình Windows hợp pháp 'svhost.exe' và tiêm giai đoạn cuối cùng 'ToughProgress.'

Phần mềm độc kết nối đến một điểm cuối Google Calendar đã được mã cứng và lấy các ngày sự kiện cụ thể để tìm kiếm các lệnh mà APT41 đã thêm vào trường mô tả của các sự kiện ẩn.

![Một trong các sự kiện Calendar của APT41](https://www.bleepstatic.com/images/news/u/1220909/2025/May/event.jpg)

**Một trong các sự kiện Calendar của APT41**  
_Nguồn: Google_

Sau khi thực thi chúng, ToughProgress đưa kết quả vào các sự kiện lịch mới để kẻ tấn công có thể điều chỉnh các bước tiếp theo của họ một cách phù hợp.

**Giao dịch mã hóa**  
_Nguồn: Google_

Với các payload không bao giờ chạm vào đĩa và việc giao tiếp C2 diễn ra qua một dịch vụ đám mây hợp pháp, khả năng bị người dùng bảo mật trên máy bị nhiễm phát hiện là tối thiểu.

## Ngăn chặn hoạt động

Google đã xác định các trường hợp Google Calendar do kẻ tấn công kiểm soát và đã chấm dứt tất cả các tài khoản Workspace liên quan và các sự kiện Calendar có vấn đề.

Danh sách chặn duyệt web an toàn của Google cũng đã được cập nhật tương ứng, do đó người dùng sẽ nhận được cảnh báo khi truy cập vào các trang web liên quan, và lưu lượng truy cập từ các trang web đó sẽ bị chặn trên tất cả các sản phẩm của gã khổng lồ công nghệ này.

Báo cáo không nêu tên bất kỳ tổ chức hoặc nạn nhân cụ thể nào đã bị xâm phạm, nhưng Google cho biết họ đã thông báo trực tiếp cho họ phối hợp cùng với Mandiant. Google cũng chia sẻ các mẫu ToughProgress và nhật ký lưu lượng với các nạn nhân để giúp họ xác định nhiễm bệnh trong môi trường của mình.