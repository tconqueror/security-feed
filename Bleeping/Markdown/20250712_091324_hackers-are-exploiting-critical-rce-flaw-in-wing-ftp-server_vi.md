# Các hacker đang khai thác lỗ hổng RCE nghiêm trọng trong Wing FTP Server

![Các hacker đang khai thác lỗ hổng RCE nghiêm trọng trong Wing FTP Server](https://www.bleepstatic.com/content/hl-images/2024/12/10/hacker-box.jpg)

Các hacker đã bắt đầu khai thác một lỗ hổng thực thi mã từ xa (RCE) nghiêm trọng trong Wing FTP Server chỉ một ngày sau khi thông tin kỹ thuật về lỗ hổng này được công khai.

Cuộc tấn công được quan sát đã chạy nhiều lệnh liệt kê và khảo sát và sau đó là việc thiết lập tính nhất quán bằng cách tạo người dùng mới.

Lỗ hổng trong Wing FTP Server được theo dõi dưới mã [CVE-2025-47812](http://nvd.nist.gov/vuln/detail/CVE-2025-47812) và nhận được đánh giá độ nghiêm trọng cao nhất. Đây là sự kết hợp giữa null byte và chèn mã Lua cho phép một kẻ tấn công từ xa không xác thực thực thi mã với quyền cao nhất trên hệ thống (root/SYSTEM).

Wing FTP Server là một giải pháp mạnh mẽ để quản lý các chuyển giao tệp an toàn có thể chạy các kịch bản Lua, được sử dụng rộng rãi trong các môi trường doanh nghiệp và SMB.

Vào ngày 30 tháng 6, nhà nghiên cứu an ninh Julien Ahrens đã công bố một [bài viết kỹ thuật về CVE-2025-47812](http://www.rcesecurity.com/2025/06/what-the-null-wing-ftp-server-rce-cve-2025-47812/), giải thích rằng lỗ hổng này xuất phát từ việc xử lý không an toàn các chuỗi null-terminated trong C++ và quá trình vệ sinh đầu vào không đúng cách trong Lua.

Nhà nghiên cứu đã chứng minh cách một null byte trong trường tên người dùng có thể vượt qua các kiểm tra xác thực và cho phép chèn mã Lua vào các tệp phiên.

Khi các tệp này sau đó được máy chủ thực thi, có thể đạt được việc thực thi mã tùy ý với quyền root/SYSTEM.

Bên cạnh CVE-2025-47812, nhà nghiên cứu cũng đã trình bày thêm ba lỗ hổng khác trong Wing FTP:

* [CVE-2025-27889](https://nvd.nist.gov/vuln/detail/CVE-2025-27889) – cho phép thu thập mật khẩu người dùng thông qua một URL chế tạo nếu người dùng gửi biểu mẫu đăng nhập, do sự bao gồm không an toàn của mật khẩu trong một biến JavaScript (location)
* [CVE-2025-47811](https://nvd.nist.gov/vuln/detail/CVE-2025-47811) – Wing FTP chạy với quyền root/SYSTEM theo mặc định, không có sandbox hay giảm quyền, làm cho các RCE trở nên nguy hiểm hơn nhiều
* [CVE-2025-47813](https://nvd.nist.gov/vuln/detail/CVE-2025-47813) – cung cấp một cookie UID quá dài tiết lộ các đường dẫn hệ thống tệp

Tất cả các lỗ hổng này ảnh hưởng đến các phiên bản Wing FTP 7.4.3 và trước đó. Nhà cung cấp đã khắc phục các vấn đề bằng cách phát hành phiên bản 7.4.4 vào ngày 14 tháng 5 năm 2025, ngoại trừ CVE-2025-47811, được coi là không quan trọng.

Các nhà nghiên cứu về đe dọa tại nền tảng an ninh mạng được quản lý Huntress đã tạo ra một exploit mẫu cho CVE-2025-47812 và cho thấy trong video dưới đây cách mà các hacker có thể khai thác nó trong các cuộc tấn công:

Các nhà nghiên cứu của Huntress phát hiện rằng vào ngày 1 tháng 7, một ngày sau khi thông tin kỹ thuật cho CVE-2025-47812 xuất hiện, ít nhất một kẻ tấn công đã khai thác lỗ hổng này tại một trong những khách hàng của họ.

Kẻ tấn công đã gửi các yêu cầu đăng nhập bị lỗi với các tên người dùng đã chèn null byte, nhắm mục tiêu vào ‘loginok.html.’ Những đầu vào này đã tạo ra các tệp phiên .lua độc hại, mà đã chèn mã Lua vào máy chủ.

Mã được chèn được thiết kế để giải mã hex một payload và thực thi nó qua cmd.exe, sử dụng certutil để tải malware từ một vị trí từ xa và thực thi nó.

Huntress [cho biết](http://www.huntress.com/blog/wing-ftp-server-remote-code-execution-cve-2025-47812-exploited-in-wild) rằng cùng một phiên bản Wing FTP đã bị nhắm mục tiêu bởi năm địa chỉ IP khác nhau trong một khoảng thời gian ngắn, có khả năng cho thấy các nỗ lực quét hàng loạt và khai thác từ nhiều tác nhân đe dọa khác nhau.

Các lệnh được quan sát trong những nỗ lực này là để khảo sát, đạt được tính nhất quán trong môi trường và thu thập dữ liệu sử dụng công cụ _cURL_ và điểm cuối webhook.

Kẻ tấn công đã thất bại trong cuộc tấn công "có thể do họ không quen thuộc với nó, hoặc vì Microsoft Defender đã ngăn chặn một phần cuộc tấn công của họ," Huntress cho biết. Tuy nhiên, các nhà nghiên cứu đã quan sát thấy rõ sự khai thác lỗ hổng nghiêm trọng trong Wing FTP Server.

Ngay cả khi Huntress đã quan sát các cuộc tấn công thất bại ở khách hàng của họ, các hacker có khả năng sẽ quét các phiên bản Wing FTP có thể tiếp cận và cố gắng tận dụng các máy chủ dễ bị tổn thương.

Các công ty được khuyến nghị nâng cấp lên phiên bản 7.4.4 của sản phẩm càng sớm càng tốt.

Nếu việc chuyển sang một phiên bản mới, an toàn hơn là không thể, khuyến nghị của các nhà nghiên cứu là vô hiệu hóa hoặc hạn chế quyền truy cập HTTP/HTTPs vào cổng web của Wing FTP, vô hiệu hóa đăng nhập ẩn danh và giám sát thư mục phiên để phát hiện các bổ sung đáng ngờ.