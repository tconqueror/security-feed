# Những gói npm linter phổ biến bị tấn công bởi phishing để chèn mã độc

![npm](https://www.bleepstatic.com/content/hl-images/2025/05/08/npm.jpg)

Các thư viện JavaScript phổ biến đã bị chiếm đoạt trong tuần này và trở thành công cụ phát tán mã độc, trong một cuộc tấn công chuỗi cung ứng thông qua việc phishing và đánh cắp thông tin đăng nhập.

Gói npm [eslint-config-prettier](https://www.npmjs.com/package/eslint-config-prettier), được tải xuống hơn 30 triệu lần hàng tuần, đã bị xâm phạm sau khi người bảo trì của nó trở thành nạn nhân của một cuộc tấn công phishing. Một gói khác là [eslint-plugin-prettier](https://www.npmjs.com/package/eslint-plugin-prettier?activeTab=versions) từ cùng một người bảo trì cũng đã bị nhắm mục tiêu.

Kẻ tấn công đã sử dụng thông tin đăng nhập bị đánh cắp để xuất bản nhiều phiên bản không được ủy quyền của các gói với mã độc nhằm lây nhiễm cho các máy Windows.

## Người bảo trì bị phishing, thư viện bị xâm phạm

Vào ngày 18 tháng 7, các nhà phát triển bắt đầu nhận thấy hành vi bất thường sau khi cài đặt các phiên bản 8.10.1, 9.1.1, 10.1.6, và 10.1.7 của eslint-config-prettier. Những phiên bản này đã được xuất bản trên kho lưu trữ npm nhưng không có thay đổi tương ứng nào trong kho GitHub để xác nhận các bản phát hành, gây nghi ngờ ngay lập tức trong cộng đồng mã nguồn mở.

Những thư viện như eslint-config-prettier và eslint-plugin-prettier giúp các nhà phát triển làm việc dễ dàng hơn với Prettier và ESLint bằng cách đảm bảo rằng các quy tắc định dạng mã được phong cách nhất quán trong toàn bộ dự án mà không có xung đột hoặc linting dư thừa.

Nhà phát triển Dasa Paddock ban đầu đã nêu lên một [vấn đề](http://github.com/prettier/eslint-config-prettier/issues/339) trên kho lưu trữ của dự án để làm sáng tỏ vấn đề và các thành viên trong cộng đồng đã nhanh chóng tham gia.

Không lâu sau đó, người bảo trì của gói, JounQin, [xác nhận](https://github.com/prettier/eslint-config-prettier/issues/339#issuecomment-3090304490) rằng ông đã trở thành nạn nhân của một cuộc tấn công phishing. Điều này đã cho phép một bên không được ủy quyền có quyền truy cập vào mã thông báo npm của ông và xuất bản các phiên bản bị xâm phạm.

"Đây là email phishing," JounQin viết, chia sẻ một ảnh chụp màn hình của email thuyết phục "Xác minh tài khoản của bạn" mà ông đã nhận:

![Email phishing nhận được bởi người bảo trì thư viện npm](https://www.bleepstatic.com/images/news/u/1164866/2025/Jul/npm-library-hijacked/phishing-email.jpg)

**Email phishing nhận được bởi người bảo trì thư viện npm** (JounQin)

Email đã được giả mạo để giống như phát xuất từ "support@npmjs.com", nhưng liên kết trong đó dẫn người dùng đến một miền trái phép _npnjs\[.\]com_.

"Tôi đã xóa mã thông báo npm đó và sẽ xuất bản một phiên bản mới ngay lập tức," JounQin nói.

"Cảm ơn mọi người, và xin lỗi vì sự lơ là của tôi," người bảo trì tiếp tục viết trong cùng một chủ đề.

## Kịch bản postinstall độc hại chạy DLL Windows

Trong các phiên bản độc hại, một kịch bản _postinstall_ của npm "install.js" được cấu hình để chạy ngay lập tức khi gói được cài đặt.

Kịch bản "install.js" này chứa một hàm đáng ngờ _logDiskSpace()_, mà, trái ngược với tên của nó không liên quan đến việc giám sát dung lượng ổ đĩa. Thay vào đó, hàm này cố gắng thực thi DLL "node-gyp.dll" được gói kèm trong gói, thông qua quy trình hệ thống rundll32 của Windows.

![Hàm độc hại trong tệp install.js](https://www.bleepstatic.com/images/news/u/1164866/2025/Jul/npm-library-hijacked/postinstall.jpg)

**Hàm độc hại trong tệp install.js** (BleepingComputer)

Tại thời điểm viết bài, DLL, một trojan đã được công nhận, có [điểm phát hiện 19/72](https://www.virustotal.com/gui/file/c68e42f416f482d43653f36cd14384270b54b68d6496a8e34ce887687de5b441) trên VirusTotal, có nghĩa là nó vẫn bị bỏ qua bởi phần lớn các công cụ diệt virus.

## Bạn nên làm gì?

* **Không cài đặt các phiên bản `eslint-config-prettier` 8.10.1, 9.1.1, 10.1.6, và 10.1.7**. Đối với `eslint-plugin-prettier`, các phiên bản bị ảnh hưởng là **4.2.2 và 4.2.3.**
* Xác minh các tệp `package-lock.json` hoặc `yarn.lock` của bạn để tìm các tham chiếu đến những phiên bản này.
* Nếu bạn đã triển khai các bản xây dựng sau ngày 18 tháng 7, hãy kiểm tra các nhật ký CI và môi trường chạy để tìm dấu hiệu xâm phạm, đặc biệt là trên các máy Windows.
* Cân nhắc việc xoay xở bất kỳ bí mật nào có thể đã bị lộ trong quá trình xây dựng bị ảnh hưởng.

Người bảo trì cũng đã đánh dấu các phiên bản bị ảnh hưởng là "deprecated" trên kho npmjs. Thêm vào đó, một [người dùng GitHub đã cảnh báo](https://github.com/prettier/eslint-config-prettier/issues/339#issuecomment-3090311066) rằng bất kỳ gói nào khác được xuất bản bởi người bảo trì cũng cần được kiểm tra để phát hiện dấu hiệu có thể bị thao túng.

**Các phiên bản bị xâm phạm được đánh dấu là deprecated trên npmjs** (BleepingComputer)

Cuộc xâm phạm này theo sau một loạt các cuộc tấn công kỹ thuật xã hội tương tự đã nhắm vào các nhà phát triển của các thư viện nổi tiếng trong thời gian gần đây.

Vào tháng 3, [hơn mười thư viện npm được sử dụng rộng rãi](https://www.bleepingcomputer.com/news/security/infostealer-campaign-compromises-10-npm-packages-targets-devs/) đã bị xâm phạm và trở thành các công cụ đánh cắp thông tin. Tháng trước, [17 gói Gluestack](https://www.bleepingcomputer.com/news/security/supply-chain-attack-hits-gluestack-npm-packages-with-960k-weekly-downloads/) với hơn một triệu lượt tải xuống hàng tuần đã bị chiếm đoạt để triển khai một Trojan truy cập từ xa (RAT).

Khi mà hệ sinh thái mã nguồn mở chủ yếu hoạt động trên nền tảng tin cậy, các sự cố như thế này nhấn mạnh sự mong manh của bảo mật chuỗi cung ứng và tầm quan trọng của bảo mật người bảo trì. Một cú nhấp sai có thể đủ để đặt hàng triệu người dùng vào tình trạng rủi ro.