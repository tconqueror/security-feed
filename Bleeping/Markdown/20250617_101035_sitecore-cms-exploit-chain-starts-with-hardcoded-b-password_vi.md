# Chuỗi khai thác Sitecore CMS bắt đầu với mật khẩu 'b' được mã hóa cứng

![Card](https://www.bleepstatic.com/content/hl-images/2024/12/15/hacker-card.jpg)

Một chuỗi lỗ hổng trên Sitecore Experience Platform (XP) cho phép kẻ tấn công thực hiện Remote Code Execution (RCE) mà không cần xác thực để xâm nhập và chiếm đoạt máy chủ.

Sitecore là một CMS doanh nghiệp phổ biến được các doanh nghiệp sử dụng để tạo và quản lý nội dung trên các trang web và phương tiện kỹ thuật số.

Được phát hiện bởi các [ nhà nghiên cứu watchTowr](https://labs.watchtowr.com/is-b-for-backdoor-pre-auth-rce-chain-in-sitecore-experience-platform/), chuỗi RCE trước xác thực được tiết lộ hôm nay bao gồm ba lỗ hổng riêng biệt. Nó phụ thuộc vào sự hiện diện của một người dùng nội bộ (sitecore\ServicesAPI) với mật khẩu mã hóa cứng được đặt thành "b", khiến việc chiếm đoạt trở nên đơn giản.

Người dùng tích hợp này không phải là quản trị viên và không có vai trò được phân công. Tuy nhiên, các nhà nghiên cứu vẫn có thể sử dụng nó để xác thực qua một đường dẫn đăng nhập thay thế (/sitecore/admin) do kiểm tra đăng nhập chỉ dành cho backend của Sitecore bị bỏ qua trong các ngữ cảnh cơ sở dữ liệu không cốt lõi.

Kết quả là một phiên ".AspNet.Cookies" hợp lệ, cho phép kẻ tấn công truy cập xác thực vào các điểm cuối nội bộ được bảo vệ bởi ủy quyền cấp IIS nhưng không phải kiểm tra vai trò Sitecore.

Với điểm tựa ban đầu đã được củng cố, các kẻ tấn công có thể khai thác lỗ hổng thứ hai, một lỗi Zip Slip trong Upload Wizard của Sitecore.

Như watchTowr giải thích, một tệp ZIP được tải lên qua wizard có thể chứa một đường dẫn tệp độc hại như `/\/../webshell.aspx`. Do việc không đủ tiêu chuẩn hóa đường dẫn và cách Sitecore ánh xạ đường dẫn, điều này dẫn đến việc ghi các tệp tùy ý vào webroot, ngay cả khi không biết đường dẫn hệ thống đầy đủ.

Điều này cho phép kẻ tấn công tải lên một webshell và thực thi mã từ xa.

Một lỗ hổng thứ ba có thể bị khai thác khi mô-đun Sitecore PowerShell Extensions (SPE) được cài đặt (thường đi kèm với SXA).

Lỗi này cho phép kẻ tấn công tải lên các tệp tùy ý đến các đường dẫn được chỉ định bởi kẻ tấn công, hoàn toàn bỏ qua các hạn chế về mở rộng hoặc địa điểm và cung cấp một con đường đơn giản hơn đến RCE đáng tin cậy.

## Tác động và rủi ro

Ba lỗ hổng được báo cáo bởi watchTowr ảnh hưởng đến các phiên bản Sitecore XP từ 10.1 đến 10.4.

Các quét của WatchTowr cho thấy hơn 22.000 phiên bản Sitecore được công khai, làm nổi bật một bề mặt tấn công đáng kể, mặc dù không phải tất cả đều dễ bị tổn thương.

Các bản sửa lỗi giải quyết các vấn đề đã được cung cấp vào tháng 5 năm 2025, nhưng các ID CVE và chi tiết kỹ thuật đã bị cấm cho đến ngày 17 tháng 6 năm 2025, để khách hàng có thời gian cập nhật.

"Sitecore đang được triển khai trên hàng nghìn môi trường, bao gồm ngân hàng, hàng không và doanh nghiệp toàn cầu - vì vậy bán kính thương vong ở đây rất lớn," giám đốc điều hành của watchTowr, Benjamin Harris, đã bình luận với BleepingComputer.

"Và không, đây không phải là lý thuyết: chúng tôi đã chạy toàn bộ chuỗi, từ đầu đến cuối. Nếu bạn đang chạy Sitecore, không có gì tệ hơn thế này - hãy thay đổi mật khẩu và sửa lỗi ngay lập tức trước khi kẻ tấn công không thể đảo ngược kỹ thuật sửa lỗi."

Tại thời điểm viết bài, không có bằng chứng công khai nào về việc khai thác xảy ra trong thực tế.

Tuy nhiên, blog kỹ thuật của watchTowr chứa đủ thông tin để xây dựng một khai thác hoạt động hoàn chỉnh, vì vậy rủi ro lạm dụng trong thế giới thực là sắp xảy ra.