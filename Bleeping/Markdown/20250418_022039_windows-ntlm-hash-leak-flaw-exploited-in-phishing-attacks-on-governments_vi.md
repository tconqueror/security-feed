# Lỗ hổng rò rỉ NTLM hash của Windows bị khai thác trong các cuộc tấn công phishing nhắm vào chính phủ

![Hacker card](https://www.bleepstatic.com/content/hl-images/2024/12/15/hacker-card.jpg)

Một lỗ hổng của Windows cho phép rò rỉ NTLM hash thông qua các tệp .library-ms hiện đang bị các hacker khai thác trong các chiến dịch phishing nhắm vào các cơ quan chính phủ và các công ty tư nhân.

Lỗ hổng được theo dõi là [CVE-2025-24054](https://msrc.microsoft.com/update-guide/en-US/advisory/CVE-2025-24054) đã được khắc phục trong [Patch Tuesday tháng 3 năm 2025](https://www.bleepingcomputer.com/news/microsoft/microsoft-march-2025-patch-tuesday-fixes-7-zero-days-57-flaws/) của Microsoft. Ban đầu, lỗ hổng này không được đánh dấu là đang bị khai thác tích cực và được đánh giá là 'ít khả năng' xảy ra.

Tuy nhiên, các nhà nghiên cứu Check Point báo cáo đã quan sát thấy hoạt động khai thác tích cực cho CVE-2025-24054 chỉ vài ngày sau khi bản vá được phát hành, đạt đỉnh giữa khoảng thời gian từ 20 đến 25 tháng 3 năm 2025.

Mặc dù một địa chỉ IP đứng sau các cuộc tấn công này đã từng liên kết với nhóm đe dọa do nhà nước Nga tài trợ APT28 ('Fancy Bear'), nhưng điều này không đủ làm bằng chứng cho việc xác định chắc chắn.

## Rò rỉ NTLM hash

NTLM (New Technology LAN Manager) là một giao thức xác thực của Microsoft sử dụng thương lượng thách thức-phản hồi, liên quan đến các hash thay vì truyền thông tin mật khẩu dạng văn bản để xác thực người dùng.

Trong khi NTLM tránh việc truyền thông tin mật khẩu dạng văn bản trực tiếp, nó không còn được coi là an toàn do các lỗ hổng như [tấn công replay](https://www.bleepingcomputer.com/news/microsoft/new-dfscoerce-ntlm-relay-attack-allows-windows-domain-takeover/) và [giải mã brute-force các hash bị bắt](https://www.bleepingcomputer.com/news/security/understanding-the-windows-credential-leak-flaw-and-how-to-prevent-it/).

Vì lý do này, Microsoft đã [bắt đầu ngừng sử dụng xác thực NTLM](https://www.bleepingcomputer.com/news/microsoft/microsoft-deprecates-windows-ntlm-authentication-protocol/)  để chuyển sang Kerberos hoặc Negotiate.

Trong các cuộc tấn công mà Check Point đã thấy, các email phishing được gửi đến các tổ chức ở Ba Lan và Romania, bao gồm một liên kết Dropbox tới một tệp ZIP, chứa một tệp .library-ms.

![Unzipped exploit file](https://www.bleepstatic.com/images/news/u/1220909/2025/April/exploit-file.jpg)

**Email lừa đảo đính kèm tệp khai thác (đã giải nén)**  
_Nguồn: Check Point_

Tệp library-ms là một loại tệp hợp pháp, khi được mở ra, nó hiển thị một [Windows library](https://learn.microsoft.com/en-us/windows/client-management/client-tools/windows-libraries), hoặc một container ảo, chứa các tệp và thư mục từ nhiều nguồn đã được cấu hình khác nhau.

Trong cuộc tấn công phishing này, tệp library-ms được tạo ra để chứa một đường dẫn đến một máy chủ SMB từ xa do kẻ tấn công kiểm soát.

![Malicious .library-ms file](https://www.bleepstatic.com/images/news/security/l/library-ms/CVE-2025-24054/malicious-library-ms-file.jpg)

**Tệp .library-ms độc hại**  
_Nguồn: Check Point_

Khi giải nén tệp ZIP chứa một tệp .library-ms, Windows Explorer sẽ tự động tương tác với nó, kích hoạt lỗ hổng CVE-2025-24054 và khiến Windows kết nối SMB đến URL được chỉ định trong tệp.

Khi Windows kết nối đến máy chủ SMB từ xa, nó sẽ cố gắng xác thực qua NTLM, cho phép kẻ tấn công bắt được NTLM hashes của người dùng.

Trong một chiến dịch sau đó, Check Point đã phát hiện các email phishing chứa các tệp đính kèm .library-ms, mà không cần một tệp nén. Chỉ cần tải xuống tệp .library-ms cũng đủ để kích hoạt xác thực NTLM đến máy chủ từ xa, cho thấy rằng việc giải nén không cần thiết để khai thác lỗ hổng này.

"Vào ngày 25 tháng 3 năm 2025, Check Point Research đã phát hiện một chiến dịch nhắm đến các công ty trên toàn thế giới, phân phối những tệp này mà không cần nén," [giải thích Check Point](https://research.checkpoint.com/2025/cve-2025-24054-ntlm-exploit-in-the-wild/).

"Theo Microsoft, lỗ hổng này được kích hoạt với ít tương tác từ người dùng với một tệp độc hại, chẳng hạn như chọn (nhấp chuột một lần), kiểm tra (nhấp chuột phải), hoặc thực hiện bất kỳ hành động nào ngoài việc mở hoặc thực thi tệp."

Tệp nén độc hại cũng chứa thêm ba tệp nữa, có tên 'xd.url', 'xd.website', và 'xd.link', tận dụng các lỗ hổng rò rỉ NTLM hash cũ hơn và rất có thể được bao gồm để phòng ngừa trong trường hợp phương pháp 'library-ms' thất bại.

Check Point cho biết các máy chủ SMB do kẻ tấn công kiểm soát trong chiến dịch này sử dụng địa chỉ IP 159.196.128\[.\]120 và 194.127.179\[.\]157.

Việc bắt được NTLM hashes có thể mở ra con đường cho việc bỏ qua xác thực và leo thang quyền hạn, vì vậy mặc dù CVE-2025-24054 chỉ được đánh giá là một vấn đề có mức độ nghiêm trọng "trung bình", nhưng các hậu quả tiềm tàng của nó là rất nghiêm trọng.

Với mức độ tương tác thấp cần thiết để khai thác, các tổ chức nên xem đây như là một vấn đề có rủi ro cao. Các tổ chức được khuyên nên cài đặt các bản cập nhật tháng 3 năm 2025 và tắt xác thực NTLM nếu không cần thiết.