# Phần mềm độc hại Koske Linux mới ẩn mình trong hình ảnh gấu trúc dễ thương

![Phần mềm độc hại Koske Linux mới ẩn mình trong hình ảnh gấu trúc dễ thương](https://www.bleepstatic.com/content/hl-images/2022/11/18/Panda_hackers.jpg)

Một phần mềm độc hại Linux mới có tên là Koske có thể đã được phát triển bằng trí tuệ nhân tạo và đang sử dụng các hình ảnh JPEG dường như vô hại của những con gấu trúc để triển khai phần mềm độc hại trực tiếp vào bộ nhớ hệ thống.

Các nhà nghiên cứu từ công ty an ninh mạng AquaSec đã phân tích Koske và mô tả nó là "một mối đe dọa Linux tinh vi." Dựa trên hành vi thích ứng được quan sát, các nhà nghiên cứu tin rằng phần mềm độc hại đã được phát triển bằng cách sử dụng các mô hình ngôn ngữ lớn (LLMs) hoặc các khung tự động hóa.

Mục đích của Koske là triển khai các thợ đào tiền điện tử tối ưu hóa CPU và GPU, sử dụng tài nguyên tính toán của máy chủ để khai thác hơn 18 loại tiền khác nhau.

AquaSec đã xác định được các địa chỉ IP có trụ sở tại Serbia sử dụng trong các cuộc tấn công, các cụm từ tiếng Serbia trong các kịch bản, và ngôn ngữ Slovakia trong kho GitHub lưu trữ các thợ đào, nhưng không thể xác định được nguồn gốc một cách tự tin.

## Tấn công từ gấu trúc

Quyền truy cập ban đầu được đạt được bằng cách tận dụng các cấu hình sai lệch của các phiên bản JupyterLab được công khai trực tuyến để thực hiện lệnh.

Sau khi có được chỗ đứng, kẻ tấn công tải xuống hai hình ảnh .JPEG của những con gấu trúc được lưu trữ trên các dịch vụ hợp pháp như hình ảnh OVH, freeimage và postimage. Tuy nhiên, các bức tranh ẩn chứa tải trọng độc hại.

AquaSec nhấn mạnh rằng kẻ đe dọa không sử dụng [steganography](https://www.bleepingcomputer.com/news/security/worok-hackers-hide-new-malware-in-pngs-using-steganography/) để ẩn dấu phần mềm độc hại bên trong hình ảnh mà dựa vào [polyglot files](https://www.bleepingcomputer.com/news/security/new-polyglot-malware-hits-aviation-satellite-communication-firms/), vốn hợp lệ trong nhiều định dạng khác nhau.

Trong các cuộc tấn công của Koske, cùng một tệp có thể được diễn dịch là cả hình ảnh và kịch bản, tùy thuộc vào ứng dụng mở hoặc xử lý nó.

Khi những bức ảnh gấu trúc có tiêu đề hình ảnh hợp lệ cho định dạng JPEG, chúng cũng bao gồm các kịch bản shell độc hại và mã C ở cuối, cho phép cả hai định dạng được diễn dịch riêng biệt.

Một người dùng mở chúng sẽ thấy một con gấu trúc dễ thương nhưng một trình thông dịch kịch bản sẽ thực hiện mã shell được đính kèm ở cuối tệp.

![Hình ảnh gấu trúc dường như vô hại (trên), nội dung tệp (dưới)](https://www.bleepstatic.com/images/news/u/1220909/2025/July/image.jpg)

**Hình ảnh gấu trúc dường như vô hại (trên), nội dung tệp (dưới)**  
_Nguồn: AquaSec_

Các cuộc tấn công mà AquaSec phát hiện ẩn chứa một tải trọng trong mỗi hình ảnh, cả hai đều được khởi động song song.

“Một tải trọng là mã C được viết trực tiếp vào bộ nhớ, được biên dịch và thực thi dưới dạng tệp đối tượng chia sẻ .so hoạt động như một rootkit,” [AquaSec giải thích](https://www.aquasec.com/blog/ai-generated-malware-in-panda-image-hides-persistent-linux-threat/).

“Tải trọng thứ hai là một kịch bản shell, cũng được thực thi từ bộ nhớ, sử dụng các tiện ích hệ thống tiêu chuẩn để chạy âm thầm và duy trì tính liên tục trong khi để lại ít dấu vết nhìn thấy.”

Kịch bản shell được thực thi trực tiếp trong bộ nhớ bằng cách lạm dụng các tiện ích gốc của Linux, thiết lập tính liên tục thông qua các tác vụ cron chạy mỗi 30 phút và các dịch vụ _systemd_ tùy chỉnh.

Nó cũng thực hiện việc tăng cường mạng và tránh proxy, ghi đè _/etc/resolv.conf_ để sử dụng Cloudflare và Google DNS, khóa nó bằng lệnh _chattr +i_, xóa iptables, thiết lập lại các biến proxy và sử dụng một mô-đun tùy chỉnh để bạo lực các proxy làm việc qua curl, wget và kiểm tra TCP thô.

Chủng loại và hành vi này là lý do mà các nhà nghiên cứu AquaSec nghi ngờ rằng kẻ đe dọa đã phát triển phần mềm độc hại với sự trợ giúp của một LLM hoặc một nền tảng tự động hóa.

Rootkit dựa trên C được biên dịch trong bộ nhớ và sử dụng [LD\_PRELOAD](https://www.bleepingcomputer.com/news/security/new-ubuntu-linux-security-bypasses-require-manual-mitigations/) để ghi đè chức năng readdir(), ẩn các quy trình, tệp và thư mục liên quan đến phần mềm độc hại khỏi các công cụ giám sát không gian người dùng.

Rootkit lọc các mục dựa trên các chuỗi như koske, hideproc, hoặc bằng cách đọc các PID ẩn từ /dev/shm/.hiddenpid.

Sau khi thiết lập quyền truy cập mạng và thiết lập tính liên tục, kịch bản shell tải xuống các thợ đào tiền ảo từ GitHub.

![Chuỗi tấn công hoàn chỉnh](https://www.bleepstatic.com/images/news/u/1220909/2025/July/chain.jpg)

**Chuỗi tấn công hoàn chỉnh**  
_Nguồn: AquaSec_

Trước khi triển khai, CPU và GPU của máy chủ được đánh giá để xác định thợ đào nào sẽ là sự lựa chọn hiệu quả nhất.

Koske hỗ trợ khai thác cho 18 loại tiền khác nhau, bao gồm Monero, Ravencoin, Zano, Nexa và Tari khó theo dõi.

Nếu một đồng tiền hoặc nhóm khai thác trở nên không khả dụng, phần mềm độc hại sẽ tự động chuyển sang một bản sao lưu trong danh sách nội bộ của nó, cho thấy một mức độ tự động hóa và thích ứng cao.

AquaSec cảnh báo rằng trong khi phần mềm độc hại do AI điều khiển như Koske đã gây lo ngại, các biến thể trong tương lai có thể tận dụng khả năng thích ứng theo thời gian thực, phát triển thành một lớp mối đe dọa nguy hiểm hơn nhiều.