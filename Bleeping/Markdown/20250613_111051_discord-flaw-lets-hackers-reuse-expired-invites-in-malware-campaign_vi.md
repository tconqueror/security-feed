+-+-+-
# Lỗi Discord cho phép tin tặc tái sử dụng các liên kết mời đã hết hạn trong chiến dịch phần mềm độc hại

![Lỗi Discord cho phép tin tặc tái sử dụng các liên kết mời đã hết hạn trong chiến dịch phần mềm độc hại](https://www.bleepstatic.com/content/hl-images/2025/05/08/Discord.jpg)

Tin tặc đang chiếm đoạt các liên kết mời Discord đã hết hạn hoặc đã bị xóa để hướng người dùng đến các trang web độc hại cung cấp các trojan truy cập từ xa và phần mềm độc hại ăn cắp thông tin.

Chiến dịch này dựa trên một lỗi trong hệ thống mời Discord để khai thác các cuộc tấn công đa giai đoạn mà vượt qua nhiều động cơ antivirus.

## "Hồi sinh" các liên kết mời Discord đã hết hạn

Liên kết mời Discord là các URL cho phép ai đó tham gia vào một máy chủ Discord cụ thể. Chúng chứa một mã mời, là một định danh duy nhất cho phép truy cập vào máy chủ và có thể là tạm thời, vĩnh viễn hoặc tùy chỉnh - các liên kết vanity có sẵn cho các máy chủ 'level 3' trả tiền cho các đặc quyền đặc biệt.

Là một phần của các đặc quyền cho các máy chủ Discord cấp 3, quản trị viên có thể tạo một mã mời cá nhân hóa. Đối với các máy chủ thông thường, Discord tự động tạo các liên kết mời ngẫu nhiên và khả năng một liên kết lặp lại là rất thấp.

Tuy nhiên, tin tặc nhận thấy rằng khi một máy chủ cấp 3 mất trạng thái tăng cường, mã mời tùy chỉnh trở nên khả dụng và có thể được lấy lại bởi một máy chủ khác.

Các nhà nghiên cứu tại công ty an ninh mạng Check Point cho biết điều này cũng đúng trong trường hợp của các lời mời tạm thời đã hết hạn hoặc các liên kết mời vĩnh viễn đã bị xóa.

Họ cho biết rằng "cơ chế tạo liên kết mời tùy chỉnh một cách bất ngờ cho phép bạn tái sử dụng các mã mời tạm thời đã hết hạn, và trong một số trường hợp, các mã mời vĩnh viễn đã bị xóa."

![Liên kết mời ví dụ (trên) và việc chiếm đoạt nó trong một kênh mới (dưới)](https://www.bleepstatic.com/images/news/u/1220909/2025/June/invite.jpg)

**Chiếm đoạt mã mời tạm thời (trên) và tái sử dụng nó trong một liên kết vanity (dưới)**  
_Nguồn: Check Point_

Ngoài ra, các nhà nghiên cứu cho biết cơ chế lỗi của Discord không thay đổi thời gian hết hạn của một mã mời tạm thời đã được tạo trước đó khi tái sử dụng nó như một liên kết mời vĩnh viễn.

"Các người dùng thường nhầm lẫn rằng bằng cách chỉ đơn giản là tích vào hộp này, họ đã làm cho lời mời hiện tại trở thành vĩnh viễn (và chính sự hiểu lầm này đã bị khai thác trong cuộc tấn công mà chúng tôi đã quan sát)" - [Check Point](https://research.checkpoint.com/2025/from-trust-to-threat-hijacked-discord-invites-used-for-multi-stage-malware-delivery/)

Một mã mời có chữ cái thường và chữ số không thể được đăng ký miễn là nó còn hoạt động. Tuy nhiên, nếu mã có chữ cái in hoa, nó có thể được tái sử dụng trong các liên kết vanity bằng chữ cái thường, ngay cả khi mã gốc vẫn hợp lệ.

Các nhà nghiên cứu Check Point giải thích rằng điều này xảy ra vì Discord lưu trữ và so sánh các liên kết vanity bằng chữ cái thường. Do đó, cùng một mã với chữ và chữ hoa có thể hợp lệ cho hai máy chủ riêng biệt cùng một lúc.

### Hướng đến các máy chủ độc hại

Các kẻ tấn công đang theo dõi các lời mời Discord đã bị xóa hoặc hết hạn và sử dụng chúng trong một chiến dịch đã ảnh hưởng đến 1.300 người dùng ở Mỹ, Vương quốc Anh, Pháp, Hà Lan và Đức, dựa trên số lượng tải xuống payload độc hại của Check Point.

Các nhà nghiên cứu cho biết rằng tội phạm mạng đang chiếm đoạt các liên kết mời Discord từ các cộng đồng hợp pháp và chia sẻ chúng trên mạng xã hội hoặc trang web cộng đồng chính thức. Để tăng tính xác thực cho sự lừa đảo, tin tặc thiết kế các máy chủ độc hại trông giống như thật.

Các máy chủ Discord độc hại chỉ hiển thị một kênh duy nhất cho khách truy cập, #verify, và một bot yêu cầu người dùng thực hiện quá trình xác minh.

![Kênh Discord của kẻ tấn công](https://www.bleepstatic.com/images/news/u/1220909/2025/June/discord-channel.jpg)

**Kênh Discord của kẻ tấn công**  
_Nguồn: Check Point_

Cố gắng thực hiện điều này khởi động một cuộc tấn công 'ClickFix' điển hình mà trong đó người dùng được chuyển hướng đến một trang web mô phỏng giao diện của Discord và giả vờ rằng CAPTCHA không tải được.

Người dùng bị lừa để mở hộp thoại Windows Run và dán một lệnh PowerShell, mà họ đã sao chép vào bảng tạm để thực hiện.

**Trang ClickFix**  
_Nguồn: Check Point_

Thực hiện điều này kích hoạt một cuộc tấn công đa giai đoạn liên quan đến các downloader PowerShell, các loader C++ được mã hóa, và các tệp VBScript.

Các payload cuối cùng được tải xuống từ dịch vụ hợp tác phần mềm và lưu trữ tệp Bitbucket hợp pháp, bao gồm:

* **AsyncRAT**: Được phân phối dưới dạng 'AClient.exe,' đây là phiên bản 0.5.8 của phần mềm độc hại mà sử dụng Pastebin để thu thập địa chỉ C2 của nó một cách động. Các khả năng của nó bao gồm thao tác tập tin, ghi lại phím và truy cập vào webcam/microphone
* **Skuld Stealer**: Được phân phối dưới dạng 'skul.exe,' đây là một phần mềm ăn cắp thông tin nhắm vào thông tin đăng nhập trình duyệt, cookie, token Discord, và dữ liệu ví tiền điện tử (tiêm JS để đánh cắp cụm từ ghi nhớ và mật khẩu bằng cách sử dụng Discord webhooks)
* **ChromeKatz**: Một phiên bản tùy chỉnh của công cụ mã nguồn mở, được phân phối dưới dạng 'cks.exe', có thể đánh cắp cookie và mật khẩu

Một tác vụ theo lịch cũng được thêm vào máy chủ để chạy lại loader phần mềm độc hại sau mỗi năm phút, các nhà nghiên cứu phát hiện ra.

**Chuỗi nhiễm từ ClickFix đến phần mềm độc hại**  
_Nguồn: Check Point_

Để bảo vệ trước mối đe dọa này, người dùng Discord được khuyến khích tránh tin tưởng vào các liên kết mời cũ, đặc biệt là những liên kết từ các bài viết nhiều tháng trước, xử lý các yêu cầu "xác minh" với sự cẩn trọng hơn, và không bao giờ chạy các lệnh PowerShell sao chép mà bạn không hoàn toàn hiểu.

Ngoài ra, các quản trị viên máy chủ Discord nên sử dụng các liên kết mời vĩnh viễn, mà khó chiếm đoạt hơn.