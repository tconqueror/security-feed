# Citrix Bleed 2 bị khai thác trước khi có PoC trong khi Citrix phủ nhận các cuộc tấn công

![Citrix](https://www.bleepstatic.com/content/hl-images/2023/07/20/Citrix-headpic.jpg)

Một lỗ hổng nghiêm trọng trong Citrix NetScaler, được theo dõi dưới mã CVE-2025-5777 và được gọi là "CitrixBleed 2", đã bị khai thác tích cực gần hai tuần trước khi [các khai thác proof-of-concept (PoC) được công bố công khai](https://www.bleepingcomputer.com/news/security/public-exploits-released-for-citrixbleed-2-netscaler-flaw-patch-now/), mặc dù Citrix tuyên bố không có bằng chứng về các cuộc tấn công.

GreyNoise đã xác nhận rằng các honeypots của họ đã phát hiện ra việc khai thác có mục tiêu từ các địa chỉ IP có trụ sở tại Trung Quốc vào ngày 23 tháng 6 năm 2025.

"GreyNoise đã quan sát thấy những nỗ lực khai thác tích cực đối với CVE-2025-5777 (CitrixBleed 2), một lỗ hổng tràn bộ nhớ trong Citrix NetScaler. Việc khai thác bắt đầu vào ngày 23 tháng 6 — gần hai tuần trước khi một proof-of-concept (PoC) công khai được công bố vào ngày 4 tháng 7," [giải thích GreyNoise](https://www.greynoise.io/blog/exploitation-citrixbleed-2-cve-2025-5777-before-public-poc).

"Chúng tôi đã tạo một thẻ vào ngày 7 tháng 7 để theo dõi hoạt động này. Vì GreyNoise gán các lưu lượng trước thẻ với các thẻ mới, những nỗ lực khai thác trước đó giờ có thể nhìn thấy trong GreyNoise Visualizer."

![Biểu đồ GreyNoise cho thấy các IP độc nhất nhắm vào Citrix Bleed 2](https://www.bleepstatic.com/images/news/security/c/citrix/citrixbleed-2/greynoise-graph-citrixbleed2.jpg)

**Biểu đồ GreyNoise cho thấy các IP độc nhất nhắm vào Citrix Bleed 2**  
_Nguồn: BleepingComputer_

GreyNoise đã xác nhận với Cơ quan An ninh mạng và Cơ sở hạ tầng Hoa Kỳ (CISA) vào ngày 9 tháng 7 rằng lỗ hổng này đã bị khai thác tích cực, dẫn đến việc cơ quan này đưa nó vào danh sách Lỗ hổng đã bị khai thác được biết đến (KEV) và [cho các cơ quan liên bang một ngày để sửa lỗi](https://www.bleepingcomputer.com/news/security/cisa-tags-citrix-bleed-2-as-exploited-gives-agencies-a-day-to-patch/).

Bất chấp những dấu hiệu sớm này và [cảnh báo nhiều lần](https://doublepulsar.com/citrixbleed-2-exploitation-started-mid-june-how-to-spot-it-f3106392aa71) từ nhà nghiên cứu an ninh Kevin Beaumont, Citrix vẫn chưa thừa nhận việc khai thác tích cực trong [khuyến cáo bảo mật cho CVE-2025-5777](https://support.citrix.com/support-home/kbsearch/article?articleNumber=CTX693420). Họ chỉ âm thầm cập nhật bài đăng blog [ngày 26 tháng 6](https://www.netscaler.com/blog/news/netscaler-critical-security-updates-for-cve-2025-6543-and-cve-2025-5777/) vào ngày 11 tháng 7, sau khi nó xuất hiện trong cơ sở dữ liệu KEV vào ngày trước đó.

Cuối cùng Citrix đã phát hành [một bài viết blog khác](https://www.netscaler.com/blog/news/evaluating-netscaler-logs-for-indicators-of-attempted-exploitation-of-cve-2025-5777/) vào ngày 15 tháng 7 về cách đánh giá nhật ký NetScaler để tìm kiếm các chỉ báo xâm phạm.

Tuy nhiên, ngay cả với điều này, công ty đã bị chỉ trích vì không minh bạch và chia sẻ các IOC mà các nhà nghiên cứu đã nói với BleepingComputer trước đó đã được chia sẻ với công ty.

Citrix cũng không phản hồi các câu hỏi của BleepingComputer về lý do tại sao khuyến cáo CVE-2025-5777 ban đầu vẫn không xác nhận việc khai thác.

## Lỗ hổng Citrix Bleed 2

Citrix Bleed 2 là một lỗ hổng nghiêm trọng với độ nghiêm trọng 9.3 do thiếu xác thực đầu vào, cho phép kẻ tấn công gửi các yêu cầu POST không hợp lệ đến các thiết bị NetScaler trong quá trình đăng nhập.

Điều này được khai thác bằng cách bỏ qua dấu "=" trong tham số "login=", khiến thiết bị rò rỉ 127 byte bộ nhớ. Các nhà nghiên cứu từ Horizon3 và WatchTowr đã chứng minh rằng các yêu cầu lặp đi lặp lại có thể được sử dụng để lộ thông tin nhạy cảm như token phiên hợp lệ.

Các token này có thể được sử dụng để đánh cắp các phiên Citrix và có được quyền truy cập trái phép vào các tài nguyên nội bộ.

Nhà nghiên cứu an ninh Kevin Beaumont đã từng tuyên bố rằng các yêu cầu POST lặp đi lặp lại đến `/doAuthentication.do` trong nhật ký NetScaler là một chỉ báo tốt rằng ai đó đang cố gắng khai thác lỗ hổng, đặc biệt khi lời yêu cầu bao gồm tiêu đề Content-Length: 5.

Các chỉ báo khác bao gồm các mục nhật ký cho thấy người dùng đăng xuất mà tên người dùng bao gồm các ký tự không bình thường, như "#", hoặc nội dung bộ nhớ được in ra vào các trường không chính xác.

Beaumont cũng cảnh báo rằng hướng dẫn của Citrix không hoàn toàn xoá bỏ các phiên bị xâm phạm.

Trong khi Citrix đề nghị kết thúc các phiên ICA và PCoIP bằng cách sử dụng `kill icaconnection -all` và `kill pcoipConnection -all`, Beaumont khuyên nên kết thúc cả các loại phiên khác có thể đã bị đánh cắp:

```
kill pcoipConnection -all
kill icaconnection -all
kill rdpConnection -all
kill sshConnection -all
kill telnetConnection -all
kill connConnection -all
kill aaa session -all
```

Quản trị viên cũng nên xem xét tất cả các phiên trước khi kết thúc chúng để kiểm tra các đăng nhập đáng ngờ, như thay đổi địa chỉ IP không mong đợi hoặc người dùng trái phép.

Bài viết blog [ngày 15 tháng 7 của Citrix](https://www.netscaler.com/blog/news/evaluating-netscaler-logs-for-indicators-of-attempted-exploitation-of-cve-2025-5777/) chia sẻ thêm hướng dẫn về cách phát hiện dấu hiệu khai thác, chẳng hạn như các mục nhật ký cho thấy các thông điệp sau:

* "Authentication is rejected for"
* "AAA Message"
* Các giá trị byte không phải ASCII (0x80–0xFF)

Nhật ký phiên cũng có thể được kiểm tra thủ công để tìm kiếm những thay đổi địa chỉ IP bất thường liên quan đến cùng một phiên. Ví dụ, trong nhật ký VPN, sự không khớp giữa client_ip và địa chỉ IP nguồn có thể chỉ ra rằng một phiên đã bị đánh cắp.

Trong một bài viết gần đây, Beaumont tuyên bố rằng ông đã theo dõi việc khai thác từ tháng 6, với hơn 120 công ty đã bị xâm phạm bởi lỗ hổng.

"Truy cập bắt đầu vào ngày 20 tháng 6 năm 2025, và tăng dần từ ngày 21 cho đến hiện tại," [cảnh báo Beaumont](https://doublepulsar.com/citrixbleed-2-situation-update-everybody-already-got-owned-503c6d06da9f).

"Tôi nghĩ rằng hoạt động mà tôi thấy có thể là một nhóm tác nhân đe dọa — có thể có nhiều nhóm khác. Họ cẩn thận trong việc chọn mục tiêu, phân tích Netscaler trước khi tấn công để đảm bảo rằng đó là một hộp thật — ví dụ, họ không rơi vào bất kỳ honeypot nào của tôi."

Nhà nghiên cứu cũng cảnh báo rằng chính Tường lửa Ứng dụng Web của Citrix hiện không phát hiện ra các cuộc khai thác CVE-2025-5777\. Tuy nhiên, [Imperva báo cáo](http://who%20has%20detection%20coverage%20in%20their%20product%20reports%20that%20there) rằng sản phẩm của họ đã phát hiện hơn 11,5 triệu nỗ lực khai thác lỗ hổng này, với 40% nhắm vào lĩnh vực tài chính.

Citrix đã phát hành các bản vá cho các phiên bản NetScaler ADC và Gateway và đang kêu gọi nâng cấp ngay lập tức.

Không có biện pháp khắc phục nào khác ngoài việc vá lỗi, và những khách hàng đang chạy các phiên bản EOL (12.1 và 13.0) nên nâng cấp lên các phiên bản hỗ trợ.