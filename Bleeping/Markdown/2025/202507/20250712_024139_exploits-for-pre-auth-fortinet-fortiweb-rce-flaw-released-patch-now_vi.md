# Lỗ hổng RCE Fortinet FortiWeb trước xác thực đã được công bố, hãy cập nhật ngay

![Fortinet](https://www.bleepstatic.com/content/hl-images/2023/03/13/Fortinet.jpg)

Các khai thác proof-of-concept đã được phát hành cho một lỗ hổng SQLi nghiêm trọng trong Fortinet FortiWeb mà có thể được sử dụng để đạt được thực thi mã từ xa trước xác thực trên các máy chủ dễ bị tấn công.

FortiWeb là một tường lửa ứng dụng web (WAF), được sử dụng để bảo vệ các ứng dụng web khỏi lưu lượng HTTP độc hại và các mối đe dọa.

Lỗ hổng FortiWeb có điểm độ nghiêm trọng 9.8/10 và được theo dõi với mã CVE-2025-25257. Fortinet đã khắc phục lỗ hổng này vào tuần trước trong các phiên bản FortiWeb 7.6.4, 7.4.8, 7.2.11 và 7.0.11 và các phiên bản mới hơn.

"Các biện pháp trung hòa không đúng cách của các yếu tố đặc biệt được sử dụng trong lệnh SQL ('SQL Injection') [CWE-89] trong FortiWeb có thể cho phép một kẻ tấn công không xác thực thực thi mã hoặc lệnh SQL trái phép thông qua các yêu cầu HTTP hoặc HTTPS được định dạng," đọc [thông báo của Fortinet](https://fortiguard.fortinet.com/psirt/FG-IR-25-151).

Khuyết điểm này được phát hiện bởi Kentaro Kawane từ GMO Cybersecurity, người cũng đã tiết lộ một [lỗ hổng mật khẩu cứng trong Cisco ISE](https://www.bleepingcomputer.com/news/security/cisco-warns-of-ise-and-ccp-flaws-with-public-exploit-code/) vào tháng trước.

## FortiWeb SQLi trước xác thực đến RCE trước xác thực

Hôm nay, công ty an ninh mạng [WatchTowr](https://labs.watchtowr.com/pre-auth-sql-injection-to-rce-fortinet-fortiweb-fabric-connector-cve-2025-25257/) và một nhà nghiên cứu an ninh được biết đến với tên gọi "[faulty *ptrrr](https://pwner.gg/blog/2025-07-10-fortiweb-fabric-rce)" đã phát hành các bài viết kỹ thuật và các khai thác proof-of-concept mở reverse shell hoặc web shell.

Lỗ hổng này được tìm thấy trong Fabric Connector của FortiWeb, phần mềm đồng bộ hóa dữ liệu xác thực và chính sách giữa các sản phẩm Fortinet.

Phần mềm này chứa một lỗ hổng SQL injection không xác thực trong hàm `get_fabric_user_by_token()`, mà sử dụng đoạn mã sau để thực hiện một truy vấn MySQL:

```
snprintf(s, 0x400u, "select id from fabric_user.user_table where token='%s'", a1);
```

Đoạn mã này không làm sạch đúng cách token bearer gửi trong tiêu đề yêu cầu HTTP, cho phép kẻ tấn công chèn SQL tùy chỉnh vào tiêu đề để đạt được SQLi.

Kẻ tấn công có thể kích hoạt lỗ hổng thông qua các yêu cầu HTTP tới điểm đầu cuối _/api/fabric/device/status_ bằng cách chèn SQL vào tiêu đề Authorization (ví dụ: `Bearer AAAAAA'or'1'='1`), cho phép kẻ tấn công vượt qua các kiểm tra xác thực.

Các nhà nghiên cứu đã có thể nâng cao SQL injection lên thực thi mã từ xa bằng cách thực thi truy vấn MySQL [SELECT … INTO OUTFILE](https://dev.mysql.com/doc/refman/8.4/en/select-into.html#:~:text=them%20into%20variables.-,SELECT%20...%20INTO%20OUTFILE,-writes%20the%20selected) thông qua lỗ hổng SQLi để tạo các tệp tùy ý trên thiết bị. Điều này cho phép họ ghi một tệp Python .pth vào thư mục site-packages.

Vì các tệp .pth được tải tự động và chạy khi Python được thực thi, các nhà nghiên cứu đã tìm thấy một tệp kịch bản CGI Python hợp lệ của FortiWeb (`/cgi-bin/ml-draw.py`) có thể được sử dụng để khởi động mã độc trong tệp .pth và đạt được thực thi mã từ xa.

Vì các khai thác này hiện đã công khai và dễ dàng truy cập, được khuyến khích mạnh mẽ rằng các quản trị viên cần ưu tiên cài đặt các bản vá để ngăn chặn máy chủ bị xâm phạm.

Hiện tại, không có dấu hiệu nào cho thấy lỗ hổng này đang bị khai thác tích cực, nhưng điều này có thể sẽ thay đổi trong thời gian tới.