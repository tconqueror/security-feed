# Lỗ hổng Secure Boot mới cho phép kẻ tấn công cài đặt bootkit malware, hãy cập nhật ngay

![CPU và bo mạch chủ](https://www.bleepstatic.com/content/hl-images/2022/06/02/cpu-motherboard.jpg)

Các nhà nghiên cứu an ninh đã tiết lộ một lỗ hổng qua mặt Secure Boot mới được theo dõi là CVE-2025-3052, có thể được sử dụng để tắt bảo mật trên máy tính cá nhân và máy chủ, cùng với việc cài đặt bootkit malware.

Lỗ hổng này ảnh hưởng đến hầu như mọi hệ thống mà tin tưởng vào chứng chỉ "UEFI CA 2011" của Microsoft, hầu hết là tất cả phần cứng hỗ trợ Secure Boot.

Nhà nghiên cứu Binarly, Alex Matrosov, đã phát hiện ra lỗ hổng CVE-2025-3052 sau khi tìm thấy một tiện ích flashing BIOS được ký bằng chứng chỉ ký UEFI của Microsoft.

Tiện ích này ban đầu được thiết kế cho các máy tính bảng bền bỉ, nhưng vì nó được ký bằng chứng chỉ UEFI của Microsoft, nó có thể chạy trên bất kỳ hệ thống nào hỗ trợ Secure Boot.

Các cuộc điều tra tiếp theo đã phát hiện ra rằng mô-đun bị tổn thương đã lưu hành trên mạng từ ít nhất cuối năm 2022 và sau đó được tải lên VirusTotal vào năm 2024, nơi Binarly phát hiện ra nó.

Binarly đã thông báo cho CERT/CC vào ngày 26 tháng 2 năm 2025, với [CVE-2025-3052](https://msrc.microsoft.com/update-guide/en-US/advisory/CVE-2025-3052) được khắc phục hôm nay như một phần của [Microsoft June 2025 Patch Tuesday](https://www.bleepingcomputer.com/news/microsoft/microsoft-june-2025-patch-tuesday-fixes-exploited-zero-day-66-flaws/).

Tuy nhiên, trong quá trình này, Microsoft đã xác định rằng lỗ hổng đã ảnh hưởng đến 13 mô-đun khác, mà đã được thêm vào cơ sở dữ liệu thu hồi.

"Trong quá trình phân loại, Microsoft xác định rằng vấn đề không chỉ ảnh hưởng đến một mô-đun duy nhất như đã nghĩ ban đầu, mà thực tế là 14 mô-đun khác nhau," giải thích Binarly.

"Vì lý do này, dbx cập nhật phát hành trong ngày Thứ Ba vá lỗi vào ngày 10 tháng 6 năm 2025 chứa 14 băm mới."

## Lỗ hổng qua mặt Secure Boot

Lỗi này do một tiện ích cập nhật BIOS hợp pháp được ký bằng chứng chỉ UEFI CA 2011 của Microsoft, được tin cậy trên hầu hết các hệ thống hiện đại sử dụng firmware UEFI.

![Mô-đun bị tổn thương được ký bằng chứng chỉ UEFI CA 2011 của Microsoft](https://www.bleepstatic.com/images/news/Microsoft/vulnerabilities/CVE-2025-3052/uefi-tool-signed-with-microsoft-cert.jpg)

**Mô-đun bị tổn thương được ký bằng chứng chỉ UEFI CA 2011 của Microsoft**  
_Nguồn: Binarly_

Tiện ích này đọc một biến NVRAM có thể ghi từ người dùng (IhisiParamBuffer) mà không xác thực. Nếu một kẻ tấn công có quyền admin trên hệ điều hành, họ có thể sửa đổi biến này để dữ liệu tùy ý được ghi vào các vị trí bộ nhớ trong quá trình khởi động UEFI. Điều này được thực hiện trước khi hệ điều hành, hoặc thậm chí là kernel, được nạp.

Sử dụng lỗ hổng này, Binarly đã tạo ra một khai thác proof-of-concept để làm cho biến toàn cục 'gSecurity2' có giá trị bằng 0, biến này được sử dụng để thực thi Secure Boot.

"Đối với proof of concept (PoC) của chúng tôi, chúng tôi đã chọn ghi đè biến toàn cục gSecurity2," giải thích [báo cáo của Binarly](https://www.binarly.io/blog/another-crack-in-the-chain-of-trust).

"Biến này giữ một con trỏ đến Giao thức Kiến trúc Security2, mà hàm LoadImage sử dụng để thực thi Secure Boot. Bằng cách thiết lập nó bằng 0, chúng tôi hiệu quả tắt Secure Boot, cho phép thực thi bất kỳ mô-đun UEFI nào không có chữ ký."

Khi đã bị tắt, kẻ tấn công có thể cài đặt bootkit malware mà có thể ẩn mình khỏi hệ điều hành và tắt các chức năng bảo mật khác.

Để khắc phục CVE-2025-3052, Microsoft đã thêm các băm mô-đun bị ảnh hưởng vào danh sách thu hồi dbx của Secure Boot. Binarly và Microsoft khuyến cáo người dùng cài đặt ngay tệp dbx đã cập nhật thông qua các bản cập nhật bảo mật hôm nay để bảo vệ thiết bị của họ.

Hôm nay, một lỗ hổng Secure Boot khác ảnh hưởng đến firmware tương thích UEFI dựa trên Insyde H2O đã được Nikolaj Schlej công bố. Lỗi này, được gọi là [Hydroph0bia](https://coderush.me/hydroph0bia-part1/) và được theo dõi như CVE-2025-4275, đã được báo cáo cho Insyde và được vá 90 ngày sau khi công bố.

Binarly đã chia sẻ một video chứng minh cách mà PoC của họ có thể tắt Secure Boot và hiển thị một thông điệp trước khi hệ điều hành khởi động.