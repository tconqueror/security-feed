# Google tiết lộ phần mềm độc hại BadAudio được sử dụng trong các chiến dịch gián điệp của APT24

![Google tiết lộ phần mềm độc hại BadAudio được sử dụng trong các chiến dịch gián điệp của APT24](https://www.bleepstatic.com/content/hl-images/2025/03/05/hacker-china-flag.jpg)

Các hacker liên kết với China, APT24 đã sử dụng một phần mềm độc hại chưa được tài liệu hoá trước đây có tên BadAudio trong một chiến dịch gián điệp kéo dài ba năm, gần đây đã chuyển sang các phương pháp tấn công tinh vi hơn.

Kể từ 2022, phần mềm độc hại này đã được phân phối tới nạn nhân qua nhiều phương thức bao gồm spearphishing, tấn công chuỗi cung ứng và watering hole.

### Tiến hóa chiến dịch

Từ tháng 11 năm 2022 cho đến ít nhất tháng 9 năm 2025, APT24 đã xâm phạm hơn 20 trang web công cộng hợp pháp từ nhiều tên miền khác nhau để chèn mã JavaScript độc hại chọn lọc những khách truy cập quan tâm — tiêu điểm chỉ tập trung vào hệ thống Windows.

[![Wiz](https://www.bleepstatic.com/c/w/wiz/AI-Data-Security-970x250.png)](https://www.wiz.io/lp/ai-data-security-best-practices-cheat-sheet?utm%5Fsource=bleepingcomputer&utm%5Fmedium=display&utm%5Fcampaign=FY26Q3%5FINB%5FForm%5FAI-Data-Security-Best-Practices&sfcid=701Py00000SmgsrIAB&utm%5Fterm=FY26Q4-bleepingcomputer-970x250&utm%5Fcontent=AI-Data-Security-BP) 

Các nhà nghiên cứu tại Google Threat Intelligence Group (GTIG) cho biết rằng đoạn script đã lấy dấu vân tay của những khách truy cập đủ điều kiện là mục tiêu và hiển thị một cửa sổ pop-up cập nhật phần mềm giả mạo để dụ họ tải xuống BadAudio.

![APT24's fake update pop-up](https://www.bleepstatic.com/images/news/u/1220909/2025/November/update.jpg)

**Pop-up cập nhật giả mạo của APT24**  
_Nguồn: Google_

Bắt đầu từ tháng 7 năm 2024, APT24 nhiều lần xâm phạm một công ty tiếp thị kỹ thuật số ở Taiwan cung cấp các thư viện JavaScript cho các trang web khách hàng.

Thông qua chiến thuật này, kẻ tấn công đã chèn JavaScript độc hại vào một thư viện được sử dụng rộng rãi mà công ty phân phối, và đăng ký một tên miền giả mạo một Content Delivery Network (CDN) hợp pháp. Điều này cho phép kẻ tấn công xâm phạm hơn 1.000 tên miền.

Từ cuối năm 2024 đến tháng 7 năm 2025, APT24 nhiều lần xâm phạm cùng một công ty tiếp thị bằng cách chèn JavaScript gọn nhẹ, được che obfuscate vào một tệp JSON đã chỉnh sửa, tệp này được tải bởi một tệp JavaScript riêng biệt từ cùng nhà cung cấp.

Khi thực thi, nó lấy dấu vân tay từng người truy cập website và gửi một báo cáo mã hóa base64 tới máy chủ của kẻ tấn công, cho phép họ quyết định có phản hồi bằng URL giai đoạn tiếp theo hay không.

**Tổng quan về cuộc tấn công chuỗi cung ứng**  
_Nguồn: Google_

Song song đó, bắt đầu từ tháng 8 năm 2024, APT24 đã triển khai các chiến dịch spearphishing nhằm truyền tải phần mềm độc hại BadAudio bằng các email mồi nhử giả mạo các tổ chức cứu hộ động vật.

Trong một số biến thể của những cuộc tấn công này, APT24 đã sử dụng các dịch vụ đám mây hợp pháp như Google Drive và OneDrive để phân phối phần mềm độc hại, thay vì sử dụng máy chủ của riêng họ. Tuy nhiên, Google cho biết nhiều nỗ lực đã bị phát hiện và các thông điệp này đã kết thúc trong hộp spam.

Trong các trường hợp quan sát được, các email bao gồm các pixel theo dõi để xác nhận khi người nhận mở chúng.

**Dòng thời gian các phương thức tấn công của APT24**  
_Nguồn: Google_

## BadAudio malware loader

Theo phân tích của GTIG, phần mềm độc hại BadAudio được che obfuscate nặng nhằm trốn tránh phát hiện và cản trở phân tích bởi các nhà nghiên cứu bảo mật.

Nó thực hiện việc chạy thông qua DLL search order hijacking, một kỹ thuật cho phép một payload độc hại được tải bởi một ứng dụng hợp pháp.

"Phần mềm độc hại được thiết kế với control flow flattening — một kỹ thuật obfuscation tinh vi hệ thống phá hủy logic có cấu trúc tự nhiên của chương trình," GTIG giải thích trong một báo cáo hôm nay.

"Phương pháp này thay thế mã tuyến tính bằng một loạt các khối không liên kết được điều khiển bởi một 'dispatcher' trung tâm và một biến trạng thái, buộc các nhà phân tích phải lần theo từng đường dẫn thực thi một cách thủ công và làm chậm đáng kể cả nỗ lực đảo ngược tự động lẫn thủ công."

Khi BadAudio được thực thi trên thiết bị mục tiêu, nó thu thập các chi tiết hệ thống cơ bản (hostname, username, architecture), mã hóa thông tin bằng một khóa AES mã hóa cứng trong mã (hard-coded AES key), và gửi nó tới một địa chỉ command-and-control (C2) được mã hóa cứng.

Tiếp theo, nó tải xuống một payload mã hóa AES từ C2, giải mã nó, và thực thi nó trong bộ nhớ để né tránh bằng cách sử dụng DLL sideloading.

Trong ít nhất một trường hợp, các nhà nghiên cứu của Google đã quan sát việc triển khai Cobalt Strike Beacon thông qua BadAudio, một framework kiểm thử xâm nhập bị lạm dụng rộng rãi.

Các nhà nghiên cứu nhấn mạnh rằng họ không thể xác nhận sự hiện diện của Cobalt Strike Beacon trong mọi trường hợp họ phân tích.

Cần lưu ý rằng mặc dù sử dụng BadAudio trong ba năm, các thủ đoạn của APT24 đã thành công trong việc giữ cho phần mềm này phần lớn không bị phát hiện.

Từ tám mẫu mà các nhà nghiên cứu GTIG cung cấp trong báo cáo của họ, chỉ hai mẫu bị đánh dấu là độc hại bởi hơn 25 engine chống virus trên nền tảng VirusTotal. Phần còn lại của các mẫu, có ngày tạo là 7 tháng 12, 2022, chỉ bị phát hiện bởi tối đa năm giải pháp bảo mật.

GTIG cho biết rằng sự tiến hóa của APT24 theo hướng các cuộc tấn công tàng hình hơn được thúc đẩy bởi năng lực tác nghiệp của nhóm đe doạ và "khả năng gián điệp kiên trì và thích nghi" của họ.