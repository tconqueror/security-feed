# Tin tặc Nga lạm dụng Hyper-V để ẩn phần mềm độc hại trong Linux VMs

![Tin tặc Nga lạm dụng Hyper-V để ẩn phần mềm độc hại trong Linux VMs](https://www.bleepstatic.com/content/hl-images/2024/06/06/Russian-spies.jpg)

Nhóm tin tặc Nga Curly COMrades đang lạm dụng Hyper-V của Microsoft trên Windows để vượt qua các giải pháp phát hiện và phản ứng điểm cuối bằng cách tạo một máy ảo ẩn dựa trên Alpine Linux để chạy phần mềm độc hại.

Bên trong môi trường ảo, tác nhân gây hại lưu trữ các công cụ tùy chỉnh của họ, CurlyShell reverse shell và CurlCat reverse proxy, cho phép hoạt động tàng hình và liên lạc.

Curly COMrades là một nhóm gián điệp mạng được cho là hoạt động từ giữa năm 2024\. Các hoạt động của nhóm này có liên quan chặt chẽ đến lợi ích địa chính trị của Nga.

[![Wiz](https://www.bleepstatic.com/c/w/wiz/MCP-Research-Guide-970x250.png)](https://www.wiz.io/lp/inside-mcp-security-a-research-guide-on-emerging-risks?utm%5Fsource=bleepingcomputer&utm%5Fmedium=display&utm%5Fcampaign=FY26Q2%5FINB%5FFORM%5FMCP-Security-Research-Guide-Emerging-Risks&sfcid=701Py00000PcNI9IAN&utm%5Fterm=FY26Q4-bleepingcomputer-970x250&utm%5Fcontent=MCP-Security-Guide) 

Bitdefender trước đây đã phơi bày hoạt động của Curly COMrades nhắm vào các cơ quan chính phủ và tư pháp ở Georgia, cũng như các công ty năng lượng ở Moldova.

Với sự hỗ trợ của Georgian CERT, công ty an ninh mạng Romania đã khám phá thêm về chiến dịch mới nhất của tác nhân này.

Các nhà nghiên cứu phát hiện rằng vào đầu tháng Bảy, sau khi giành được quyền truy cập từ xa vào hai máy, Curly COMrades đã thực thi các lệnh để kích hoạt Hyper-V và vô hiệu hóa giao diện quản lý của nó.

Microsoft bao gồm công nghệ hypervisor gốc Hyper-V cung cấp khả năng ảo hóa phần cứng trong Windows (Pro và Enterprise) và hệ điều hành Windows Server, cho phép người dùng chạy các máy ảo (VM).

"Những kẻ tấn công đã kích hoạt vai trò Hyper-V trên các hệ thống nạn nhân được chọn để triển khai một máy ảo tối giản, dựa trên Alpine Linux. Môi trường ẩn này, với dấu chân nhẹ (chỉ 120MB dung lượng đĩa và 256MB bộ nhớ), lưu trữ reverse shell tùy chỉnh của họ, CurlyShell, và một reverse proxy, CurlCat," Bitdefender giải thích trong một báo cáo chia sẻ với BleepingComputer.

![CurlCat (left) and CurlShell (right)](https://www.bleepstatic.com/images/news/u/1220909/2025/November/curlcode.jpg)

**CurlCat (trái) và CurlShell (phải)**  
_Nguồn: Bitdefender_

Bằng cách giữ phần mềm độc hại và quá trình thực thi bên trong máy ảo (VM), những kẻ tấn công có thể vượt qua các phát hiện EDR dựa trên host truyền thống, vốn thiếu khả năng kiểm tra mạng để phát hiện lưu lượng điều khiển và chỉ huy (C2) từ VM.

Mặc dù dựa vào ảo hóa để né tránh phát hiện không phải là một kỹ thuật mới, phạm vi bảo phủ phân mảnh của các công cụ bảo mật khiến nó trở thành một phương pháp hiệu quả trên các mạng thiếu một hệ thống bảo vệ tổng thể, nhiều lớp.

Trong các cuộc tấn công của Curly COMrades, việc né tránh đạt được bằng cách sử dụng tên 'WSL' cho VM, ám chỉ tính năng Windows Subsystem for Linux trong hệ điều hành, với hy vọng trượt khỏi sự chú ý.

Máy ảo Alpine Linux được cấu hình trong Hyper-V để sử dụng adapter mạng Default Switch, điều phối tất cả lưu lượng thông qua ngăn xếp mạng của host.

"Thực tế, tất cả các liên lạc độc hại đi ra ngoài đều xuất hiện như bắt nguồn từ địa chỉ IP của máy host hợp lệ," các nhà nghiên cứu của Bitdefender giải thích.

Hai implant tùy chỉnh được triển khai trong VM là các nhị phân ELF dựa trên libcurl và được sử dụng để thực thi lệnh và dẫn đường lưu lượng:

* **CurlyShell** – Thực thi lệnh, chạy bên trong VM Alpine ẩn và duy trì tính bền vững thông qua một cron job. Nó chạy ở chế độ headless và kết nối tới command-and-control (C2) qua HTTPS
* **CurlCat** – Công cụ đồng hành được sử dụng khi cần dẫn đường, được shell implant gọi để tạo một SOCKS proxy bí mật trở lại cho toán đội. Nó đóng gói lưu lượng SSH vào các yêu cầu HTTPS, cho phép pivot mạng trong khi hòa lẫn với tiếng ồn hoạt động bình thường.

Trong khi điều tra các sự cố, các nhà nghiên cứu cũng phát hiện rằng Curly COMrades đã sử dụng hai script PowerShell để duy trì và pivot tới các hệ thống từ xa.

"Một script được thiết kế để tiêm một Kerberos ticket vào LSASS, cho phép xác thực tới các hệ thống từ xa và thực thi lệnh," các nhà nghiên cứu cho biết.

Script thứ hai được triển khai thông qua tính năng Group Policy và tạo một tài khoản cục bộ trên các máy trong cùng domain.

Các nhà nghiên cứu lưu ý rằng mức độ tinh vi của các cuộc tấn công Curly COMrades được điều tra cho thấy một hoạt động được thiết kế để tàng hình và an ninh tác chiến. Những kẻ tấn công đã mã hóa các payload nhúng và lạm dụng khả năng của PowerShell, điều này dẫn đến dấu vết pháp y tối thiểu trên các host bị xâm phạm.

Dựa trên các quan sát trong những cuộc tấn công này, Bitdefender gợi ý rằng các tổ chức nên giám sát việc kích hoạt Hyper-V bất thường, truy cập LSASS, hoặc các script PowerShell được triển khai qua Group Policy mà kích hoạt đặt lại mật khẩu tài khoản cục bộ, hoặc tạo tài khoản mới.