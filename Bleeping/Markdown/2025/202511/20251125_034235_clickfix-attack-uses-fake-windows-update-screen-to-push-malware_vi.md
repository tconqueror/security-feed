# Cuộc tấn công ClickFix sử dụng màn hình Windows Update giả để cài đặt phần mềm độc hại

![ClickFix attack uses fake Windows Update screen to push malware](https://www.bleepstatic.com/content/hl-images/2025/10/20/Windows-headpic.jpg)

Các biến thể của cuộc tấn công ClickFix đã được quan sát, trong đó những tác nhân đe dọa lừa người dùng bằng một hoạt ảnh Windows Update trông rất thực tế trong một trang trình duyệt toàn màn hình và giấu mã độc bên trong các hình ảnh.

ClickFix là một cuộc tấn công kỹ thuật xã hội, nơi người dùng bị thuyết phục dán và thực thi trong Windows Command Prompt các đoạn mã hoặc lệnh dẫn đến việc chạy phần mềm độc hại trên hệ thống.

Cuộc tấn công này đã được tội phạm mạng áp dụng rộng rãi ở mọi cấp độ do hiệu quả cao của nó và liên tục tiến hóa, với các mồi nhử ngày càng tinh vi và lừa đảo hơn [increasingly](https://www.bleepingcomputer.com/news/security/clickfix-malware-attacks-evolve-with-multi-os-support-video-tutorials/).

[![Wiz](https://www.bleepstatic.com/c/w/wiz/AI-Data-Security-970x250.png)](https://www.wiz.io/lp/ai-data-security-best-practices-cheat-sheet?utm%5Fsource=bleepingcomputer&utm%5Fmedium=display&utm%5Fcampaign=FY26Q3%5FINB%5FForm%5FAI-Data-Security-Best-Practices&sfcid=701Py00000SmgsrIAB&utm%5Fterm=FY26Q4-bleepingcomputer-970x250&utm%5Fcontent=AI-Data-Security-BP) 

### Trang trình duyệt toàn màn hình

Kể từ ngày 1 tháng Mười, các nhà nghiên cứu đã quan sát các cuộc tấn công ClickFix trong đó lý do để thực thi các lệnh nguy hiểm là hoàn tất cài đặt một bản cập nhật bảo mật Windows quan trọng và mồi nhử "xác minh con người" phổ biến hơn \[[1](https://www.bleepingcomputer.com/news/security/clickfix-attack-delivers-infostealers-rats-in-fake-bookingcom-emails/), [2](https://www.bleepingcomputer.com/news/security/clickfix-malware-attacks-evolve-with-multi-os-support-video-tutorials/)\].

Trang cập nhật giả hướng dẫn nạn nhân nhấn các phím cụ thể theo một thứ tự nhất định, việc này sẽ dán và thực thi các lệnh từ kẻ tấn công đã được tự động sao chép vào clipboard thông qua JavaScript chạy trên trang.

![Fake Windows security update screen](https://www.bleepstatic.com/images/news/u/1100723/ClickFix_attack.png)

**Màn hình cập nhật bảo mật Windows giả**  
_Source: BleepingComputer_

Một báo cáo từ nhà cung cấp dịch vụ quản lý an ninh Huntress ghi nhận rằng các biến thể ClickFix mới thả các stealer thông tin LummaC2 và Rhadamanthys.

Trong một biến thể, những kẻ tấn công sử dụng một trang xác minh con người, trong khi ở biến thể khác họ dựa vào màn hình Windows Update giả.

Ở cả hai trường hợp, những tác nhân đe dọa đều sử dụng steganography để mã hóa gói payload cuối cùng bên trong một hình ảnh.

"Thay vì đơn giản đính kèm dữ liệu độc hại vào một tệp, mã độc được mã hóa trực tiếp trong dữ liệu điểm ảnh của các ảnh PNG, dựa vào các kênh màu cụ thể để tái tạo và giải mã payload trong bộ nhớ," các nhà nghiên cứu Huntress [giải thích](https://www.huntress.com/blog/clickfix-malware-buried-in-images).

Việc phân phối payload cuối cùng bắt đầu bằng cách sử dụng binary gốc Windows _mshta_ để thực thi mã JavaScript độc hại.

Toàn bộ quá trình bao gồm nhiều giai đoạn sử dụng mã PowerShell và một assembly .NET (Stego Loader) chịu trách nhiệm tái tạo payload cuối cùng được nhúng bên trong một tệp PNG ở trạng thái được mã hóa.

Bên trong manifest resources của Stego Loader, có một khối dữ liệu được mã hóa AES thực chất là một tệp PNG steganographic chứa shellcode, được tái tạo bằng mã C# tùy chỉnh.

Các nhà nghiên cứu Huntress nhận thấy rằng tác nhân đe dọa đã sử dụng một chiến thuật né tránh động, thường được gọi là ctrampoline, nơi hàm điểm vào bắt đầu gọi 10.000 hàm rỗng.

**Chuỗi gọi Trampoline**  
_Source: Huntress_

Shellcode chứa các mẫu infostealer được trích xuất từ hình ảnh đã mã hóa và được đóng gói bằng công cụ Donut cho phép thực thi VBScript, JScript, EXE, DLL files, và .NET assemblies trong bộ nhớ.

Sau khi giải nén, các nhà nghiên cứu Huntress có thể thu hồi phần mềm độc hại, trong các cuộc tấn công được phân tích là LummaC2 và Rhadamanthys.

Sơ đồ dưới đây đóng vai trò như một biểu diễn trực quan về cách toàn bộ cuộc tấn công hoạt động:

**Tổng quan về cuộc tấn công**  
_Source: Huntress_

Biến thể Rhadamanthys sử dụng mồi nhử Windows Update đã được các nhà nghiên cứu phát hiện lần đầu vào tháng Mười [first spotted](https://x.com/Reid0nly/status/1980416054204723413), trước khi Operation Endgame đóng một phần cơ sở hạ tầng của nó [vào ngày 13 tháng Mười Một](https://www.bleepingcomputer.com/news/security/police-disrupts-rhadamanthys-venomrat-and-elysium-malware-operations/).

Huntress báo cáo rằng hoạt động thực thi pháp luật đã dẫn đến payload không còn được phân phối nữa trên các domain Windows Update giả, vốn vẫn còn hoạt động.

Để giữ an toàn trước loại cuộc tấn công ClickFix này, các nhà nghiên cứu khuyên nên vô hiệu hóa hộp Run của Windows và giám sát các chuỗi tiến trình đáng ngờ như _explorer.exe_ khởi tạo _mshta.exe_ hoặc PowerShell.

Ngoài ra, khi điều tra một sự cố an ninh mạng, các nhà phân tích có thể kiểm tra khóa RunMRU trong registry để xem người dùng có nhập lệnh trong hộp Run của Windows hay không.