# Ransomware IAB lạm dụng EDR để thực thi phần mềm độc hại một cách lén lút

![Ransomware IAB lạm dụng EDR để thực thi phần mềm độc hại một cách lén lút](https://www.bleepstatic.com/content/hl-images/2024/12/10/hacker-box.jpg)

Một nhà môi giới truy cập ban đầu được theo dõi với tên Storm-0249 đang lạm dụng các giải pháp endpoint detection and response (EDR) và các tiện ích Microsoft Windows đáng tin cậy để tải phần mềm độc hại, thiết lập liên lạc và duy trì tồn tại nhằm chuẩn bị cho các cuộc tấn công ransomware.

Nhóm mối đe dọa đã chuyển từ việc gửi thư rác hàng loạt sang các phương pháp lén lút hơn, tinh vi hơn, chứng tỏ hiệu quả và khó bị phát hiện đối với các đội phòng thủ, ngay cả khi các phương pháp này đã được tài liệu hóa.

Trong một cuộc tấn công được các nhà nghiên cứu tại công ty an ninh mạng ReliaQuest phân tích, Storm-0249 đã lợi dụng các thành phần của SentinelOne EDR để che giấu hoạt động độc hại. Tuy nhiên, các nhà nghiên cứu cho biết cùng phương pháp này cũng hoạt động với các sản phẩm EDR khác.

## Lạm dụng SentinelOne EDR

ReliaQuest cho biết cuộc tấn công của Storm-0249 bắt đầu bằng ClickFix social engineering lừa người dùng dán và thực thi các lệnh curl trong hộp thoại Windows Run để tải về một gói MSI độc hại với quyền SYSTEM.

Một tập lệnh PowerShell độc hại cũng được lấy từ một miền Microsoft bị giả mạo, được pipe trực tiếp vào bộ nhớ hệ thống, không bao giờ chạm vào đĩa và do đó tránh được phát hiện của phần mềm chống virus.

Tập tin MSI thả một DLL độc hại (SentinelAgentCore.dll). Theo các nhà nghiên cứu, "DLL này được đặt chiến lược cạnh file SentinelAgentWorker.exe hợp lệ đã tồn tại, vốn đã được cài đặt như một phần của SentinelOne EDR trên máy nạn nhân."

Tiếp theo, kẻ tấn công nạp DLL bằng cách sử dụng SentinelAgentWorker đã được ký (DLL sideloading), thực thi file trong quy trình EDR được tin cậy và có quyền đặc quyền, từ đó đạt được khả năng duy trì lén lút có thể tồn tại qua các bản cập nhật hệ điều hành.

"Quá trình hợp pháp làm mọi việc, chạy mã của kẻ tấn công, xuất hiện như hoạt động thường lệ của SentinelOne đối với công cụ bảo mật và vượt qua phát hiện," [giải thích bởi ReliaQuest](https://reliaquest.com/blog/threat-spotlight-storm-0249-precision-endpoint-exploitation/).

![Signed executable side-loading the malicious DLL](https://www.bleepstatic.com/images/news/u/1220909/2025/December/dllsideloading.jpg)

**Thực thi đã ký side-load DLL độc hại**  
_Nguồn: ReliaQuest_

Khi kẻ tấn công có được quyền truy cập, họ sử dụng thành phần SentinelOne để thu thập các định danh hệ thống thông qua các tiện ích Windows hợp lệ như reg.exe và findstr.exe, và để chuyển hướng lưu lượng điều khiển và chỉ huy (C2) HTTPS được mã hóa.

Các truy vấn registry và tìm kiếm chuỗi thông thường sẽ làm dấy lên cảnh báo, nhưng khi được thực hiện từ bên trong một quy trình EDR được tin cậy, chúng được coi là hoạt động thường lệ và bị cơ chế bảo mật bỏ qua.

ReliaQuest giải thích rằng các hệ thống bị xâm nhập được lập hồ sơ bằng 'MachineGuid,' một định danh dựa trên phần cứng duy nhất mà các nhóm ransomware như LockBit và ALPHV sử dụng để ràng buộc khóa mã hóa với các nạn nhân cụ thể.

Điều này cho thấy Storm-0249 tiến hành các xâm nhập truy cập ban đầu được tùy chỉnh phù hợp với nhu cầu của khách hàng điển hình của họ, tức là các cộng tác viên ransomware.

Việc lạm dụng các quy trình EDR có chữ ký và được tin cậy làm lướt qua hầu hết các cơ chế giám sát truyền thống. Các nhà nghiên cứu khuyến nghị quản trị viên hệ thống dựa vào phát hiện dựa trên hành vi để nhận diện các quy trình được tin cậy đang nạp các DLL chưa được ký từ các đường dẫn không chuẩn.

Hơn nữa, việc thiết lập kiểm soát nghiêm ngặt hơn đối với việc thực thi curl, PowerShell và LoLBin là hữu ích.