# Tin tặc North Korean lợi dụng lỗ hổng React2Shell trong các cuộc tấn công phần mềm độc hại EtherRAT

![North Korea](https://www.bleepstatic.com/content/hl-images/2023/11/10/North_Korean_hackers_headpic.jpg)

Một implant phần mềm độc hại mới có tên EtherRAT, được triển khai trong một cuộc tấn công React2Shell gần đây, chạy năm cơ chế duy trì truy cập (persistence) riêng biệt trên Linux và tận dụng hợp đồng thông minh Ethereum để liên lạc với kẻ tấn công.

Các nhà nghiên cứu tại công ty bảo mật đám mây Sysdig cho rằng phần mềm độc hại này phù hợp với bộ công cụ mà Bắc Triều Tiên sử dụng trong các chiến dịch Contagious Interview.

Họ đã phục hồi EtherRAT từ một ứng dụng Next.js bị xâm nhập chỉ hai ngày sau khi công bố lỗ hổng [lỗ hổng React2Shell nghiêm trọng](https://www.bleepingcomputer.com/news/security/critical-react2shell-flaw-in-react-nextjs-lets-hackers-run-javascript-code/) được theo dõi là CVE-2025-55182.

Sysdig nhấn mạnh sự kết hợp các tính năng tinh vi của EtherRAT, bao gồm truyền thông command-and-control (C2) dựa trên blockchain, duy trì truy cập nhiều lớp trên Linux, ghi đè payload khi đang chạy, và né tránh bằng cách sử dụng runtime Node.js đầy đủ.

Mặc dù có nhiều điểm trùng lặp đáng kể với các hoạt động "Contagious Interview" do Lazarus thực hiện, EtherRAT khác biệt ở một số khía cạnh then chốt.

React2Shell là một lỗ hổng phân tích/ghi nhận đối tượng (deserialization) có mức độ nghiêm trọng tối đa trong giao thức "Flight" của React Server Components (RSC) cho phép thực thi mã từ xa không xác thực thông qua một yêu cầu HTTP được chế tạo.

Lỗ hổng ảnh hưởng đến một lượng lớn môi trường đám mây chạy React/Next.js, và việc khai thác thực tế bắt đầu vài giờ sau khi công khai vào cuối tuần trước. Một số tác nhân đe dọa đầu tiên lợi dụng nó trong các cuộc tấn công là các nhóm liên quan đến Trung Quốc [Earth Lamia and Jackpot Panda](https://www.bleepingcomputer.com/news/security/react2shell-critical-flaw-actively-exploited-in-china-linked-attacks/).

Việc khai thác tự động theo sau, và [ít nhất 30 tổ chức](https://www.bleepingcomputer.com/news/security/react2shell-flaw-exploited-to-breach-30-orgs-77k-ip-addresses-vulnerable/) trên nhiều ngành đã bị xâm phạm để đánh cắp thông tin xác thực, đào tiền mã hóa, và triển khai backdoor thông dụng.

## Chuỗi tấn công EtherRAT

EtherRAT sử dụng chuỗi tấn công nhiều giai đoạn, bắt đầu với việc khai thác React2Shell để thực thi một lệnh shell mã hóa base64 trên mục tiêu, theo Sysdig.

Lệnh cố gắng tải xuống một shell script độc hại (_s.sh_) bằng _curl_, với _wget_ hoặc _python3_ làm phương án dự phòng, và lặp lại mỗi 300 giây cho đến khi thành công. Khi script được tải về, nó được kiểm tra, chuyển thành tệp thực thi, và khởi chạy.

![Script logic](https://www.bleepstatic.com/images/news/u/1220909/2025/December/logic.jpg)

**Luồng lệnh script**  
_Nguồn: Sysdig_

Script tạo một thư mục ẩn trong vị trí _$HOME/.local/share_ của người dùng, nơi nó tải xuống và giải nén một runtime Node.js hợp pháp v20.10.0 trực tiếp từ nodejs.org.

Nó sau đó ghi một blob payload được mã hóa và một JavaScript dropper bị làm mờ (obfuscated) mà được thực thi bằng binary Node đã được tải xuống, và rồi tự xóa.

JavaScript dropper bị làm mờ (_.kxnzl4mtez.js_) đọc blob đã mã hóa, giải mã nó bằng một khóa AES-256-CBC được mã cứng (hardcoded), và ghi kết quả thành một tệp JavaScript ẩn khác.

Payload sau khi giải mã là implant EtherRAT. Nó được triển khai bằng binary Node.js đã được cài đặt trong giai đoạn trước đó.

## Dấu hiệu của một implant tiên tiến

EtherRAT sử dụng hợp đồng thông minh Ethereum cho các hoạt động C2, điều này cung cấp tính linh hoạt trong vận hành và khả năng chống bị gỡ bỏ.

Nó truy vấn chín nhà cung cấp Ethereum RPC công cộng song song và chọn kết quả trả về theo đa số, điều này ngăn chặn việc đầu độc hoặc sinkholing từ một nút đơn lẻ.

Phần mềm độc hại gửi các URL giống CDN được ngẫu nhiên hóa tới C2 mỗi 500 ms và thực thi JavaScript trả về từ các điều hành viên bằng cách sử dụng AsyncFunction constructor trong một cơ chế hoạt động như một shell Node.js tương tác đầy đủ.

![Constructing randomized URLs](https://www.bleepstatic.com/images/news/u/1220909/2025/December/constrranurl.jpg)

**Xây dựng các URL được ngẫu nhiên hóa**  
_Nguồn: Sysdig_

Tin tặc North Korean đã sử dụng hợp đồng thông minh trước đây để phân phối và phát tán phần mềm độc hại. Kỹ thuật này được gọi là EtherHiding và đã được mô tả trước đây trong các báo cáo từ [Google](https://www.bleepingcomputer.com/news/security/north-korean-hackers-use-etherhiding-to-hide-malware-on-the-blockchain/) và [GuardioLabs](https://www.bleepingcomputer.com/news/security/hackers-use-binance-smart-chain-contracts-to-store-malicious-scripts/).

Ngoài ra, các nhà nghiên cứu của Sysdig lưu ý rằng "mẫu loader được mã hóa sử dụng trong EtherRAT phù hợp chặt chẽ với phần mềm độc hại liên quan đến DPRK [BeaverTail] được sử dụng trong các chiến dịch Contagious Interview."

### EtherRAT duy trì truy cập trên Linux

Sysdig nhận xét rằng phần mềm độc hại EtherRAT có mức độ duy trì truy cập trên hệ thống Linux cực kỳ quyết liệt, vì nó cài đặt năm lớp để dự phòng:

* Cron jobs
* bashrc injection
* XDG autostart
* Systemd user service
* Profile injection

Bằng cách sử dụng nhiều phương pháp duy trì, kẻ điều khiển phần mềm độc hại đảm bảo rằng họ tiếp tục có quyền truy cập vào các máy chủ bị xâm nhập ngay cả sau khi khởi động lại hệ thống và bảo trì.

Một tính năng độc đáo khác trong EtherRAT là khả năng tự cập nhật bằng cách gửi mã nguồn của nó tới một endpoint API. Phần mềm độc hại nhận mã thay thế có cùng khả năng nhưng sử dụng obfuscation khác, ghi đè chính nó bằng mã đó, và sau đó sinh ra một tiến trình mới với payload đã được cập nhật.

Sysdig giả thuyết rằng cơ chế này giúp phần mềm tránh phát hiện tĩnh và cũng có thể giúp ngăn phân tích hoặc giới thiệu chức năng theo nhiệm vụ cụ thể.

Khi việc khai thác React2Shell đang diễn ra bởi nhiều tác nhân, quản trị viên hệ thống được khuyến nghị nâng cấp lên phiên bản React/Next.js an toàn càng sớm càng tốt.

Sysdig cung cấp trong báo cáo của họ một danh sách ngắn các chỉ số xâm phạm (IoCs) liên quan đến cơ sở hạ tầng giai đoạn của EtherRAT và các hợp đồng Ethereum.

Các nhà nghiên cứu khuyến nghị người dùng kiểm tra các cơ chế duy trì được liệt kê, giám sát lưu lượng Ethereum RPC, xem xét nhật ký ứng dụng, và thay đổi thông tin xác thực.