# Lỗ hổng MongoBleed bị khai thác làm rò rỉ bí mật MongoDB, 87K máy chủ bị phơi bày

![Exploited MongoBleed flaw leaks MongoDB secrets, 87K servers exposed](https://www.bleepstatic.com/content/hl-images/2025/12/27/mongobleed.jpg)

Một lỗ hổng nghiêm trọng ảnh hưởng đến nhiều phiên bản MongoDB, có tên MongoBleed (CVE-2025-14847), đang bị khai thác tích cực ngoài thực địa, với hơn 80.000 máy chủ có khả năng bị ảnh hưởng được phơi bày trên web công cộng.

Một exploit công khai cùng các chi tiết kỹ thuật đi kèm đã được công bố, cho thấy cách kẻ tấn công có thể kích hoạt lỗ hổng để từ xa trích xuất bí mật, thông tin xác thực và các dữ liệu nhạy cảm khác từ một máy chủ MongoDB bị phơi bày.

Lỗ hổng được chấm điểm mức nghiêm trọng 8.7 và đã được xử lý như một “sửa lỗi quan trọng”, với bản vá dành cho các trường hợp tự lưu trữ có sẵn từ ngày 19 tháng 12.

[![Wiz](https://www.bleepstatic.com/c/a/as-Free-Phishing-970x250.jpg)](https://www.adaptivesecurity.com/lp/nb/free-phishing-test?utm%5Fsource=display%5Fnetwork&utm%5Fmedium=paid%5Fdisplay&utm%5Fcampaign=2025%5F12%5FLinkedin%5FSocial%5FNA%5FBrand%5FAwareness%5FTeachers%5Ffunding&utm%5Fid=701Rd00000ZoWjjIAF%2F&utm%5Fcontent=970%5F250) 

### Exploit làm rò rỉ bí mật

Lỗ hổng MongoBleed xuất phát từ cách MongoDB Server xử lý các gói mạng được xử lý bởi thư viện zlib dùng cho nén dữ liệu không mất mát.

Các nhà nghiên cứu tại Ox Security [giải thích](https://www.ox.security/blog/attackers-could-exploit-zlib-to-exfiltrate-data-cve-2025-14847/#technical%5Fanalysis) rằng vấn đề gây ra do MongoDB trả về lượng bộ nhớ được cấp phát khi xử lý thông điệp mạng thay vì độ dài của dữ liệu đã giải nén.

Một tác nhân đe dọa có thể gửi một thông điệp bị làm sai sót tuyên bố kích thước lớn hơn khi giải nén, khiến máy chủ cấp phát một bộ đệm bộ nhớ lớn hơn và làm rò rỉ dữ liệu trong bộ nhớ đến client chứa thông tin nhạy cảm.

Loại bí mật bị rò rỉ theo cách này có thể dao động từ thông tin xác thực, khóa API và/hoặc khóa cloud, token phiên, thông tin cá nhân nhận dạng (PII), nhật ký nội bộ, cấu hình, đường dẫn và dữ liệu liên quan đến client.

Bởi vì việc giải nén các thông điệp mạng xảy ra trước giai đoạn xác thực, kẻ tấn công khai thác MongoBleed không cần có thông tin xác thực hợp lệ.

Exploit công khai, được phát hành như một proof-of-concept (PoC) mang tên "MongoBleed" bởi nhà nghiên cứu bảo mật Elastic Joe Desimone, được tạo ra nhằm mục đích rò rỉ dữ liệu nhạy cảm trong bộ nhớ.

Nhà nghiên cứu bảo mật Kevin Beaumont [nói](https://doublepulsar.com/merry-christmas-day-have-a-mongodb-security-incident-9537f54289eb) rằng mã PoC exploit là hợp lệ và rằng nó chỉ cần “một địa chỉ IP của một instance MongoDB để bắt đầu lục lọi trong bộ nhớ những thứ như mật khẩu cơ sở dữ liệu (lưu ở dạng văn bản thuần), khóa bí mật AWS, v.v.”

![MongoBleed (CVE-2025-14847) exploit leaks secrets](https://www.bleepstatic.com/images/news/u/1100723/MongoBleed_exploit_KB.jpg)

**MongoBleed exploit rò rỉ bí mật**  
_source: Kevin Beaumont_

Theo nền tảng Censys để phát hiện thiết bị kết nối internet, tính đến ngày 27 tháng 12, có hơn [87.000 instance MongoDB có khả năng bị tổn thương](https://censys.com/advisory/cve-2025-14847) được phơi bày trên internet công cộng.

Gần 20.000 server MongoDB được quan sát ở Hoa Kỳ, tiếp theo là Trung Quốc với gần 17.000, và Đức với hơi dưới 8.000.

**Các instance MongoDB bị phơi bày trên internet công cộng**  
_source: Censys_

### Khai thác và phát hiện

Tác động trên môi trường cloud cũng có vẻ đáng kể, khi dữ liệu telemetry từ nền tảng bảo mật đám mây Wiz cho thấy 42% các hệ thống có thể nhìn thấy “ít nhất một instance MongoDB ở phiên bản dễ bị tổn thương với CVE-2025-14847.”

Các nhà nghiên cứu Wiz ghi nhận rằng các instance họ quan sát bao gồm cả tài nguyên nội bộ và những instance bị phơi bày công khai. Công ty [nói](https://www.wiz.io/blog/mongobleed-cve-2025-14847-exploited-in-the-wild-mongodb) rằng họ đã quan sát việc khai thác MongoBleed (CVE-2025-14847) ngoài thực địa, và khuyến nghị các tổ chức ưu tiên vá lỗi.

Mặc dù chưa được xác minh, một số tác nhân đe dọa tuyên bố đã sử dụng lỗ hổng MongoBleed trong một vụ xâm phạm gần đây của nền tảng trực tuyến Ubisoft's Rainbow Six Siege.

Đồng sáng lập Recon InfoSec Eric Capuano cảnh báo rằng việc vá lỗi chỉ là một phần của phản ứng với vấn đề MongoBleed và khuyên các tổ chức nên kiểm tra dấu hiệu bị xâm phạm.

Trong một bài đăng trên blog hôm qua, nhà nghiên cứu [giải thích](https://blog.ecapuano.com/p/hunting-mongobleed-cve-2025-14847) một phương pháp phát hiện bao gồm việc tìm “một địa chỉ IP nguồn có hàng trăm hoặc hàng nghìn kết nối nhưng không có sự kiện metadata nào.”

Tuy nhiên, Capuano cảnh báo rằng phương pháp phát hiện dựa trên mã proof-of-concept exploit hiện có và một kẻ tấn công có thể sửa đổi nó để bao gồm metadata client giả mạo hoặc giảm tốc độ khai thác.

Florian Roth - người tạo ra THOR APT Scanner và hàng nghìn quy tắc YARA - đã tận dụng nghiên cứu của Capuano để tạo ra MongoBleed Detector \- một công cụ phân tích log MongoDB và xác định khả năng khai thác lỗ hổng CVE-2025-14847.

### Công cụ nén không mất mát an toàn

MongoDB đã xử lý lỗ hổng MongoBleed cách đây mười ngày, với khuyến nghị mạnh mẽ cho quản trị viên nâng cấp lên phiên bản an toàn (8.2.3, 8.0.17, 7.0.28, 6.0.27, 5.0.32, hoặc 4.4.30).

Nhà cung cấp cảnh báo rằng một danh sách lớn các phiên bản MongoDB bị ảnh hưởng bởi MongoBleed (CVE-2025-14847), một số phiên bản cũ được phát hành từ cuối 2017, và một số phiên bản mới gần đây đến tháng 11 năm 2025:

* MongoDB 8.2.0 thông qua 8.2.3
* MongoDB 8.0.0 thông qua 8.0.16
* MongoDB 7.0.0 thông qua 7.0.26
* MongoDB 6.0.0 thông qua 6.0.26
* MongoDB 5.0.0 thông qua 5.0.31
* MongoDB 4.4.0 thông qua 4.4.29
* Tất cả các phiên bản MongoDB Server v4.2
* Tất cả các phiên bản MongoDB Server v4.0
* Tất cả các phiên bản MongoDB Server v3.6

Khách hàng của MongoDB Atlas, dịch vụ cơ sở dữ liệu đa đám mây được quản lý toàn phần, [đã nhận bản vá tự động](https://www.mongodb.com/community/forums/t/important-mongodb-patch-available/332977) và không cần thực hiện hành động nào.

MongoDB cho biết không có giải pháp tạm thời cho lỗ hổng. Nếu không thể nâng cấp lên phiên bản mới, nhà cung cấp khuyến nghị khách hàng tắt nén zlib trên server và cung cấp hướng dẫn cách làm điều đó.

Các lựa chọn thay thế an toàn cho nén dữ liệu không mất mát bao gồm Zstandard (zstd) và Snappy (trước đây là Zippy), được duy trì bởi Meta và Google, tương ứng.