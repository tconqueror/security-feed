# Torrent giả 'One Battle After Another' giấu phần mềm độc hại trong phụ đề

![Rạp chiếu phim](https://www.bleepstatic.com/content/hl-images/2025/12/12/cinema.jpg)

Một torrent giả cho Leonardo DiCaprio’s 'One Battle After Another' giấu các loader phần mềm độc hại PowerShell bên trong các tệp phụ đề, cuối cùng làm nhiễm thiết bị bằng phần mềm RAT Agent Tesla.

Tệp torrent độc hại này được phát hiện bởi các nhà nghiên cứu Bitdefender trong khi điều tra một đợt tăng phát hiện liên quan đến bộ phim.

One Battle After Another là một bộ phim được đánh giá cao của Paul Thomas Anderson phát hành vào ngày 26 tháng 9 năm 2025, với dàn diễn viên Leonardo DiCaprio, Sean Penn và Benicio del Toro.

Tội phạm mạng lợi dụng sự quan tâm xung quanh các bộ phim mới bằng cách tải lên các torrent độc hại không phải chuyện mới, nhưng Bitdefender lưu ý trường hợp này nổi bật vì chuỗi nhiễm phức tạp và kín đáo bất thường.

"Theo Bitdefender"([http://www.bitdefender.com/en-us/blog/labs/fake-leonardo-dicaprio-movie-torrent-agent-tesla-powershell](http://www.bitdefender.com/en-us/blog/labs/fake-leonardo-dicaprio-movie-torrent-agent-tesla-powershell)).

## Khởi chạy phần mềm độc hại từ phụ đề

Tệp torrent One Battle After Another được tải xuống dùng trong các cuộc tấn công chứa nhiều tệp, bao gồm một tệp phim (One Battle After Another.m2ts), hai tệp hình ảnh (Photo.jpg, Cover.jpg), một tệp phụ đề (Part2.subtitles.srt) và một tệp shortcut (CD.lnk) trông giống như một trình khởi chạy phim.

Khi shortcut CD được chạy, nó khởi chạy các lệnh Windows để giải nén và chạy một script PowerShell độc hại được nhúng trong tệp phụ đề giữa các dòng 100 và 103.

![Malicious PowerShell script hidden in subtitles](https://www.bleepstatic.com/images/news/malware/s/subtitles-malware/powershell-hidden-in-subtitles.jpg)

**Script PowerShell độc hại ẩn trong phụ đề**

Script PowerShell này sau đó sẽ trích xuất nhiều khối dữ liệu được mã hóa AES từ tệp phụ đề một lần nữa để tái tạo năm script PowerShell được thả vào 'C:\\Users\\<USER>\\AppData\\Local\\Microsoft\\Diagnostics.'

![Other encrypted PowerShell commands in the subtitles](https://www.bleepstatic.com/images/news/malware/s/subtitles-malware/subtitles-encrypted-data.jpg)

**Các lệnh PowerShell được mã hóa khác trong phụ đề**  
Nguồn: BleepingComputer

Các script PowerShell được giải nén hoạt động như một dropper phần mềm độc hại, thực hiện các hành động sau trên máy chủ:

* **Stage 1** – Giải nén tệp One Battle After Another.m2ts như một kho lưu trữ bằng bất kỳ trình giải nén nào có sẵn.
* **Stage 2** – Tạo một tác vụ được lập lịch ẩn (RealtekDiagnostics) chạy RealtekCodec.bat
* **Stage 3** – Giải mã dữ liệu nhị phân được nhúng từ Photo.jpg và ghi các tệp khôi phục vào thư mục Windows Sound Diagnostics Cache.
* **Stage 4** – Đảm bảo %LOCALAPPDATA%\\Packages\\Microsoft.WindowsSoundDiagnostics\\Cache tồn tại.
* **Stage 5** – Giải nén nội dung Cover.jpg vào thư mục Cache, bao gồm các tệp batch và script PowerShell.

Các tệp được giải nén ở giai đoạn cuối được dùng để kiểm tra xem Windows Defender có đang hoạt động hay không, cài Go, giải nén payload cuối cùng (AgentTesla) và tải nó trực tiếp vào bộ nhớ.

AgentTesla là một RAT và công cụ đánh cắp thông tin tồn tại từ lâu (từ 2014), thường được sử dụng để đánh cắp thông tin đăng nhập trình duyệt, email, FTP và VPN, cũng như chụp ảnh màn hình.

Mặc dù Agent Tesla không mới, nó vẫn được sử dụng rộng rãi do độ tin cậy và dễ triển khai.

Bitdefender cũng lưu ý rằng trong các tựa phim khác, ví dụ 'Mission: Impossible – The Final Reckoning,' họ đã quan sát các họ mã độc khác được sử dụng, chẳng hạn như Lumma Stealer.

Các tệp torrent từ nhà xuất bản ẩn danh thường chứa phần mềm độc hại, vì vậy khuyến nghị người dùng tránh việc tải lậu phim mới hoàn toàn để an toàn.