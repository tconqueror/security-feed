# Tin tặc lợi dụng zero-day chưa được vá trong Gogs để xâm nhập 700 máy chủ

![Gogs](https://www.bleepstatic.com/content/hl-images/2025/12/11/Gogs.jpg)

Một lỗ hổng zero-day chưa được vá trong Gogs, một dịch vụ Git tự lưu trữ phổ biến, đã cho phép các kẻ tấn công thực hiện thực thi mã từ xa trên các instance hướng ra Internet và xâm phạm hàng trăm máy chủ.

Viết bằng Go và được thiết kế như một lựa chọn thay thế cho GitLab hoặc GitHub Enterprise, Gogs cũng thường xuyên được phơi bày trực tuyến để hợp tác từ xa.

[CVE-2025-8110](https://nvd.nist.gov/vuln/detail/CVE-2025-8110), lỗ hổng RCE của Gogs bị khai thác trong các vụ tấn công này, phát sinh từ một lỗ hổng path traversal trong PutContents API. Lỗi cho phép các tác nhân đe dọa vượt qua các biện pháp bảo vệ đã được triển khai cho một lỗi thực thi mã từ xa đã được vá trước đó (CVE-2024-55947) bằng cách sử dụng symbolic links để ghi đè các tệp bên ngoài kho lưu trữ.

Mặc dù các phiên bản Gogs đã xử lý CVE-2024-55947 hiện nay xác thực tên đường dẫn để ngăn directory traversal, chúng vẫn không xác thực đích của các liên kết tượng trưng. Kẻ tấn công có thể lợi dụng điều này bằng cách tạo các kho lưu trữ chứa symbolic links trỏ tới các tệp hệ thống nhạy cảm, và sau đó sử dụng PutContents API để ghi dữ liệu qua symlink, ghi đè các mục tiêu bên ngoài kho lưu trữ.

Bằng cách ghi đè các tệp cấu hình Git, cụ thể là thiết lập sshCommand, kẻ tấn công có thể ép hệ thống mục tiêu thực thi các lệnh tùy ý.

Wiz Research phát hiện lỗ hổng này vào tháng 7 khi điều tra một cuộc nhiễm mã độc ảnh hưởng tới một server Gogs hướng ra Internet của khách hàng. Tổng cộng, các nhà nghiên cứu tìm thấy [hơn 1.400 máy chủ Gogs bị phơi bày trực tuyến](https://www.shodan.io/search?query=http.title%3A%22Sign+In+-+Gogs%22), với hơn 700 instance cho thấy dấu hiệu bị xâm phạm.

![Máy chủ Gogs bị phơi bày trực tuyến](https://www.bleepstatic.com/images/news/u/1109292/2025/Exposed-Gogs-servers.jpg)

_Máy chủ Gogs bị phơi bày trực tuyến (Shodan)_

Tất cả các instance bị xâm phạm được xác định trong quá trình điều tra các cuộc tấn công này đều cho thấy các mẫu giống hệt nhau, bao gồm các kho lưu trữ có tên ngẫu nhiên tám ký tự được tạo trong cùng khung thời gian vào tháng 7, gợi ý một tác nhân hoặc nhóm duy nhất sử dụng công cụ tự động đứng sau chiến dịch.

"Trong quét bên ngoài của chúng tôi, chúng tôi xác định hơn 1.400 máy chủ Gogs được phơi bày công khai ra Internet. Nhiều instance này được cấu hình với 'Open Registration' được bật theo mặc định, tạo ra một bề mặt tấn công khổng lồ," [họ nói](https://www.wiz.io/blog/wiz-research-gogs-cve-2025-8110-rce-exploit).

Wiz cũng phát hiện rằng mã độc được triển khai được tạo bằng Supershell, một framework command-and-control (C2) mã nguồn mở thiết lập các reverse SSH shell qua dịch vụ web. Phân tích thêm cho thấy mã độc đã giao tiếp với một máy chủ command-and-control tại 119.45.176[.\]196.

Các nhà nghiên cứu đã báo cáo lỗ hổng cho những người duy trì Gogs vào ngày 17 tháng 7, và những người duy trì đã thừa nhận lỗi vào ngày 30 tháng 10, khi họ vẫn đang phát triển bản vá. Theo một dòng thời gian tiết lộ được chia sẻ bởi Wiz Research, làn sóng tấn công thứ hai được quan sát vào ngày 1 tháng 11.

Người dùng Gogs được khuyên ngay lập tức vô hiệu hóa cài đặt đăng ký mở (open registration) theo mặc định và giới hạn truy cập vào server bằng cách sử dụng VPN hoặc danh sách cho phép. Những ai muốn kiểm tra xem instance của mình đã bị xâm phạm hay chưa nên tìm kiếm việc sử dụng PutContents API đáng ngờ và các kho lưu trữ có tên ngẫu nhiên 8 ký tự.