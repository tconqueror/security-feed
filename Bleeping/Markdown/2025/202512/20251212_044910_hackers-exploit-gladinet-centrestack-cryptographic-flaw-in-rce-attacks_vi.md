# Tin tặc lợi dụng lỗ hổng mật mã trong Gladinet CentreStack để thực hiện RCE

![Tin tặc lợi dụng lỗ hổng mật mã trong Gladinet CentreStack để thực hiện RCE](https://www.bleepstatic.com/content/hl-images/2024/04/16/3.jpg)

Tin tặc đang lợi dụng một lỗ hổng mới, chưa được tài liệu hóa trong việc triển khai thuật toán mật mã có trong các sản phẩm CentreStack và Triofox của Gladinet dùng để truy cập và chia sẻ tệp từ xa an toàn.

Bằng cách khai thác vấn đề bảo mật này, các kẻ tấn công có thể lấy được các khóa mật mã được mã hóa cứng (hardcoded) và đạt được thực thi mã từ xa, các nhà nghiên cứu cảnh báo.

Mặc dù lỗ hổng mật mã mới này không có mã định danh chính thức, Gladinet đã thông báo cho khách hàng về nó và khuyến nghị họ cập nhật các sản phẩm lên phiên bản mới nhất, phiên bản mà tại thời điểm thông báo đã được phát hành vào ngày 29 tháng 11.

Công ty cũng cung cấp cho khách hàng một bộ chỉ số xâm phạm (IoCs), cho thấy vấn đề đang bị khai thác trong thực tế.

Các nhà nghiên cứu bảo mật tại nền tảng quản lý an ninh mạng Huntress biết ít nhất chín tổ chức đã bị nhắm tới trong các cuộc tấn công khai thác lỗ hổng mới cùng với một lỗ hổng cũ hơn được theo dõi là CVE-2025-30406 \- một lỗi local file inclusion cho phép kẻ tấn công cục bộ truy cập các tệp hệ thống mà không cần xác thực.

### Khóa mật mã được mã hóa cứng (hardcoded)

Sử dụng các IoC từ Gladinet, các nhà nghiên cứu tại Huntress đã xác định được vị trí của lỗ hổng và cách các tác nhân đe dọa đang tận dụng nó.

Huntress phát hiện rằng vấn đề xuất phát từ việc triển khai tùy chỉnh thuật toán mã hóa AES trong Gladinet CentreStack và Triofox, nơi khóa mã hóa và Initialization Vector (IV) được hardcoded bên trong tệp _GladCtrl64.dll_ và có thể dễ dàng lấy được.

Cụ thể, các giá trị khóa được dẫn xuất từ hai chuỗi tĩnh dài 100 byte bằng văn bản tiếng Trung và tiếng Nhật, vốn giống nhau trên tất cả các cài đặt sản phẩm.

Lỗ hổng nằm trong quá trình xử lý handler ‘_filesvr.dn_’, handler này giải mã tham số ‘_t_’ (Access Ticket) bằng các khóa tĩnh đó, [Huntress giải thích](https://www.huntress.com/blog/active-exploitation-gladinet-centrestack-triofox-insecure-cryptography-vulnerability).

Bất kỳ ai trích xuất những khóa đó đều có thể giải mã các Access Tickets chứa đường dẫn tệp, tên người dùng, mật khẩu và dấu thời gian, hoặc tự tạo Access Ticket để mạo danh người dùng và yêu cầu máy chủ trả về bất kỳ tệp nào trên đĩa.

“Bởi vì các khóa này không bao giờ thay đổi, chúng tôi có thể trích xuất chúng từ bộ nhớ một lần và dùng để giải mã bất kỳ ticket nào do máy chủ tạo ra hoặc tệ hơn, mã hóa ticket của riêng mình,” các nhà nghiên cứu cho biết.

Huntress quan sát thấy các Access Tickets bị giả mạo bằng cách sử dụng các khóa AES hardcoded và đặt dấu thời gian về năm 9999, nên ticket không bao giờ hết hạn.

Các kẻ tấn công tiếp theo yêu cầu tệp _web.config_ của máy chủ. Vì tệp này chứa _machineKey_, họ đã có thể sử dụng nó để khởi động thực thi mã từ xa thông qua một lỗ hổng deserilization ViewState.

![Hoạt động khai thác](https://www.bleepstatic.com/images/news/u/1220909/2025/December/exploitation.jpg)

**Hoạt động khai thác**  
_Nguồn: Huntress_

Ngoài một địa chỉ IP tấn công, 147.124.216[.]205, hiện chưa có liên kết cụ thể nào được xác định cho các cuộc tấn công đó.

Về mục tiêu, Huntress xác nhận chín tổ chức tính đến ngày 10 tháng 12, từ nhiều lĩnh vực khác nhau, bao gồm chăm sóc sức khỏe và công nghệ.

Người dùng Gladinet CentreStack và Triofox được khuyến nghị nâng cấp lên phiên bản 16.12.10420.56791 (phát hành ngày 8 tháng 12) càng sớm càng tốt và đồng thời thay đổi các machine keys.

Ngoài ra, khuyến nghị quét nhật ký để tìm chuỗi ‘_vghpI7EToZUDIZDdprSubL3mTZ2_’, chuỗi này liên quan đến đường dẫn tệp được mã hóa và được coi là chỉ báo xâm phạm đáng tin cậy duy nhất.

Huntress cung cấp hướng dẫn giảm nhẹ trong báo cáo của họ, cùng với các chỉ số xâm phạm mà những người bảo vệ có thể sử dụng để bảo vệ môi trường hoặc xác định xem họ có bị xâm nhập hay không.