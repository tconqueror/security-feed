# Shai-Hulud 2.0 NPM cuộc tấn công phần mềm độc hại đã làm lộ tới 400.000 bí mật của nhà phát triển

![Cuộc tấn công phần mềm độc hại Shai-Hulud 2.0 trên NPM đã làm lộ tới 400.000 bí mật của nhà phát triển](https://www.bleepstatic.com/content/hl-images/2022/07/05/NPM_logo_headpic.jpg)

Cuộc tấn công Shai-Hulud thứ hai vào tuần trước đã làm lộ khoảng 400.000 bí mật thô sau khi nhiễm hàng trăm gói trong kho lưu trữ NPM (Node Package Manager) và công bố dữ liệu bị đánh cắp trong 30.000 kho lưu trữ GitHub.

Mặc dù chỉ khoảng 10.000 trong số các bí mật bị lộ được xác minh là hợp lệ bởi công cụ quét mã nguồn mở TruffleHog, các nhà nghiên cứu tại nền tảng bảo mật đám mây Wiz cho biết rằng hơn 60% token NPM bị rò rỉ vẫn còn hợp lệ tính đến ngày 1 tháng 12.

Mối đe dọa Shai-Hulud xuất hiện vào giữa tháng Chín, [compromising 187 NPM packages](https://www.bleepingcomputer.com/news/security/self-propagating-supply-chain-attack-hits-187-npm-packages/) với một payload tự lan truyền nhận diện token tài khoản bằng TruffleHog, chèn một script độc hại vào các gói và tự động xuất bản chúng trên nền tảng.

Trong cuộc tấn công thứ hai, phần mềm độc hại đã [ảnh hưởng hơn 800 gói](https://www.bleepingcomputer.com/news/security/shai-hulud-malware-infects-500-npm-packages-leaks-secrets-on-github/) (tính cả tất cả các phiên bản bị nhiễm của một gói) và bao gồm một cơ chế hủy hoại xóa thư mục home của nạn nhân nếu một số điều kiện nhất định được thỏa mãn.

![Tốc độ tạo tài khoản GitHub mới đăng bí mật lên kho lưu trữ mới](https://www.bleepstatic.com/images/news/u/1220909/2025/December/spread.jpg)

**Tốc độ tạo tài khoản GitHub mới đăng bí mật lên kho lưu trữ mới**  
_Nguồn: Wiz_

Các nhà nghiên cứu của Wiz phân tích rò rỉ bí mật mà Shai-Hulud 2.0 lan truyền qua 30.000 kho lưu trữ GitHub, nhận thấy rằng các loại bí mật sau đã bị lộ:

* khoảng 70% các kho chứa một file _contents.json_ với tên người dùng GitHub và token, cùng ảnh chụp file
* một nửa trong số đó có file _truffleSecrets.json_ chứa kết quả quét TruffleHog
* 80% các kho có file _environment.json_ với thông tin OS, metadata CI/CD, metadata gói npm, và thông tin đăng nhập GitHub
* 400 kho lưu trữ chứa _actionsSecrets.json_ với bí mật workflow của GitHub Actions

Wiz lưu ý rằng phần mềm độc hại đã sử dụng TruffleHog mà không bật cờ ‘_-only-verified_’, có nghĩa là 400.000 bí mật bị phơi bày khớp với một định dạng đã biết và có thể không còn hợp lệ hoặc không còn sử dụng được nữa.

“Trong khi dữ liệu bí mật rất ồn và đòi hỏi nỗ lực loại bỏ bản sao nặng, nó vẫn chứa hàng trăm bí mật hợp lệ, bao gồm cloud, token NPM, và thông tin xác thực VCS,” [giải thích Wiz](https://www.wiz.io/blog/shai-hulud-2-0-aftermath-ongoing-supply-chain-attack).

“Cho đến nay, những thông tin xác thực này tạo ra rủi ro hoạt động cho các cuộc tấn công chuỗi cung ứng tiếp theo. Ví dụ, chúng tôi quan sát thấy hơn 60% token NPM bị rò rỉ vẫn còn hợp lệ.”

Phân tích 24.000 file _environment.json_ cho thấy rằng khoảng một nửa trong số đó là duy nhất, với 23% tương ứng máy của các nhà phát triển, và phần còn lại đến từ các runner CI/CD và cơ sở hạ tầng tương tự.

Dữ liệu do các nhà nghiên cứu tổng hợp cho thấy hầu hết các máy bị nhiễm, 87% trong số đó, là hệ thống Linux, trong khi hầu hết các nhiễm (76%) xảy ra trên container.

Về phân bố nền tảng CI/CD, GitHub Actions dẫn đầu rõ rệt, theo sau là Jenkins, GitLab CI, và AWS CodeBuild.

![Các nền tảng CI/CD bị ảnh hưởng](https://www.bleepstatic.com/images/news/u/1220909/2025/December/ccd.jpg)

**Các nền tảng CI/CD bị ảnh hưởng**  
_Nguồn: Wiz_

Nhìn vào phân bố nhiễm, các nhà nghiên cứu của Wiz phát hiện gói hàng đầu là _@postman/tunnel-agent@0.6.7_, tiếp theo là _@asyncapi/specs@6.8.3_. Hai gói này cùng chiếm hơn 60% của tất cả các nhiễm.

**Mức độ phổ biến của các gói gây nhiễm**  
_Nguồn: Wiz_

Vì sự tập trung này, các nhà nghiên cứu cho rằng tác động của Shai-Hulud có thể đã được giảm đáng kể nếu một vài gói chủ chốt được xác định và vô hiệu hóa sớm.

Tương tự, liên quan đến mô hình nhiễm, 99% các trường hợp bắt nguồn từ sự kiện preinstall chạy node setup\_bun.js, và số ít ngoại lệ rất có thể là các thử nghiệm.

Wiz tin rằng những kẻ đứng sau Shai-Hulud sẽ tiếp tục tinh chỉnh và phát triển kỹ thuật của họ, và dự đoán sẽ có thêm các đợt tấn công mới trong tương lai gần, có thể tận dụng kho thông tin xác thực khổng lồ đã được thu thập cho tới nay.