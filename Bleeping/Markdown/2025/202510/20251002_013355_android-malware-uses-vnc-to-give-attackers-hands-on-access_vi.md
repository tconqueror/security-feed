# Phần mềm độc hại trên Android sử dụng VNC để cho phép kẻ tấn công truy cập trực tiếp

![Android malware uses VNC to give attackers hands-on access](https://www.bleepstatic.com/content/hl-images/2025/10/01/Cleopatra.jpg)

Một trojan ngân hàng và truy cập từ xa mới trên Android (RAT) có tên Klopatra, ngụy trang dưới dạng ứng dụng IPTV và VPN, đã lây nhiễm hơn 3.000 thiết bị trên khắp châu Âu.

Klopatra được mô tả là một trojan mạnh có thể giám sát màn hình theo thời gian thực, ghi lại đầu vào, mô phỏng điều hướng bằng cử chỉ, và có chế độ ẩn Virtual Network Computing (VNC).

Các nhà nghiên cứu tại công ty an ninh mạng Cleafy cho biết rằng trojan mới dường như không liên quan đến bất kỳ họ phần mềm độc hại Android đã được ghi nhận nào và có vẻ là dự án của một nhóm tội phạm mạng Turkish-speaking.

Klopatra được phát triển để đánh cắp thông tin đăng nhập ngân hàng thông qua các cuộc tấn công overlay, lấy cắp nội dung clipboard và các lần gõ phím, rút tiền qua VNC, và thu thập thông tin từ các ứng dụng ví cryptocurrency.

## Một mối đe dọa tinh vi và khó bị phát hiện

Phần mềm độc hại xâm nhập thiết bị nạn nhân thông qua một ứng dụng dropper có tên “Modpro IP TV + VPN,” được phân phối ngoài nền tảng chính thức Google Play cho Android.

![The Klopatra installation process](https://www.bleepstatic.com/images/news/u/1220909/2025/October/installation.jpg)

**Quy trình cài đặt Klopatra**  
_Nguồn: Cleafy Labs_

Klopatra tích hợp Virbox, một công cụ bảo vệ mã thương mại nhằm cản trở việc phân tích và reverse-engineering, sử dụng thư viện native để giảm dấu vết Java/Kotlin, và cũng sử dụng NP Manager để mã hóa chuỗi trong các bản dựng gần đây.

Cleafy [báo cáo](https://www.cleafy.com/cleafy-labs/klopatra-exposing-a-new-android-banking-trojan-operation-with-roots-in-turkey) rằng phần mềm độc hại có nhiều cơ chế chống gỡ lỗi, kiểm tra tính toàn vẹn thời gian chạy, và khả năng phát hiện trình giả lập, để đảm bảo nó không chạy trong môi trường phân tích.

Klopatra lạm dụng dịch vụ Accessibility của Android để cấp thêm quyền cho chính nó, ghi lại đầu vào của người dùng, mô phỏng các thao tác chạm và cử chỉ, và theo dõi màn hình nạn nhân để tìm mật khẩu và thông tin nhạy cảm khác.

![Prompt to give Accessibility permission](https://www.bleepstatic.com/images/news/u/1220909/2025/October/accessibility.jpg)

**Lời nhắc để cấp quyền Accessibility**  
_Nguồn: Cleafy Labs_

Một tính năng then chốt là chế độ VNC màn hình đen cho phép điều hành viên thực hiện các hành động trên thiết bị bị nhiễm trong khi thiết bị vẫn hiển thị trạng thái nhàn rỗi (màn hình khóa) đối với nạn nhân.

Chế độ này hỗ trợ tất cả các hành động từ xa cần thiết để thực hiện giao dịch ngân hàng thủ công, như mô phỏng chạm tại tọa độ màn hình xác định, vuốt lên/xuống, và nhấn giữ.

Phần mềm độc hại kiểm tra xem thiết bị có đang sạc hay màn hình có đang tắt hay không để xác định thời điểm lý tưởng để kích hoạt chế độ này mà người dùng không nhận ra.

**Các lệnh được gửi bởi các điều hành viên tới Klopatra**  
_Nguồn: Cleafy Labs_

Để tránh bị phát hiện, Klopatra cũng chứa một danh sách cứng mã hóa các package name tương ứng với các sản phẩm antivirus phổ biến trên Android, và cố gắng gỡ cài đặt chúng.

**Danh sách cứng mã hóa các sản phẩm AV mà phần mềm độc hại cố gắng vô hiệu hóa**  
_Nguồn: Cleafy Labs_

## Lộ diện các điều hành viên

Dựa trên các dấu vết ngôn ngữ và ghi chú về phát triển và kiếm tiền, các nhà nghiên cứu Cleafy tin rằng Klopatra được vận hành bởi một tác nhân đe dọa Turkish-speaking.

Các nhà nghiên cứu đã phơi bày nhiều điểm command and control (C2) dường như liên quan đến hai chiến dịch, với tổng cộng 3.000 trường hợp nhiễm duy nhất.

**Nhiễm Klopatra hàng ngày**  
_Nguồn: Cleafy Labs_

Mặc dù các điều hành viên sử dụng Cloudflare để che dấu dấu vết số, một cấu hình sai đã làm lộ địa chỉ IP nguồn, cho phép liên kết các server C2 với cùng nhà cung cấp.

Kể từ tháng 3 năm 2025, khi Klopatra lần đầu xuất hiện, đã có 40 bản dựng khác nhau, dấu hiệu cho thấy trojan Android mới được phát triển tích cực và tiến hóa nhanh.

Người dùng Android được khuyến nghị tránh tải các file APK từ các trang web mờ ám, từ chối các yêu cầu quyền Accessibility Service, và giữ Play Protect đang hoạt động trên thiết bị của họ.