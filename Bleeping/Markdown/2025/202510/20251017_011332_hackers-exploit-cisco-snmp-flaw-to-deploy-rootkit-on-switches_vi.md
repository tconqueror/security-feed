# Tin tặc lợi dụng lỗ hổng SNMP của Cisco để triển khai rootkit trên các switch

![Tin tặc lợi dụng lỗ hổng SNMP của Cisco để triển khai rootkit trên các switch](https://www.bleepstatic.com/content/hl-images/2025/03/04/Cisco_headpic.jpg)

Các tác nhân đe dọa đã lợi dụng một lỗ hổng thực thi mã từ xa mới được vá gần đây (CVE-2025-20352) trong các thiết bị mạng Cisco cũ, không được bảo vệ để triển khai một Linux rootkit và chiếm quyền truy cập bền vững.

Vấn đề an ninh được khai thác trong các cuộc tấn công ảnh hưởng đến Simple Network Management Protocol (SNMP) trong Cisco IOS và IOS XE và dẫn đến RCE nếu kẻ tấn công có quyền root.

Theo công ty an ninh mạng Trend Micro, các cuộc tấn công nhắm mục tiêu vào các thiết bị Cisco 9400, 9300 và dòng legacy 3750G không có giải pháp endpoint detection response.

Trong bulletin gốc cho CVE-2025-20352, được cập nhật vào ngày 6 tháng Mười, Cisco gắn thẻ lỗ hổng này là [bị khai thác như zero day](https://www.bleepingcomputer.com/news/security/cisco-warns-of-ios-zero-day-vulnerability-exploited-in-attacks/), với Product Security Incident Response Team (PSIRT) của công ty nói rằng họ "đã biết về việc khai thác thành công."

Các nhà nghiên cứu của Trend Micro theo dõi các cuộc tấn công dưới tên 'Operation Zero Disco' vì phần mềm độc hại thiết lập một mật khẩu truy cập toàn cục có chứa từ "disco."

Báo cáo từ Trend Micro ghi nhận rằng tác nhân đe dọa cũng đã cố gắng khai thác [CVE-2017-3881](https://www.bleepingcomputer.com/news/security/ciscos-investigation-into-vault-7-leak-uncovers-0-day-affecting-318-products/), một lỗ hổng đã bảy năm tuổi trong mã Cluster Management Protocol ở IOS và IOS XE.

Rootkit được cấy trên các hệ thống dễ bị tấn công có một bộ điều khiển UDP có thể lắng nghe trên bất kỳ cổng nào, bật/tắt hoặc xóa nhật ký, vượt qua AAA và VTY ACLs, bật/tắt mật khẩu toàn cục, ẩn các mục cấu hình đang chạy và đặt lại dấu thời gian lần ghi cuối cho chúng.

![UDP controller functions](https://www.bleepstatic.com/images/news/u/1220909/2025/October/udpcontroller.jpg)

**Chức năng bộ điều khiển UDP**  
_Nguồn: Trend Micro_

Trong một cuộc tấn công mô phỏng, các nhà nghiên cứu đã cho thấy rằng có thể vô hiệu hóa ghi nhật ký, giả mạo một IP trạm trung gian thông qua ARP spoofing, vượt qua các quy tắc tường lửa nội bộ và di chuyển ngang giữa các VLANs.

![Overview of the simulated attack](https://www.bleepstatic.com/images/news/u/1220909/2025/October/overview(1).jpg)

**Tổng quan về cuộc tấn công mô phỏng**  
_Nguồn: Trend Micro_

Mặc dù các switch mới hơn có khả năng chống lại các cuộc tấn công này hơn do bảo vệ Address Space Layout Randomization (ASLR), Trend Micro nói rằng chúng không miễn dịch và việc nhắm mục tiêu liên tục có thể làm chúng bị xâm phạm.

Sau khi triển khai rootkit, phần mềm độc hại "cài đặt một số hooks lên IOSd, dẫn đến các thành phần không dựa trên tệp biến mất sau khi khởi động lại," các [nhà nghiên cứu nói](http://www.trendmicro.com/en%5Fus/research/25/j/operation-zero-disco-cisco-snmp-vulnerability-exploit.html).

Các nhà nghiên cứu đã có thể phục hồi cả biến thể 32-bit và 64-bit của khai thác SNMP.

Trend Micro lưu ý rằng hiện tại không có công cụ nào có thể đánh dấu chắc chắn một switch Cisco đã bị xâm phạm từ các cuộc tấn công này. Nếu nghi ngờ bị tấn công, khuyến nghị là thực hiện điều tra firmware và vùng ROM ở mức thấp.

Danh sách các chỉ số bị xâm phạm (IoCs) liên quan đến 'Operation Zero Disco' [có thể được tìm thấy ở đây](https://documents.trendmicro.com/images/uploads/Operation%20Zero%20Disco%20IoCs-wpV04Mt.txt).