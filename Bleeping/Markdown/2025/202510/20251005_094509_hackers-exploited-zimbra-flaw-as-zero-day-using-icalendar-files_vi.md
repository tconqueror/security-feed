# Tin tặc lợi dụng lỗ hổng Zimbra như zero-day bằng cách sử dụng iCalendar files

![Tin tặc lợi dụng lỗ hổng Zimbra như zero-day bằng cách sử dụng iCalendar files](https://www.bleepstatic.com/content/hl-images/2024/10/21/email.jpg)

Các nhà nghiên cứu đang giám sát các tệp .ICS lịch lớn hơn đã phát hiện rằng một lỗ hổng trong Zimbra Collaboration Suite (ZCS) đã được sử dụng trong các cuộc tấn công zero-day vào đầu năm.

Các tệp ICS, còn được gọi là iCalendar files, được dùng để lưu trữ thông tin lịch và lập lịch (các cuộc họp, sự kiện và nhiệm vụ) dưới dạng văn bản thuần và để trao đổi giữa các ứng dụng lịch khác nhau.

Các tác nhân đe dọa đã khai thác CVE-2025-27915, một lỗ hổng cross-site scripting (XSS) trong ZCS 9.0, 10.0 và 10.1, để cài đặt một payload JavaScript lên các hệ thống mục tiêu.

Lỗ hổng bắt nguồn từ việc khử độc (sanitization) không đủ đối với nội dung HTML trong các tệp ICS, điều này cho phép kẻ tấn công thực thi JavaScript tùy ý trong phiên của nạn nhân, như thiết lập bộ lọc chuyển hướng thư đến chúng.

Zimbra [addressed the security issue](http://wiki.zimbra.com/wiki/Zimbra%5FReleases/10.1.5#Security%5FFixes) vào ngày 27 tháng 1 bằng cách phát hành ZCS 9.0.0 P44, 10.0.13 và 10.1.5, nhưng không đề cập đến bất kỳ hoạt động khai thác đang diễn ra nào.

Tuy nhiên, các nhà nghiên cứu tại StrikeReady, một công ty phát triển nền tảng an ninh vận hành và quản lý mối đe dọa dựa trên AI, đã phát hiện cuộc tấn công sau khi theo dõi các tệp .ICS có kích thước lớn hơn 10KB và chứa mã JavaScript.

Họ xác định rằng các cuộc tấn công đã bắt đầu vào đầu tháng Một, trước khi Zimbra phát hành bản vá.

Tác nhân đe dọa đã giả mạo Văn phòng Nghi lễ của Libyan Navy trong một email chuyển giao một khai thác zero-day nhắm vào một tổ chức quân đội Brazil.

![Email độc hại do kẻ tấn công gửi](https://www.bleepstatic.com/images/news/u/1220909/2025/October/emnail.jpg)

**Email độc hại do kẻ tấn công gửi**  
_Source: StrikeReady_

Email độc hại chứa một tệp ICS 00KB với một tệp JavaScript đã bị obfuscate bằng sơ đồ mã hóa Base64.

![Giải mã payload JavaScript](https://www.bleepstatic.com/images/news/u/1220909/2025/October/js.jpg)

**Giải mã payload JavaScript**  
_Source: StrikeReady_

Theo [phân tích của các nhà nghiên cứu](https://strikeready.com/blog/0day-ics-attack-in-the-wild/), payload được thiết kế để đánh cắp dữ liệu từ Zimbra Webmail, như thông tin đăng nhập, email, danh bạ và thư mục chia sẻ.

StrikeReady cho biết mã độc được triển khai để thực thi ở chế độ bất đồng bộ và trong nhiều Immediately Invoked Function Expressions (IIFEs). Các nhà nghiên cứu phát hiện rằng nó có thể thực hiện các hành động sau:

* Tạo các trường username/password ẩn
* Đánh cắp thông tin đăng nhập từ các form đăng nhập
* Giám sát hoạt động người dùng (chuột và bàn phím) và đăng xuất người dùng không hoạt động để kích hoạt hành vi đánh cắp
* Sử dụng Zimbra SOAP API để tìm kiếm thư mục và truy xuất email
* Gửi nội dung email tới kẻ tấn công (lặp lại mỗi 4 giờ)
* Thêm một bộ lọc tên "Correo" để chuyển tiếp thư đến một địa chỉ Proton
* Thu thập các hiện vật xác thực/sao lưu này và exfiltrate chúng
* Truy xuất danh bạ, danh sách phân phối và thư mục chia sẻ
* Thêm độ trễ 60 giây trước khi thực thi
* Thi hành một cửa kiểm soát thực thi 3 ngày (chỉ chạy lại nếu ≥3 ngày kể từ lần chạy trước)
* Ẩn các phần tử giao diện người dùng (UI) để giảm manh mối trực quan

StrikeReady không thể gán cuộc tấn công này với độ tin cậy cao cho bất kỳ nhóm mối đe dọa đã biết nào, nhưng lưu ý rằng có một số nhỏ các kẻ tấn công có thể phát hiện lỗ hổng zero-day trong các sản phẩm được sử dụng rộng rãi, đề cập rằng một "nhóm liên kết với Nga đặc biệt sản xuất nhiều".

Các nhà nghiên cứu cũng đề cập rằng các tactics, techniques, and procedures (TTPs) tương tự đã được quan sát trong các cuộc tấn công được gán cho UNC1151 - một nhóm mối đe dọa mà [Mandiant linked to the Belarusian government](https://cloud.google.com/blog/topics/threat-intelligence/unc1151-linked-to-belarus-government/).

Báo cáo của StrikeReady chia sẻ [indicators of compromise](http://github.com/StrikeReady-Inc/research/tree/main/2025-09-29%20ics%200day) và một phiên bản JavaScript đã được deobfuscate từ cuộc tấn công leveraging .INC calendar files.

BleepingComputer đã liên hệ với Zimbra với các câu hỏi về hoạt động này, và chúng tôi sẽ cập nhật bài viết này với tuyên bố của họ khi chúng tôi nhận được.