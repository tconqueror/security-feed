# Chuỗi khai thác RCE của Craft CMS được sử dụng trong các cuộc tấn công zero-day để đánh cắp dữ liệu

![Craft CMS](https://www.bleepstatic.com/content/hl-images/2025/02/21/craft-cms-header-w.jpg)

Hai lỗ hổng ảnh hưởng đến Craft CMS đã được kết hợp với nhau trong các cuộc tấn công zero-day để xâm nhập máy chủ và đánh cắp dữ liệu, với việc khai thác vẫn đang diễn ra, theo CERT Orange Cyberdefense.

Các lỗ hổng này đã được đội CSIRT của Orange Cyberdefense phát hiện, khi họ được gọi vào để điều tra một máy chủ bị xâm phạm.

Trong khuôn khổ cuộc điều tra, họ đã phát hiện ra rằng hai lỗ hổng zero-day ảnh hưởng đến Craft CMS đã bị khai thác để xâm nhập máy chủ:

* **CVE-2025-32432:** Một lỗ hổng thực thi mã từ xa (RCE) trong Craft CMS.
* **CVE-2024-58136:** Một lỗi xác thực đầu vào trong framework Yii được sử dụng bởi Craft CMS.

Theo báo cáo của SensePost, đội ngũ hacking đạo đức của Orange Cyberdefense cho biết, các tác nhân gây hại đã kết hợp cả hai lỗ hổng này với nhau để xâm nhập máy chủ và tải lên một trình quản lý file PHP.

Cuộc tấn công bắt đầu bằng việc khai thác CVE-2025-32432, cho phép các kẻ tấn công gửi một yêu cầu được tạo đặc biệt chứa "return URL" làm tham số được lưu trong tệp phiên PHP. Tên phiên này được gửi đến người truy cập như một phần của phản hồi đối với yêu cầu HTTP.

![Yêu cầu lưu trữ return URL trong phiên Craft CMS](https://www.bleepstatic.com/images/news/security/c/craft-cms/craft-cms-return-url.jpg)

**Yêu cầu lưu trữ return URL trong phiên Craft CMS**  
_Nguồn: SensePost_

Giai đoạn thứ hai của cuộc tấn công tận dụng một lỗi trong framework Yii (CVE-2024-58136), mà Craft CMS sử dụng. Để khai thác lỗi này, kẻ tấn công đã gửi một payload JSON độc hại khiến mã PHP trong tệp phiên được thực thi trên máy chủ.

Điều này cho phép kẻ tấn công cài đặt một trình quản lý file dựa trên PHP trên máy chủ để tiếp tục xâm phạm hệ thống.

Orange đã cho BleepingComputer biết rằng họ đã thấy các bước xâm phạm bổ sung, bao gồm việc tải lên thêm các backdoor và dữ liệu bị khai thác. Thông tin chi tiết về hoạt động sau khai thác này sẽ được mô tả trong một bài viết blog sắp tới.

Cuối cùng, các nhà phát triển Yii đã [sửa lỗi CVE-2024-58136](https://www.yiiframework.com/news/709/please-upgrade-to-yii-2-0-52) trong phiên bản Yii 2.0.52 được phát hành vào ngày 9 tháng 4.

Craft CMS cũng đã [sửa lỗi CVE-2025-32432](https://craftcms.com/knowledge-base/craft-cms-cve-2025-32432) trong các phiên bản 3.9.15, 4.14.15 và 5.6.17 vào ngày 10 tháng 4. Mặc dù họ không cập nhật Yii lên phiên bản mới nhất trong Craft CMS, Orange cho biết rằng chuỗi tấn công vẫn đã được khắc phục.

"Hôm nay, phiên bản 2.0.51 (có lỗ hổng) vẫn là mặc định trong Craft. Tuy nhiên, với bản sửa lỗi CVE-2025-32432, vấn đề Yii hiện không thể bị kích hoạt," Orange đã cho BleepingComputer biết.

Craft CMS khuyến nghị rằng các quản trị viên thực hiện các bước sau nếu họ tin rằng trang web của họ đã bị xâm phạm:

* Làm mới khóa bảo mật của bạn trong trường hợp nó đã bị lấy cắp. Bạn có thể chạy lệnh php craft setup/security-key và sao chép biến môi trường CRAFT\_SECURITY\_KEY đã cập nhật vào tất cả các môi trường sản xuất.
* Nếu bạn có bất kỳ khóa riêng nào khác được lưu dưới dạng biến môi trường (ví dụ: S3 hoặc Stripe), hãy làm mới những khóa đó.
* Thay đổi thông tin đăng nhập cơ sở dữ liệu của bạn.
* Nhằm mục đích phòng ngừa, bạn có thể muốn buộc tất cả người dùng của mình phải đặt lại mật khẩu trong trường hợp cơ sở dữ liệu của bạn bị xâm phạm. Bạn có thể thực hiện điều đó bằng cách chạy php craft resave/users --set passwordResetRequired --to "fn() => true".

Để biết đầy đủ các chỉ báo xâm phạm, bao gồm địa chỉ IP và tên tệp, bạn có thể [xem phụ lục](https://sensepost.com/blog/2025/investigating-an-in-the-wild-campaign-using-rce-in-craftcms/#iocs) trong báo cáo của SensePost.

Trong tháng Hai, [CISA cũng đã xác định](https://www.bleepingcomputer.com/news/security/cisa-flags-craft-cms-code-injection-flaw-as-exploited-in-attacks/) một lỗ hổng tiêm mã (RCE) được theo dõi dưới mã CVE-2025-23209 trong Craft CMS 4 và 5 đang bị khai thác trong các cuộc tấn công.