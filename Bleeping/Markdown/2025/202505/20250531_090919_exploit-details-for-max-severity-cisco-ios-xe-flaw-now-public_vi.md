# Chi tiết khai thác cho lỗ hổng Cisco IOS XE nghiêm trọng nhất hiện đã công khai

![Cisco](https://www.bleepstatic.com/content/hl-images/2024/07/01/Cisco-logo.jpg)

Các chi tiết kỹ thuật về lỗ hổng tải lên tệp không kiểm soát có mức độ nghiêm trọng tối đa của Cisco IOS XE WLC được theo dõi là CVE-2025-20188 đã được công khai, đưa chúng ta gần hơn với một khai thác hoạt động.

Bài viết của các nhà nghiên cứu Horizon3 không chứa kịch bản khai thác RCE 'sẵn sàng chạy', nhưng cung cấp đủ thông tin để một kẻ tấn công có kỹ năng hoặc thậm chí một LLM lấp đầy những phần còn thiếu.

Với nguy cơ ngay lập tức về việc vũ khí hóa và sử dụng rộng rãi trong các cuộc tấn công, người dùng bị ảnh hưởng được khuyến nghị hành động ngay để bảo vệ các điểm cuối của họ.

## Lỗ hổng Cisco IOS XE WLC

Cisco [đã công bố](https://www.bleepingcomputer.com/news/security/cisco-fixes-max-severity-ios-xe-flaw-letting-attackers-hijack-devices/) lỗ hổng nghiêm trọng trong Phần mềm IOS XE cho Bộ điều khiển LAN không dây vào ngày 7 tháng 5 năm 2025, cho phép một kẻ tấn công chiếm quyền kiểm soát các thiết bị.

Nhà cung cấp cho biết lỗ hổng này do một JSON Web Token (JWT) cứng mã hóa cho phép một kẻ tấn công từ xa không cần xác thực tải lên các tệp, thực hiện vượt đường dẫn và thực hiện các lệnh tùy ý với đặc quyền root.

Thông báo cho biết CVE-2025-20188 chỉ nguy hiểm khi tính năng 'Tải xuống Hình ảnh AP ngoài băng' được bật trên thiết bị, trong đó các mô hình thiết bị sau đây đang gặp rủi ro:

* Bộ điều khiển không dây Catalyst 9800-CL cho Cloud
* Bộ điều khiển không dây Catalyst 9800 nhúng cho Bộ chuyển mạch Catalyst 9300, 9400 và 9500 Series
* Bộ điều khiển không dây Catalyst 9800 Series
* Bộ điều khiển không dây nhúng trên các AP Catalyst

## Ví dụ tấn công của Horizon3

Phân tích của Horizon3 [cho thấy](https://horizon3.ai/attack-research/attack-blogs/cisco-ios-xe-wlc-arbitrary-file-upload-vulnerability-cve-2025-20188-analysis/) rằng lỗ hổng này tồn tại do một bí mật JWT cứng mã hóa dự phòng ("notfound") được sử dụng bởi các kịch bản Lua phía backend cho các điểm tải lên kết hợp với xác thực đường dẫn không đủ.

Cụ thể, backend sử dụng các kịch bản OpenResty (Lua + Nginx) để xác thực các mã thông báo JWT và xử lý tải lên tệp, nhưng nếu tệp '/tmp/nginx_jwt_key' bị thiếu, kịch bản sẽ quay lại chuỗi "notfound" làm bí mật để xác minh các JWT.

Điều này cơ bản cho phép các kẻ tấn công tạo ra các mã thông báo hợp lệ mà không cần biết bất kỳ bí mật nào bằng cách đơn giản sử dụng 'HS256' và 'notfound.'

Ví dụ của Horizon3 gửi một yêu cầu HTTP POST với một tệp tải lên đến điểm '/ap_spec_rec/upload/' qua cổng 8443 và sử dụng vượt đường dẫn tên tệp để bỏ một tệp vô hại (foo.txt) ra ngoài thư mục dự kiến.

![Yêu cầu để tái tạo JWT bằng cách sử dụng bí mật notfound](https://www.bleepstatic.com/images/news/u/1220909/2025/May/request(1).jpg)

**Yêu cầu để tái tạo JWT bằng cách sử dụng bí mật notfound**  
_Nguồn: Horizon3_

Để nâng cao lỗ hổng tải lên tệp lên thực thi mã từ xa, kẻ tấn công có thể ghi đè các tệp cấu hình được tải bởi các dịch vụ backend, bỏ các web shells hoặc lạm dụng các tệp được giám sát để kích hoạt các hành động không được phép.

Ví dụ của Horizon3 lạm dụng dịch vụ 'pvp.sh' giám sát các thư mục cụ thể, ghi đè lên các tệp cấu hình mà nó phụ thuộc và kích hoạt lại ngay cả để thực thi các lệnh của kẻ tấn công.

Với nguy cơ khai thác gia tăng, người dùng được khuyến nghị nâng cấp lên phiên bản đã được sửa lỗi (17.12.04 hoặc mới hơn) càng sớm càng tốt.

Làm một biện pháp tạm thời, các quản trị viên có thể tắt tính năng Tải xuống Hình ảnh AP ngoài băng để đóng dịch vụ bị tổn thương.