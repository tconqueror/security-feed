+-+-+-+-
# Công cụ khai thác Apache Parquet phát hiện máy chủ dễ bị tổn thương bởi lỗ hổng nghiêm trọng

![Apache](https://www.bleepstatic.com/content/hl-images/2022/10/19/apache-header-image.jpg)

Một khai thác proof-of-concept đã được phát hành công khai cho lỗ hổng Apache Parquet có độ nghiêm trọng tối đa, được theo dõi là CVE-2025-30065, giúp dễ dàng phát hiện các máy chủ dễ bị tổn thương.

Công cụ này được các nhà nghiên cứu của F5 Labs phát hành sau khi điều tra lỗ hổng này và nhận thấy rằng nhiều PoC hiện có đều yếu hoặc hoàn toàn không hoạt động.

Công cụ này chứng minh khả năng khai thác thực tế của CVE-2025-30065 và cũng giúp các quản trị viên đánh giá môi trường của họ và bảo mật các máy chủ.

Apache Parquet là một định dạng lưu trữ cột mã nguồn mở được thiết kế cho việc xử lý dữ liệu hiệu quả, được sử dụng rộng rãi bởi các nền tảng dữ liệu lớn và các tổ chức tham gia vào kỹ thuật và phân tích dữ liệu.

Lỗ hổng này lần đầu tiên được công bố vào ngày 1 tháng 4 năm 2025, sau phát hiện trước đó của nhà nghiên cứu Amazon, Keyi Li. Nó được phân loại là một lỗi thực thi mã từ xa ảnh hưởng đến tất cả các phiên bản Apache Parquet cho đến và bao gồm 1.15.0.

Từ góc độ kỹ thuật, CVE-2025-30065 là một lỗ hổng deserialization trong mô-đun parquet-avro của Apache Parquet Java, nơi thư viện không hạn chế các lớp Java có thể được khởi tạo khi đọc dữ liệu Avro được nhúng trong các tệp Parquet.

Vào ngày 2 tháng 4 năm 2025, [Endor Labs](https://www.bleepingcomputer.com/news/security/max-severity-rce-flaw-discovered-in-widely-used-apache-parquet/) đã công bố một báo cáo cảnh báo về nguy cơ khai thác và tác động tiềm năng của nó đối với các hệ thống nhập các tệp Parquet từ các điểm bên ngoài.

Phân tích tiếp theo của F5 Labs cho thấy rằng lỗ hổng này không phải là một RCE đầy đủ nhưng vẫn có thể bị lạm dụng nếu một lớp có tác động phụ khi khởi tạo, như khi thực hiện một yêu cầu mạng từ hệ thống dễ bị tổn thương đến một máy chủ do kẻ tấn công kiểm soát.

Tuy nhiên, các nhà nghiên cứu cho rằng việc khai thác thực tế là khó khăn, và CVE-2025-30065 có giá trị hạn chế đối với các kẻ tấn công.

"Mặc dù Parquet và Avro được sử dụng rộng rãi, nhưng vấn đề này yêu cầu một tập hợp các tình huống cụ thể mà không có khả năng xảy ra trong tình huống chung", [đọc báo cáo của F5 Labs](https://www.f5.com/labs/articles/threat-intelligence/canary-exploit-tool-for-cve-2025-30065-apache-parquet-avro-vulnerability).

"Ngay cả như vậy, CVE này chỉ cho phép các kẻ tấn công kích hoạt việc khởi tạo một đối tượng Java mà sau đó phải có một tác động phụ có lợi cho kẻ tấn công."

Mặc dù khả năng khai thác thấp, nhưng các nhà nghiên cứu thừa nhận rằng một số tổ chức xử lý các tệp Parquet từ các nguồn bên ngoài, thường là không được xác thực, và do đó nguy cơ là đáng kể trong một số môi trường.

Vì lý do này, F5 Labs đã tạo ra một công cụ "canary exploit" ([có sẵn trên GitHub](https://github.com/F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065)) kích hoạt một yêu cầu HTTP GET thông qua việc khởi tạo của javax.swing.JEditorKit, cho phép người dùng xác minh mức độ phơi bày.

Ngoài việc sử dụng công cụ này, cũng được khuyến nghị nâng cấp lên phiên bản Apache Parquet 15.1.1 hoặc mới hơn và cấu hình 'org.apache.parquet.avro.SERIALIZABLE\_PACKAGES' để hạn chế các gói nào được phép cho hoạt động deserialization.