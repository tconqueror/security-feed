# Phần mềm độc xóa dữ liệu trên Linux ẩn trong các mô-đun Go độc hại trên GitHub

![Phần mềm độc xóa dữ liệu trên Linux ẩn trong các mô-đun Go độc hại trên GitHub](https://www.bleepstatic.com/content/hl-images/2022/10/07/hacker-hammer-destroying-data.jpg)

Một cuộc tấn công chuỗi cung ứng nhắm vào các máy chủ Linux với phần mềm độc xóa dữ liệu ẩn trong các mô-đun Golang được công bố trên GitHub.

Chiến dịch này đã được phát hiện vào tháng trước và dựa vào ba mô-đun Go độc hại, bao gồm “mã được làm khó hiểu” để tải về các payload từ xa và thực thi chúng.

### Hủy diệt hoàn toàn ổ đĩa

Cuộc tấn công dường như được thiết kế đặc biệt cho các máy chủ và môi trường phát triển dựa trên Linux, vì payload phá hoại - một script Bash có tên _done.sh_, thực thi lệnh ‘dd’ để xóa tệp.

Hơn nữa, payload xác minh rằng nó chạy trong môi trường Linux (_runtime.GOOS == "linux"_) trước khi cố gắng thực thi.

Một phân tích từ công ty an ninh chuỗi cung ứng Socket cho thấy rằng lệnh này ghi đè bằng số không lên mỗi byte dữ liệu, dẫn đến mất dữ liệu không thể phục hồi và hỏng hệ thống.

Mục tiêu là khối lượng lưu trữ chính, _/dev/sda_, nơi chứa dữ liệu hệ thống quan trọng, tệp người dùng, cơ sở dữ liệu và cấu hình.

“Bằng cách làm đầy toàn bộ ổ đĩa bằng số không, script hoàn toàn phá hủy cấu trúc hệ thống tệp, hệ điều hành và tất cả dữ liệu người dùng, khiến hệ thống không thể khởi động và không thể phục hồi” - [Socket](https://socket.dev/blog/wget-to-wipeout-malicious-go-modules-fetch-destructive-payload)

Các nhà nghiên cứu đã phát hiện cuộc tấn công vào tháng Tư và xác định ba mô-đun Go trên GitHub, hiện đã bị xóa khỏi nền tảng:

* github\[.\]com/truthfulpharm/prototransform
* github\[.\]com/blankloggia/go-mcp
* github\[.\]com/steelpoor/tlsproxy

Cả ba mô-đun đều chứa mã được làm khó hiểu có thể giải mã thành các lệnh sử dụng ‘wget’ để tải về script xóa dữ liệu độc hại (/bin/bash hoặc /bin/sh).

Theo các nhà nghiên cứu của Socket, các payload được thực thi ngay sau khi tải về, “gần như không để lại thời gian cho phản ứng hoặc phục hồi.”

Các mô-đun Go độc hại này có vẻ như đã mạo danh các dự án hợp pháp để chuyển đổi dữ liệu tin nhắn sang nhiều định dạng khác nhau (Prototransform), một triển khai Go của Giao thức Ngữ cảnh Mô hình (go-mcp), và một công cụ proxy TLS cung cấp mã hóa cho các máy chủ TCP và HTTP (tlsproxy).

Các nhà nghiên cứu của Socket cảnh báo rằng ngay cả việc tiếp xúc tối thiểu với các mô-đun phá hoại đã phân tích có thể ảnh hưởng đáng kể như mất mát hoàn toàn dữ liệu.

Do tính phi tập trung của hệ sinh thái Go thiếu các kiểm tra thích hợp, các gói của các nhà phát triển khác nhau có thể có cùng hoặc tên tương tự.

Các kẻ tấn công có thể tận dụng điều này để tạo ra các không gian tên mô-đun có vẻ hợp pháp và chờ đợi các nhà phát triển tích hợp mã độc hại vào các dự án của họ.