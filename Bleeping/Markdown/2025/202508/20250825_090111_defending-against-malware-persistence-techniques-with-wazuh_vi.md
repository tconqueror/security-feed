# Phòng thủ chống lại các kỹ thuật duy trì malware với Wazuh

![Đối phó với malware persistence](https://www.bleepstatic.com/content/posts/2025/08/23/wazuh-malware-persistence.jpg)

**Các kỹ thuật duy trì malware** cho phép kẻ tấn công duy trì quyền truy cập vào các điểm cuối bị xâm phạm bất chấp việc khởi động lại hệ thống, thay đổi thông tin xác thực, hoặc các gián đoạn khác. Những phương pháp phổ biến bao gồm thay đổi cấu hình, chèn mã khởi động và hijacking các quy trình hợp pháp.

Các phương pháp này đảm bảo rằng phần mềm độc hại hoặc kẻ tấn công vẫn hoạt động, cho phép các hoạt động độc hại tiếp tục mà không cần phải tái khai thác.

Trong bài viết này, chúng ta sẽ xem xét bản chất của các kỹ thuật duy trì malware, tác động của chúng và các chiến lược để phòng thủ chống lại chúng.

## Các kỹ thuật duy trì malware phổ biến

Khung MITRE ATT&CK đã lập danh sách một loạt các kỹ thuật được các tác nhân đe dọa sử dụng để duy trì sự tồn tại. Dưới đây là những ví dụ về các kỹ thuật duy trì malware từ khung này cho phép kẻ tấn công duy trì quyền truy cập lâu dài vào các điểm cuối bị xâm phạm:

**T1053 – Scheduled Task/Job**

Kẻ thù lạm dụng các chức năng lập lịch nhiệm vụ để chạy mã độc hại liên tục hoặc theo các khoảng thời gian xác định. Các ứng dụng tiện ích như Task Scheduler (Windows), cron (Linux), và launchd (macOS) có thể thực thi các chương trình hoặc kịch bản vào các thời điểm được xác định hoặc để phản ứng với một số sự kiện nhất định.

**T1037 – Boot or Logon Initialization Scripts**

Kẻ tấn công cấu hình các kịch bản để thực thi trong quá trình khởi động hệ thống hoặc khi người dùng đăng nhập, đảm bảo sự duy trì hoặc tăng quyền. Trên Linux, các cơ chế như rc.local, init.d, hoặc systemd thường được sử dụng để khởi động mã độc hại.

**T1543 – Create or Modify System Process**

Các quy trình cấp hệ thống như dịch vụ Windows, daemon Linux, hoặc tác nhân launchd macOS chạy tự động trong nền. Các tác nhân đe dọa có thể cài đặt hoặc sửa đổi các quy trình này để thực thi các payload độc hại khi khởi động hoặc trong quá trình vận hành hệ thống.

**T1136 – Create Account**

Kẻ thù có thể tạo các tài khoản người dùng địa phương, miền hoặc đám mây mới trên hệ thống bị xâm phạm để duy trì quyền truy cập. Với quyền hạn đủ, những tài khoản này có thể được sử dụng để có quyền truy cập lâu dài mà không cần đến các công cụ truy cập từ xa kéo dài.

**T1098 - Account Manipulation**

Việc thao tác tài khoản cho phép kẻ tấn công duy trì hoặc nâng cao quyền truy cập bằng cách sửa đổi thông tin xác thực, thay đổi tư cách nhóm, hoặc bỏ qua các chính sách bảo mật. Ví dụ, việc thêm một khóa SSH vào \~/.ssh/authorized\_keys cho phép truy cập từ xa liên tục mà không cần mật khẩu.

## Tác động của các kỹ thuật duy trì malware

Các kỹ thuật duy trì malware được thiết kế để đảm bảo rằng kẻ tấn công duy trì quyền truy cập lâu dài vào các hệ thống bị xâm phạm. Dưới đây, chúng ta sẽ khám phá một số tác động của các kỹ thuật duy trì malware.

### Thời gian tồn tại kéo dài

Các kỹ thuật duy trì malware cho phép kẻ tấn công ở lại trong một môi trường bị xâm phạm trong thời gian dài mà không cần phải tái khai thác.

Sự hiện diện kéo dài này, thường kéo dài hàng tuần hoặc hàng tháng, cho phép chúng thời gian để khám phá mạng, nâng cao quyền hạn, và lập kế hoạch cho các bước đi tiếp theo trước khi bị phát hiện.

### Lẩn tránh khắc phục

Ngay cả sau khi bị gỡ bỏ ban đầu, kẻ tấn công có thể lấy lại quyền truy cập thông qua các cơ chế duy trì như các tác vụ được lập lịch, các dịch vụ độc hại, hoặc các tài khoản người dùng không được授权.

Điều này khiến cho các nỗ lực làm sạch trở nên bất lực trừ khi tất cả các cơ chế duy trì được xác định và gỡ bỏ.

### Rò rỉ dữ liệu

Quyền truy cập liên tục thường được sử dụng trong các mối đe dọa tiên tiến và kéo dài (APTs), nơi các kẻ tấn công dần dần rò rỉ dữ liệu trong một khoảng thời gian kéo dài để duy trì sự xâm nhập và khai thác lâu dài.

Điều này cho phép thông tin nhạy cảm, chẳng hạn như thông tin xác thực hoặc dữ liệu kinh doanh, bị đánh cắp theo thời gian.

### Triển khai thêm các phần mềm độc hại

Với quyền truy cập liên tục, các kẻ tấn công có thể giới thiệu các công cụ độc hại bổ sung, bao gồm ransomware, backdoors, hoặc remote access trojans.

Điều này có thể làm cho hệ thống bị xâm phạm thêm hoặc mở rộng bề mặt tấn công trên mạng.

### Vi phạm tuân thủ quy định

Các kỹ thuật duy trì malware cho phép kẻ tấn công duy trì quyền truy cập trái phép vào các hệ thống trong một khoảng thời gian dài.

Quyền truy cập lâu dài này có thể dẫn đến những vi phạm các tiêu chuẩn quy định, chẳng hạn như GDPR, HIPAA và PCI DSS, yêu cầu bảo vệ dữ liệu nghiêm ngặt, tính toàn vẹn của hệ thống và thông báo vi phạm.

## [Phòng thủ chống lại các kỹ thuật duy trì malware](http://wazuh.com/?utm%5Fsource=bleepingcomputer.com&utm%5Fmedium=referral&utm%5Fcampaign=wazuh%5Fbleepingcomputer)

Bảo vệ hệ thống của bạn chống lại các mối đe dọa ẩn. Tìm hiểu cách kẻ tấn công sử dụng các kỹ thuật duy trì malware, và cách Wazuh giúp bạn phát hiện và ngăn chặn chúng.

[Tìm hiểu thêm về Wazuh](https://wazuh.com/?utm%5Fsource=bleepingcomputer.com&utm%5Fmedium=referral&utm%5Fcampaign=wazuh%5Fbleepingcomputer)

## Cách phòng thủ chống lại các kỹ thuật duy trì malware

Phòng thủ chống lại các kỹ thuật duy trì đòi hỏi một cách tiếp cận đa lớp kết hợp phát hiện, ngăn chặn và ứng phó với sự cố.

Dưới đây là một số chiến lược phòng thủ chính:

1. **Quản lý bản vá:** Nhiều kỹ thuật duy trì khai thác các lỗ hổng đã biết trong hệ điều hành, ứng dụng, hoặc driver. Bằng cách áp dụng thường xuyên các bản vá cho những thành phần này, bạn có thể giảm đáng kể bề mặt tấn công hiện có.

2. **Giám sát tính toàn vẹn file (FIM):** FIM giúp phát hiện các thay đổi trái phép đối với các file quan trọng, chẳng hạn như kịch bản khởi động, cấu hình nhiệm vụ đã lên lịch, khóa registry, hoặc nhị phân ứng dụng. Bằng cách giám sát các file nhạy cảm này, bạn có thể xác định khi nào kẻ tấn công cố gắng duy trì sự tồn tại.

3. **Giám sát tài khoản người dùng:** Sự tồn tại thường liên quan đến việc tạo tài khoản người dùng mới, sửa đổi tài khoản hiện có hoặc nâng cao quyền hạn. Giám sát liên tục việc tạo, xóa và thay đổi quyền tài khoản có thể tiết lộ hành vi đáng ngờ.

4. **Tăng cường cấu hình hệ thống:** Bảo mật các cấu hình cơ bản giảm thiểu rủi ro kẻ tấn công lạm dụng các tính năng của hệ thống cho mục đích duy trì. Điều này bao gồm việc vô hiệu hóa các dịch vụ không sử dụng, thi hành các chính sách mật khẩu mạnh, giới hạn quyền quản trị và sử dụng các chính sách nhóm để hạn chế hành vi autorun.

5. **Tìm kiếm mối đe dọa:** Tiến hành tìm kiếm mối đe dọa bất ngờ cho phép các đội bảo mật phát hiện các cơ chế duy trì ẩn mà các công cụ tự động không thể phát hiện. Điều này bao gồm việc tìm kiếm hành vi đáng ngờ, chẳng hạn như các quá trình thực thi không bình thường, các nhiệm vụ đã lên lịch, hoặc malware lâu năm không hoạt động.

6. **Bảo mật điểm cuối:** Triển khai các công cụ bảo vệ điểm cuối mạnh mẽ như XDR cho phép giám sát theo thời gian thực các hoạt động và chặn các hành vi duy trì đã biết. Các công cụ điểm cuối hiện đại có thể phát hiện và tự động phản ứng với các chỉ báo như thay đổi registry, cài đặt dịch vụ, và thực thi kịch bản trái phép.

### Cách Wazuh phòng thủ chống lại các kỹ thuật duy trì malware

[Wazuh](https://wazuh.com/?utm%5Fsource=bleepingcomputer.com&utm%5Fmedium=referral&utm%5Fcampaign=wazuh%5Fbleepingcomputer) là một giải pháp bảo mật miễn phí và mã nguồn mở sẵn sàng cho doanh nghiệp, cung cấp sự bảo vệ SIEM và XDR thống nhất trên nhiều khối tải.

Nó cung cấp một cái nhìn tập trung cho phát hiện mối đe dọa và giám sát bảo mật qua các môi trường ảo hóa, tại chỗ, trên đám mây và container.

Wazuh cung cấp nhiều [khả năng](https://documentation.wazuh.com/current/user-manual/capabilities/index.html?utm%5Fsource=bleepingcomputer.com&utm%5Fmedium=referral&utm%5Fcampaign=wazuh%5Fbleepingcomputer) để phòng thủ chống lại các kỹ thuật duy trì malware. Những khả năng này bao gồm, nhưng không giới hạn ở:

* Phản ứng chủ động
* Giám sát tính toàn vẹn file (FIM)
* Đánh giá bảo mật và cấu hình (SCA)
* Phân tích dữ liệu log
* Phát hiện lỗ hổng

#### Phản ứng chủ động

Mô-đun Phản ứng Chủ động Wazuh cho phép các đội bảo mật tự động hóa các hành động phản ứng dựa trên các kích hoạt được định nghĩa trước, giúp họ quản lý các sự cố bảo mật một cách hiệu quả. Tự động hóa đảm bảo rằng các sự kiện có độ ưu tiên cao được xử lý một cách kịp thời và nhất quán.

Wazuh cung cấp nhiều kịch bản phản ứng tích hợp sẵn có thể thực hiện các hành động như chặn lưu lượng mạng độc hại hoặc xóa các file bị nhiễm từ các điểm cuối được giám sát.

Trong ví dụ dưới đây, mô-đun Phản ứng Chủ động vô hiệu hóa một tài khoản Linux đã bị nhắm mục tiêu bởi các cố gắng đăng nhập brute-force.

![Hình 1: Wazuh Active Response disables a Linux account targeted by brute-force attacks](https://www.bleepstatic.com/images/news/security/w/wazuh/malware-persistence/disabling-linux-account.png)

**Hình 1: Wazuh Active Response vô hiệu hóa tài khoản Linux bị tấn công brute-force**

#### Giám sát tính toàn vẹn file (FIM)

Mô-đun FIM của Wazuh giám sát các file và thư mục, tạo ra các cảnh báo khi một người dùng hoặc quá trình tạo, sửa đổi hoặc xóa các file được giám sát. Nó xây dựng một cơ sở dữ liệu bằng cách quét và lưu trữ các giá trị băm và thuộc tính file.

Khi một người dùng hoặc quá trình thay đổi một file, mô-đun so sánh giá trị băm và thuộc tính của nó với cơ sở dữ liệu và kích hoạt cảnh báo nếu phát hiện sự không khớp.

Bài viết trên blog [Phát hiện các kỹ thuật duy trì Linux phổ biến với Wazuh](https://wazuh.com/blog/detecting-common-linux-persistence-techniques-with-wazuh/?utm%5Fsource=bleepingcomputer.com&utm%5Fmedium=referral&utm%5Fcampaign=wazuh%5Fbleepingcomputer) nêu bật cách mô-đun FIM của Wazuh phát hiện sự tồn tại của malware trên các điểm cuối Linux.

Chúng tôi sử dụng mô-đun FIM để giám sát các thay đổi đối với các dịch vụ và bộ đếm thời gian systemd trên một điểm cuối được theo dõi. Vì systemd quản lý các dịch vụ và tác vụ khởi động, việc giám sát các file cấu hình của nó là rất quan trọng để phát hiện các thay đổi trái phép.

![](https://www.bleepstatic.com/images/news/security/w/wazuh/malware-persistence/systemd-services.png)

**Hình 2: Phát hiện các dịch vụ và bộ đếm thời gian systemd bằng cách sử dụng mô-đun FIM của Wazuh**

#### Đánh giá bảo mật và cấu hình (SCA)

Củng cố hệ thống giảm thiểu bề mặt tấn công bằng cách loại bỏ các cấu hình sai và các thành phần không cần thiết. Mô-đun SCA của Wazuh giúp cải thiện việc củng cố hệ thống bằng cách quét các điểm cuối được giám sát để phát hiện các cấu hình sai và khuyến nghị các hành động khắc phục. Nó sử dụng các file chính sách để kiểm tra các cài đặt hệ thống, các file, quy trình và các mục registry.

Ví dụ, Wazuh SCA có thể đánh giá liệu có cần thay đổi các chính sách mật khẩu, xóa phần mềm không cần thiết, vô hiệu hóa các dịch vụ không cần thiết, hoặc kiểm tra các cấu hình mạng hay không.

Trong Hình 3 dưới đây, kết quả quét Wazuh SCA cho thấy không thành công vì xác thực khóa công khai cho SSH không được bật.

**Hình 3: Kết quả quét Wazuh SCA cho thấy cấu hình SSH**

#### Phân tích dữ liệu log

Wazuh cung cấp cái nhìn sâu sắc vào hạ tầng CNTT của bạn bằng cách thu thập, phân tích và lưu trữ log từ các điểm cuối, thiết bị mạng, và ứng dụng.

Ajagent Wazuh, chạy trên một điểm cuối được giám sát, thu thập và chuyển tiếp các log hệ thống và ứng dụng đến máy chủ Wazuh để phân tích. Phân tích dữ liệu log cho phép phát hiện mối đe dọa, giám sát hiệu suất, khắc phục sự cố, kiểm toán tuân thủ và xác định các hoạt động bất thường.

Trong [Phát hiện các kỹ thuật duy trì Windows với Wazuh](https://wazuh.com/blog/detecting-windows-persistence-techniques-with-wazuh/?utm%5Fsource=bleepingcomputer.com&utm%5Fmedium=referral&utm%5Fcampaign=wazuh%5Fbleepingcomputer), agent Wazuh thu thập log từ một điểm cuối Windows và chuyển tiếp chúng đến máy chủ Wazuh để phân tích. Điều này giúp xác định dấu hiệu của sự tồn tại của malware, chẳng hạn như việc tạo tài khoản trái phép, thay đổi các thư mục khởi động hoặc các khóa registry, và sửa đổi các dịch vụ.

Hình 4 dưới đây minh họa việc phát hiện một sửa đổi đối với một dịch vụ Windows.

**Hình 4: Sửa đổi dịch vụ Windows**

#### Phát hiện lỗ hổng

Mô-đun Phát hiện Lỗ hổng Wazuh xác định các lỗ hổng trong hệ điều hành và các ứng dụng đã cài đặt bằng cách kết nối danh sách phần mềm với dữ liệu lỗ hổng đã biết trong nền tảng [Wazuh CTI](https://cti.wazuh.com/vulnerabilities/cves?utm%5Fsource=bleepingcomputer.com&utm%5Fmedium=referral&utm%5Fcampaign=wazuh%5Fbleepingcomputer). Nó tạo ra các cảnh báo hiển thị trên bảng điều khiển Wazuh, cung cấp cái nhìn rõ ràng về các lỗ hổng trên tất cả các điểm cuối được giám sát.

Điều này giúp các đội bảo mật thực hiện các biện pháp chủ động để giảm thiểu rủi ro và củng cố phòng thủ hệ thống trước khi việc khai thác xảy ra.

Bảng điều khiển phát hiện lỗ hổng trong Hình 5 dưới đây nêu bật tên gói, OS, agent, ID lỗ hổng, và mức độ nghiêm trọng của các lỗ hổng đã phát hiện.

**Hình 5: Bảng điều khiển phát hiện lỗ hổng Wazuh**

## Kết luận

Các kỹ thuật duy trì malware cho phép kẻ tấn công duy trì quyền truy cập lâu dài vào các hệ thống bị xâm phạm, gây ra những rủi ro đáng kể cho an ninh tổ chức.

Phòng thủ chống lại các kỹ thuật này yêu cầu một cách tiếp cận nhiều lớp kết hợp các biện pháp chủ động, chẳng hạn như củng cố hệ thống, FIM, vá lỗi định kỳ, tìm kiếm mối đe dọa, và giám sát người dùng.

Wazuh tăng cường phòng thủ chống lại mối đe dọa bằng cách cung cấp nhiều khả năng phát hiện và phản ứng đối với các hoạt động đáng ngờ trên các điểm cuối được giám sát, bao gồm các kỹ thuật duy trì malware. Nó cho phép các đội bảo mật giám sát các thay đổi trái phép, các tác vụ đã lên lịch, các quy trình không bình thường, các thay đổi tài khoản, và các chỉ báo khác của sự xâm phạm.

**Hãy bắt đầu sử dụng [Wazuh](https://wazuh.com/?utm%5Fsource=bleepingcomputer.com&utm%5Fmedium=referral&utm%5Fcampaign=wazuh%5Fbleepingcomputer) ngay hôm nay để tăng cường chiến lược phòng thủ của tổ chức bạn. Bạn cũng có thể tham gia [cộng đồng](https://wazuh.com/community/?utm%5Fsource=bleepingcomputer.com&utm%5Fmedium=referral&utm%5Fcampaign=wazuh%5Fbleepingcomputer) của họ để nhận hỗ trợ chuyên nghiệp.**

_Được tài trợ và viết bởi [Wazuh](https://wazuh.com/?utm%5Fsource=bleepingcomputer.com&utm%5Fmedium=referral&utm%5Fcampaign=wazuh%5Fbleepingcomputer)._