# Rò rỉ mã nguồn malware ERMAC Android phơi bày cơ sở hạ tầng trojan ngân hàng

![Rò rỉ mã nguồn malware ERMAC Android phơi bày cơ sở hạ tầng trojan ngân hàng](https://www.bleepstatic.com/content/hl-images/2024/05/03/Android-3.jpg)

Mã nguồn cho phiên bản 3 của trojan ngân hàng ERMAC Android đã bị rò rỉ trực tuyến, phơi bày nội bộ của nền tảng malware-as-a-service và cơ sở hạ tầng của các nhà điều hành.

Cơ sở mã này được phát hiện trong một thư mục mở bởi [các nhà nghiên cứu từ Hunt.io](https://hunt.io/blog/ermac-v3-banking-trojan-source-code-leak) trong quá trình quét tìm các tài nguyên bị lộ vào tháng 3 năm 2024.

Họ đã tìm thấy một tệp lưu trữ có tên Ermac 3.0.zip, chứa mã của malware, bao gồm backend, frontend (bảng điều khiển), máy chủ exfiltration, cấu hình triển khai, và bộ tạo cũng như công cụ làm mờ của trojan.

Các nhà nghiên cứu đã phân tích mã và nhận thấy rằng nó đã mở rộng đáng kể khả năng nhắm mục tiêu so với các phiên bản trước, với hơn 700 ứng dụng ngân hàng, mua sắm và tiền điện tử.

ERMAC đã [được ghi chép lần đầu tiên](https://www.threatfabric.com/blogs/ermac-another-cerberus-reborn) vào tháng 9 năm 2021 bởi ThreatFabric - một nhà cung cấp giải pháp và thông tin gian lận thanh toán trực tuyến cho lĩnh vực dịch vụ tài chính, như một sự tiến hóa của trojan ngân hàng Cerberus do một tác nhân đe dọa có tên ‘BlackRock’ điều hành.

ERMAC v2.0 đã được ESET phát hiện vào tháng 5 năm 2022, cho thuê cho tội phạm mạng với mức phí hàng tháng là 5.000 đô la, và [nhắm vào 467 ứng dụng](https://www.bleepingcomputer.com/news/security/new-ermac-20-android-malware-steals-accounts-wallets-from-467-apps/), tăng từ 378 trong phiên bản trước đó.

Vào tháng 1 năm 2023, ThreatFabric đã quan sát thấy BlackRock quảng bá một công cụ malware Android mới có tên [Hook](https://www.bleepingcomputer.com/news/security/new-hook-android-malware-lets-hackers-remotely-control-your-phone/), có vẻ như là một sự tiến hóa của ERMAC.

## Khả năng của ERMAC v3.0

Hunt.io đã tìm thấy và phân tích backend điều khiển và chỉ huy (C2) PHP của ERMAC, bảng điều khiển frontend được xây dựng bằng React, máy chủ exfiltration dựa trên Go, backdoor viết bằng Kotlin, và bảng điều khiển để tạo ra các APK đã bị trojan hóa tùy chỉnh.

Theo các nhà nghiên cứu, ERMAC v3.0 hiện nhắm vào thông tin nhạy cảm của người dùng trong hơn 700 ứng dụng.

![Một trong những tiêm form của ERMAC](https://www.bleepstatic.com/images/news/u/1220909/2025/August/inject.jpg)

**Một trong những tiêm form của ERMAC**  
_Nguồn: Hunt.io_

Ngoài ra, phiên bản mới nhất còn mở rộng các kỹ thuật tiêm form đã được ghi nhận trước đó, sử dụng AES-CBC cho các giao tiếp mã hóa, có bảng điều khiển người điều hành được thiết kế lại, và tăng cường khả năng đánh cắp dữ liệu và kiểm soát thiết bị.

Cụ thể, Hunt.io đã tài liệu hóa các khả năng sau cho phiên bản ERMAC mới nhất:

* Đánh cắp SMS, danh bạ và tài khoản đã đăng ký
* Trích xuất chủ đề và tin nhắn Gmail
* Truy cập tệp thông qua các lệnh 'list' và 'download'
* Gửi SMS và chuyển tiếp cuộc gọi để lạm dụng giao tiếp
* Chụp ảnh qua camera trước
* Quản lý ứng dụng đầy đủ (khởi chạy, gỡ cài đặt, xóa bộ nhớ cache)
* Hiển thị thông báo đẩy giả để lừa đảo
* Gỡ cài đặt từ xa (killme) để né tránh

## Cơ sở hạ tầng bị phơi bày

Các nhà phân tích từ Hunt.io đã sử dụng các truy vấn SQL để xác định cơ sở hạ tầng đang hoạt động, bị phơi bày mà các tác nhân đe dọa hiện đang sử dụng, xác định các điểm cuối C2, bảng điều khiển, máy chủ exfiltration, và triển khai bộ tạo.

![Máy chủ C2 ERMAC bị phơi bày](https://www.bleepstatic.com/images/news/u/1220909/2025/August/c2-servers.jpg)

**Máy chủ C2 ERMAC bị phơi bày**  
_Nguồn: Hunt.io_

Ngoài việc phơi bày mã nguồn của malware, các nhà điều hành ERMAC đã có một số sai lầm lớn về opsec, bao gồm các token JWT cứng mã, thông tin đăng nhập root mặc định, và không có bảo vệ đăng ký trên bảng điều khiển quản trị, cho phép bất kỳ ai cũng có thể truy cập, thao tác, hoặc làm gián đoạn các bảng điều khiển ERMAC.

Cuối cùng, tên bảng điều khiển, tiêu đề, tên gói và các dấu vết vận hành khác để lại ít nghi ngờ về sự quy trách nhiệm và làm cho việc phát hiện và lập bản đồ cơ sở hạ tầng trở nên dễ dàng hơn rất nhiều.

**Truy cập bảng điều khiển ERMAC**  
_Nguồn: Hunt.io_

Rò rỉ mã nguồn ERMAC V3.0 làm suy yếu hoạt động của malware, trước tiên là làm suy giảm niềm tin của khách hàng vào MaaS về khả năng bảo vệ thông tin khỏi cơ quan thực thi pháp luật hoặc cho phép thực hiện các chiến dịch với rủi ro phát hiện thấp.

Các giải pháp phát hiện mối đe dọa cũng có khả năng cải thiện khả năng phát hiện ERMAC. Tuy nhiên, nếu mã nguồn rơi vào tay các tác nhân đe dọa khác, có khả năng trong tương lai sẽ quan sát thấy các biến thể sửa đổi của ERMAC khó phát hiện hơn.