# Nghiên cứu viên chuẩn bị phát hành exploit cho việc bỏ qua xác thực hoàn toàn trên FortiWeb

![Fortinet](https://www.bleepstatic.com/content/hl-images/2024/02/09/Fortinet.jpg)

Một nhà nghiên cứu bảo mật đã phát hành một phần khai thác proof of concept cho một lỗ hổng trong tường lửa ứng dụng web FortiWeb cho phép kẻ tấn công từ xa bỏ qua xác thực.

Lỗi này đã được báo cáo một cách có trách nhiệm tới Fortinet và hiện đang được theo dõi là CVE-2025-52970\. Fortinet đã phát hành bản sửa lỗi vào ngày 12 tháng 8.

Nhà nghiên cứu bảo mật [Aviv Y](https://x.com/0x%5Fshaq) đã đặt tên cho lỗ hổng này là FortMajeure và mô tả nó như một "sự cố im lặng không đáng xảy ra." Về mặt kỹ thuật, đây là đọc ngoài biên trong việc phân tích cookie của FortiWeb cho phép kẻ tấn công thiết lập tham số Era thành một giá trị không mong muốn.

Điều này khiến máy chủ sử dụng một khóa bí mật toàn số không cho việc mã hóa phiên và ký HMAC, làm cho việc tạo cookie xác thực giả mạo trở nên dễ dàng.

Khai thác lỗ hổng dẫn đến việc bỏ qua xác thực hoàn toàn, cho phép kẻ tấn công mạo danh bất kỳ người dùng hoạt động nào, bao gồm cả quản trị viên.

Để khai thác CVE-2025-52970 thành công, người dùng mục tiêu phải có một phiên hoạt động trong quá trình tấn công, và kẻ thù phải brute-force một trường số nhỏ trong cookie.

Yêu cầu brute-forcing đến từ một trường trong cookie đã ký, được xác thực bởi hàm refresh_total_logins() (trong libncfg.so).

Trường này là một số không xác định mà kẻ tấn công phải đoán, nhưng nhà nghiên cứu lưu ý rằng phạm vi của nó thường không vượt quá 30, tạo thành một không gian tìm kiếm nhỏ khoảng 30 yêu cầu.

Bởi vì khai thác sử dụng khóa toàn số không (do lỗi Era), mỗi lần đoán có thể được kiểm tra ngay lập tức bằng cách xem cookie giả mạo có được chấp nhận hay không.

Vấn đề này ảnh hưởng đến FortiWeb phiên bản 7.0 đến 7.6, và đã được sửa ở các phiên bản dưới đây:

* FortiWeb 7.6.4 và các phiên bản sau
* FortiWeb 7.4.8 và các phiên bản sau
* FortiWeb 7.2.11 và các phiên bản sau
* FortiWeb 7.0.11 và các phiên bản sau

Fortinet [cho biết trong bản thông báo](https://www.fortiguard.com/psirt/FG-IR-25-448) rằng các bản phát hành FortiWeb 8.0 không bị ảnh hưởng bởi vấn đề này, vì vậy không cần thực hiện biện pháp nào ở đó.

Bản thông cáo bảo mật không liệt kê bất kỳ giải pháp hoặc khuyến nghị giảm thiểu nào, vì vậy việc nâng cấp lên phiên bản an toàn được coi là biện pháp hiệu quả duy nhất được khuyến nghị.

Điểm nghiêm trọng CVSS của Fortinet là 7.7 có thể gây hiểu lầm, vì nó dựa trên “độ phức tạp tấn công cao” do yêu cầu brute-forcing. Tuy nhiên, trong thực tế, phần brute-forcing là đơn giản và nhanh chóng thực hiện.

Nhà nghiên cứu [đã chia sẻ đầu ra PoC](https://pwner.gg/blog/2025-08-13-fortiweb-cve-2025-52970), cho thấy sự mạo danh quản trị viên trên một điểm cuối REST. Tuy nhiên, anh đã giữ lại khai thác hoàn chỉnh mà cũng bao gồm việc kết nối với FortiWeb CLI qua /ws/cli/open.

![Khai thác được phát hành bởi nhà nghiên cứu](https://www.bleepstatic.com/images/news/u/1220909/2025/August/2.jpg)

**Khai thác được phát hành bởi nhà nghiên cứu**  
_Credit: Aviv Y_

Tuy nhiên, Aviv Y hứa hẹn sẽ công bố chi tiết khai thác hoàn chỉnh sau, vì thông báo của nhà cung cấp chỉ vừa được phát hành gần đây. Nhà nghiên cứu đã đưa ra quyết định này để cho các quản trị viên hệ thống có thêm thời gian áp dụng bản sửa lỗi.

Các chi tiết được công bố cho thấy cốt lõi của vấn đề nhưng không đủ cho ngay cả những kẻ tấn công am hiểu để suy luận phần còn lại và phát triển một chuỗi vũ khí hoàn chỉnh, nhà nghiên cứu nói với BleepingComputer.

Ông giải thích rằng các kẻ tấn công sẽ phải đảo ngược kỹ thuật định dạng của các trường trong phiên, điều này không thực tế vì Fortinet có cấu trúc dữ liệu riêng của mình.

Dù vậy, cần phải thực hiện hành động ngay lập tức để giảm thiểu vấn đề vì các hacker theo dõi những thông báo này và chuẩn bị sẵn sàng khi các PoC hoàn chỉnh được phát hành.

Aviv Y cho biết với BleepingComputer rằng ông chưa quyết định ngày công bố khai thác nhưng có kế hoạch cho các bên phòng thủ có thời gian phản ứng với rủi ro.