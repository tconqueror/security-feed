# Những hacker APT36 lạm dụng file .desktop của Linux để cài đặt malware

![Linux](https://www.bleepstatic.com/content/hl-images/2023/06/22/Linux.jpg)

Các gián điệp mạng APT36 từ Pakistan đang sử dụng các file .desktop của Linux để tải malware trong các cuộc tấn công mới nhằm vào các thực thể chính phủ và quốc phòng tại Ấn Độ.

Hoạt động này, được tài liệu hóa trong các báo cáo của [CYFIRMA](https://www.cyfirma.com/research/apt36-targets-indian-boss-linux-systems-with-weaponized-autostart-files/) và [CloudSEK](https://www.cloudsek.com/blog/investigation-report-apt36-malware-campaign-using-desktop-entry-files-and-google-drive-payload-delivery), nhằm mục đích thu thập dữ liệu và truy cập gián điệp liên tục. APT 36 đã [trước đây sử dụng file .desktop](https://www.zscaler.com/blogs/security-research/peek-apt36-s-updated-arsenal#brief-overview) để tải malware trong các hoạt động gián điệp có mục tiêu ở Nam Á.

Các cuộc tấn công được phát hiện lần đầu vào ngày 1 tháng 8 năm 2025, và dựa trên bằng chứng mới nhất, vẫn đang tiếp diễn.

## Lợi dụng file desktop

Mặc dù các cuộc tấn công được mô tả trong hai báo cáo sử dụng cơ sở hạ tầng và mẫu khác nhau (dựa trên hàm băm), nhưng các kỹ thuật, chiến thuật và quy trình (TTP), chuỗi tấn công, và mục tiêu rõ ràng là như nhau.

Nạn nhân nhận được các tệp ZIP qua email lừa đảo chứa một file .desktop độc hại được ngụy trang thành tài liệu PDF và được đặt tên tương ứng.

Các file .desktop của Linux là các trình khởi động ứng dụng dựa trên văn bản, chứa các tùy chọn cấu hình chỉ đạo cách mà môi trường desktop nên hiển thị và chạy một ứng dụng.

Người dùng mở file .desktop nghĩ rằng nó là một PDF, điều này dẫn đến việc một lệnh bash ẩn trong trường 'Exec=' tạo ra một tên file tạm thời trong '/tmp/' nơi nó ghi một payload đã được mã hóa theo dạng hex được lấy từ máy chủ của kẻ tấn công hoặc Google Drive.

Sau đó, nó thực hiện 'chmod +x' để làm cho nó có thể thực thi và khởi động nó ở chế độ nền.

Để giảm nghi ngờ cho nạn nhân, script cũng khởi động Firefox để hiển thị một file PDF giả vô hại được lưu trữ trên Google Drive.

![Mẫu của một PDF giả được sử dụng trong các cuộc tấn công](https://www.bleepstatic.com/images/news/u/1220909/2025/August/decoy.jpg)

**Mẫu của một PDF giả được sử dụng trong các cuộc tấn công**  
_Nguồn: CloudSEK_

Ngoài việc thao tác trường 'Exec=' để chạy một chuỗi các lệnh shell, những kẻ tấn công cũng thêm các trường như 'Terminal=false' để ẩn cửa sổ terminal khỏi người dùng, và 'X-GNOME-Autostart-enabled=true' để chạy file này tại mỗi lần đăng nhập.

![Một file desktop độc hại](https://www.bleepstatic.com/images/news/u/1220909/2025/August/desktop.jpg)

**Một file desktop độc hại**  
_Nguồn: CloudSEK_

Thông thường, các file .desktop trên Linux là các tệp lối tắt dạng văn bản, xác định một biểu tượng, tên, và lệnh để thực hiện khi người dùng nhấp vào nó.

Tuy nhiên, trong các cuộc tấn công của APT36, những kẻ tấn công lợi dụng cơ chế khởi động này để chuyển đổi nó thành một công cụ tải malware và hệ thống thiết lập sự tồn tại, tương tự như cách mà các lối tắt 'LNK' bị lợi dụng trên Windows.

Bởi vì các file .desktop trên Linux thường là văn bản, không phải nhị phân, và việc lạm dụng của chúng không được tài liệu hóa rộng rãi, các công cụ bảo mật trên nền tảng này không có khả năng giám sát chúng như những mối đe dọa tiềm tàng.

Payload được thả bởi file .desktop bị biến dạng trong trường hợp này là một file thực thi ELF dựa trên Go thực hiện các chức năng gián điệp.

Mặc dù việc đóng gói và làm khó hiểu đã làm cho việc phân tích trở nên khó khăn, các nhà nghiên cứu đã phát hiện ra rằng nó có thể được thiết lập để ẩn mình, hoặc cố gắng thiết lập sự tồn tại riêng biệt của nó bằng cách sử dụng cron jobs và dịch vụ systemd.

Giao tiếp với C2 được thực hiện thông qua một kênh WebSocket hai chiều, cho phép thu thập dữ liệu và thực thi lệnh từ xa.

**Tổng quan về cuộc tấn công**  
_Nguồn: CloudSEK_

Cả hai công ty an ninh mạng đều nhận thấy chiến dịch mới nhất này là dấu hiệu cho sự tiến hóa về chiến thuật của APT36, đang trở nên tinh vi và khó phát hiện hơn.