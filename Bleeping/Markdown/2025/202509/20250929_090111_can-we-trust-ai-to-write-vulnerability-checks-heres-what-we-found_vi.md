# Chúng ta có thể tin tưởng AI để viết các kiểm tra lỗ hổng không? Đây là những gì chúng tôi tìm thấy

![Intruder AI](https://www.bleepstatic.com/content/posts/2025/09/26/trust-ai-header.jpg)

Quản lý lỗ hổng luôn là một cuộc đua. Kẻ tấn công di chuyển nhanh, các bản quét mất thời gian, và nếu scanner của bạn không theo kịp, bạn sẽ bị phơi bày.

Đó là lý do tại sao [Intruder’s](https://www.intruder.io?utm%5Fsource=bleepingcomputer&utm%5Fmedium=p%5Freferral&utm%5Fcampaign=global%7Cfixed%7Cai%5Fresearch) nhóm bảo mật đã khởi động một dự án nghiên cứu: liệu AI có thể giúp chúng tôi xây dựng các kiểm tra lỗ hổng mới nhanh hơn, mà không làm giảm tiêu chuẩn chất lượng cao của chúng tôi không?

Rốt cuộc, tốc độ chỉ có ích khi các phát hiện là đáng tin cậy — một kiểm tra báo dương giả (hoặc tệ hơn, bỏ sót vấn đề thực sự) không giúp được ai cả.

Trong bài viết này, chúng tôi sẽ chia sẻ cách chúng tôi đã thử nghiệm với AI, những gì hoạt động tốt, và nơi nó còn hạn chế.

## Một lần thử so với phương pháp theo tác nhân (agentic)

Chúng tôi bắt đầu đơn giản: đưa prompt vào một chatbot LLM và xem nó có thể viết các Nuclei templates không. Kết quả lộn xộn. Các đầu ra tham chiếu đến các tính năng không tồn tại, sinh ra cú pháp không hợp lệ, và dùng các matcher và extractor yếu. Điều này xảy ra nhất quán trên ChatGPT, Claude, và Gemini.

Vì vậy chúng tôi thử phương pháp có tác nhân. Khác với chatbot, một agent có thể sử dụng công cụ, tìm kiếm tài liệu tham khảo, và tuân theo quy tắc. Chúng tôi bước vào với sự hoài nghi lành mạnh (những thảm họa “vibe coding” gần đây không tạo niềm tin), nhưng sự cải thiện là ngay lập tức.

Chúng tôi dùng agent của [Cursor’s](https://cursor.com/), và rất nhanh thấy rằng với các prompt tối thiểu, chất lượng đầu ra từ các lần chạy ban đầu hứa hẹn hơn nhiều.

Từ đó, chúng tôi thêm các quy tắc và lập chỉ mục một kho mẫu Nuclei được tuyển chọn. Điều này cung cấp cho agent các ví dụ chắc chắn để học theo, giảm sự không nhất quán, và khuyến khích nó sử dụng chức năng đúng. Chất lượng các template tăng rõ rệt và gần hơn nhiều với những gì chúng tôi mong đợi từ các kỹ sư của mình.

Nhưng không phải để mặc và quên. Nếu để một mình, agent vẫn cần điều chỉnh hướng. Với prompt rõ ràng, tuy nhiên, nó có thể sinh các kiểm tra trông giống như đã được viết thủ công.

Đó là lúc mục tiêu của chúng tôi thay đổi: không phải tự động hóa hoàn toàn, mà là một công cụ tăng năng suất giúp chúng tôi phát hành các kiểm tra chất lượng nhanh hơn mà không hạ thấp tiêu chuẩn.

## [Chìm trong số lượng lỗ hổng? GregAI ném cho bạn một phao cứu sinh.](https://www.intruder.io/platform/ai-security-analyst?utm%5Fsource=bleepingcomputer&utm%5Fmedium=p%5Freferral&utm%5Fcampaign=global%7Cfixed%7Cai%5Fresearch)

Các tồn đọng không có cơ hội. GregAI, đồng minh bảo mật AI của bạn, cắt giảm nhiễu bằng cách ưu tiên những gì quan trọng, xác thực các vấn đề, và thậm chí viết báo cáo cho bạn. Ít vất vả hơn, nhiều thời gian hơn.

Hàng nghìn người đã tin tưởng Intruder - tại sao bạn không thử?

[Tìm hiểu thêm](https://www.intruder.io/platform/ai-security-analyst?utm%5Fsource=bleepingcomputer&utm%5Fmedium=p%5Freferral&utm%5Fcampaign=global%7Cfixed%7Cai%5Fresearch)

### Quy trình làm việc hiện tại của chúng tôi

Quy trình mà chúng tôi đã định hình (tạm thời) sử dụng một bộ prompt và quy tắc tiêu chuẩn. Kỹ sư cung cấp các đầu vào chính, chẳng hạn như:

* Các trang cần truy cập
* Loại matcher để sử dụng (nếu có)
* Dữ liệu chính cần trích xuất cho kết quả quét lỗ hổng

Với những thứ đó, agent xây dựng template. Nó không hoàn toàn “vibe-coded,” nhưng nhanh hơn nhiều và giải phóng các kỹ sư của chúng tôi dành thời gian nhiều hơn cho nghiên cứu sâu hơn.

## Thành công

### Kiểm tra bề mặt tấn công

Agentic AI đặc biệt hữu ích để tạo các kiểm tra khi không có template công khai nào tồn tại. Một điểm ngọt: phát hiện các admin panel bị lộ ra internet. Những kiểm tra này đơn giản về nguyên tắc, nhưng viết chúng ở quy mô lớn tốn thời gian. Với tự động hóa, chúng tôi có thể sản xuất nhiều hơn, nhanh hơn.

Chúng tôi thường ngạc nhiên về số sản phẩm không được các scanner lớn mà chúng tôi dùng tích hợp sẵn bao phủ. Quy trình này giúp chúng tôi lấp các khoảng trống đó và cung cấp cho khách hàng cái nhìn đầy đủ hơn về bề mặt tấn công của họ. Bởi nếu scanner VM của bạn không đánh dấu các panel bị phơi bày — và hệ thống của bạn lớn — có khả năng bạn sẽ không biết chúng tồn tại.

### Elasticsearch không được bảo vệ

Chúng tôi tạo một kiểm tra Elasticsearch không được bảo vệ như một chiến thắng nhanh cho workflow theo tác nhân. Đã có một Nuclei detection template công khai, nhưng nó không bao phủ trường hợp tồi nhất: các instance bị để mở hoàn toàn nơi bất kỳ ai cũng có thể đọc dữ liệu. Đó là trường hợp chúng tôi muốn phát hiện một cách đáng tin cậy.

Những gì chúng tôi cung cấp cho agent:

* Nhiệm vụ trong 2-3 câu ngắn — ví dụ phát hiện instance Elasticsearch, thực hiện một yêu cầu tới endpoint X và sau đó một yêu cầu theo dõi tới endpoint Y để xem dữ liệu thực sự có bị phơi bày hay không.
* Một danh sách các mục tiêu thử nghiệm đang host các server Elasticsearch
* Một mục tiêu ví dụ có lỗ hổng theo phương pháp mà chúng tôi muốn kiểm thử
* Một mục tiêu ví dụ không có lỗ hổng

Agent sau đó lặp qua quy trình của chúng tôi sử dụng các quy tắc tùy chỉnh mà chúng tôi đặt.

Kết quả cuối cùng là một Nuclei template liệt kê các nguồn dữ liệu và theo dõi các endpoint hứa hẹn để xác nhận xem người dùng không xác thực có thể đọc dữ liệu hay không — một template đa-yêu-cầu với matcher và extractor hoạt động phù hợp cho quét tự động.

Vẫn có sự nhập tay và phán đoán thủ công từ nhóm kỹ sư bảo mật của chúng tôi, nhưng agent xử lý phần việc lặp đi lặp lại nặng nề.

## Thách thức

Khám phá của chúng tôi cho đến nay không thiếu các chướng ngại và suy nghĩ lại.

### Giới hạn của các đầu ra hiện tại

Ngay cả với quy tắc, agent đôi khi lạc hướng. Một ví dụ: nó tạo một kiểm tra cho một admin panel bị phơi bày nhưng không bao gồm matcher đủ mạnh, điều này làm tăng rủi ro dương giả. Một prompt bổ sung nhanh đã sửa được — chúng tôi thêm một matcher favicon độc nhất cho sản phẩm đó — nhưng đó là nhắc nhở rằng agent vẫn cần các hàng rào bảo vệ. Cho đến khi nó có thể đáng tin cậy chọn matcher mạnh nhất và xác thực chúng, giám sát của con người vẫn là điều thiết yếu.

### Kết quả curl bị cắt bớt

Cursor thường chuyển các phản hồi ‘curl’ qua ‘head’ để tiết kiệm token. Thật không may, điều này có thể bỏ lỡ các định danh duy nhất mà sẽ là matcher lý tưởng. Đây là một tính năng tối ưu hiệu suất, nhưng điều đó lại chống lại chúng tôi và chúng tôi chưa giải quyết triệt để.

### Quên những điều cơ bản

Đôi khi Cursor bỏ qua chính các flag của Nuclei, như -l để chạy với danh sách host, và thay vào đó viết script vòng lặp thủ công. Chúng tôi đang làm việc trên các quy tắc mới để nhắc nó về các tính năng chính của Nuclei và loại bỏ sự kém hiệu quả đó.

## Tiếp theo là gì?

AI đang được quảng bá khắp nơi như một viên đạn bạc để thay thế hoàn toàn các tác vụ phức tạp. Theo quan điểm của chúng tôi, phần lớn là cường điệu tiếp thị. Chúng tôi còn một chặng đường dài trước khi giao toàn bộ kỹ thuật bảo mật cho một agent AI mà không có giám sát chặt chẽ.

Điều đó không có nghĩa là điều đó là không thể, nhưng hiện tại chúng tôi thận trọng với bất kỳ ai tuyên bố tự động hóa hoàn toàn. Chúng tôi sẽ tiếp tục thúc đẩy AI trong quản lý lỗ hổng, cả như một công cụ tăng năng suất và, khi có thể, hướng tới tự động hóa an toàn.

Nhưng kết luận rõ ràng hôm nay là: để cung cấp các kiểm tra tùy chỉnh chất lượng cao mà không bỏ sót lỗ hổng hoặc tạo dương giả, các kỹ sư chuyên gia vẫn là điều thiết yếu.

_Author bio: Benjamin Marr, Security Engineer at Intruder_

_Ben is a Security Engineer at Intruder, where he automates offensive security scanning and carries out security research. His background is as an OSWE certified penetration tester and PHP software engineer._

_Sponsored and written by [Intruder](https://www.intruder.io?utm%5Fsource=bleepingcomputer&utm%5Fmedium=p%5Freferral&utm%5Fcampaign=global%7Cfixed%7Cai%5Fresearch)._