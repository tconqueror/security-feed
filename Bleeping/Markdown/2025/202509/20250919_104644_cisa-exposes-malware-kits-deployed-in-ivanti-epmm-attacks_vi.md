# CISA tiết lộ bộ công cụ phần mềm độc hại được triển khai trong các cuộc tấn công Ivanti EPMM

![CISA tiết lộ bộ công cụ phần mềm độc hại được triển khai trong các cuộc tấn công Ivanti EPMM](https://www.bleepstatic.com/content/hl-images/2024/07/12/hacker.jpg)

CISA đã công bố một phân tích về phần mềm độc hại được triển khai trong các cuộc tấn công khai thác lỗ hổng ảnh hưởng đến Ivanti Endpoint Manager Mobile (EPMM).

Các lỗ hổng là một bypass xác thực trong thành phần API của EPMM (CVE-2025-4427) và một lỗ hổng chèn mã (CVE-2025-4428) cho phép thực thi mã tuỳ ý.

Hai lỗ hổng ảnh hưởng đến các nhánh phát triển Ivanti EPMM sau đây và các phát hành trước đó của chúng: 11.12.0.4, 12.3.0.1, 12.4.0.1 và 12.5.0.0.

Ivanti đã khắc phục các vấn đề vào ngày 13 tháng 5, nhưng các tác nhân đe doạ đã [khai thác chúng như zero days](https://www.bleepingcomputer.com/news/security/ivanti-fixes-epmm-zero-days-chained-in-code-execution-attacks/) trong các cuộc tấn công nhằm vào “một số rất hạn chế khách hàng.”

Khoảng một tuần sau, nền tảng tình báo mối đe doạ EclecticIQ [báo cáo với mức độ tin cậy cao](https://www.bleepingcomputer.com/news/security/ivanti-epmm-flaw-exploited-by-chinese-hackers-to-breach-govt-agencies/) rằng một nhóm gián điệp có liên hệ với China đã tận dụng hai lỗ hổng này từ ít nhất ngày 15 tháng 5.

Các nhà nghiên cứu cho biết rằng tác nhân liên kết Trung Quốc rất am hiểu kiến trúc nội bộ của Ivanti EPMM, có khả năng tái sử dụng các thành phần hệ thống để trộm xuất dữ liệu.

Tuy nhiên, báo cáo của CISA không đưa ra bất kỳ phân bổ trách nhiệm nào và chỉ tập trung vào các chi tiết kỹ thuật của các tập tin độc hại thu được từ một tổ chức bị tấn công bởi các tác nhân đe doạ sử dụng một chuỗi khai thác cho CVE-2025-4427 và CVE-2025-4428.

### Phân phối phần mềm độc hại tách rời

Cơ quan Mỹ đã phân tích hai bộ phần mềm độc hại gồm năm tệp mà những kẻ tấn công đã sử dụng để có được quyền truy cập ban đầu vào các hệ thống Ivanti EPMM on-premise.

“Tác nhân đe doạ mạng nhắm vào endpoint _/mifs/rs/api/v2/_ bằng các yêu cầu HTTP GET và sử dụng tham số _?format=_ để gửi các lệnh từ xa độc hại,” CISA [nói](https://www.cisa.gov/news-events/analysis-reports/ar25-261a).

Các lệnh cho phép tác nhân đe doạ thực hiện hoạt động trinh sát bằng cách thu thập thông tin hệ thống, liệt kê thư mục gốc, lập bản đồ mạng, lấy các tệp độc hại và trích xuất thông tin đăng nhập Lightweight Directory Access Protocol (LDAP).

Mỗi bộ phần mềm độc hại được phân tích bao gồm một loader riêng biệt nhưng với cùng tên, và các listener độc hại cho phép chèn và chạy mã tuỳ ý trên hệ thống bị xâm phạm:

* **Bộ 1**:  
   * _web-install.jar_ (Loader 1)  
   * _ReflectUtil.class_ \- được bao gồm trong Loader 1, thao tác các đối tượng Java để chèn và quản lý listener độc hại trong bộ  
   * _SecurityHandlerWanListener.class_ \- listener độc hại có thể được sử dụng để chèn và thực thi mã trên máy chủ, để trộm xuất dữ liệu và thiết lập persistence
* **Bộ 2**:  
   * _web-install.jar_ (Loader 2)  
   * _WebAndroidAppInstaller.class_ \- một listener độc hại trong Loader 2, mà tác nhân đe doạ có thể sử dụng để chèn và thực thi mã, tạo persistence và trộm xuất dữ liệu

Theo CISA, tác nhân đe doạ đã chuyển phần mềm độc hại thông qua các yêu cầu HTTP GET riêng biệt trong các đoạn mã hóa Base64 phân đoạn.

Hai bộ phần mềm độc hại riêng biệt hoạt động tương tự nhau, chặn các yêu cầu HTTP cụ thể để giải mã và chạy các payload do kẻ tấn công cung cấp.

CISA đã cung cấp các chỉ số xâm phạm (IOCs) chi tiết, quy tắc YARA và một quy tắc SIGMA để giúp các tổ chức phát hiện các cuộc tấn công như vậy.

Khuyến nghị của cơ quan đối với các công ty tìm thấy phần mềm độc hại được phân tích hoặc các tệp tương tự trên hệ thống của họ là cách ly các host bị ảnh hưởng, thu thập và xem xét các artifact, và tạo một ảnh đĩa pháp y đầy đủ để chia sẻ với CISA.

Là hành động giảm thiểu, CISA khuyến nghị vá ngay Ivanti EPMM bị ảnh hưởng và coi hệ thống quản lý thiết bị di động (MDM) là tài sản có giá trị cao (HVA) cần các hạn chế bảo mật và giám sát bổ sung.