# Microsoft cảnh báo biến thể mới của phần mềm độc hại XCSSET trên macOS nhắm mục tiêu các nhà phát triển Xcode

![macOS](https://www.bleepstatic.com/content/hl-images/2021/10/22/Apple_Finder_Mac__headpic.jpg)

Microsoft Threat Intelligence báo cáo rằng một biến thể mới của phần mềm độc hại XCSSET trên macOS đã được phát hiện trong các cuộc tấn công hạn chế, tích hợp một số tính năng mới, bao gồm nhắm mục tiêu trình duyệt được cải thiện, chiếm dụng clipboard và cơ chế duy trì (persistence) được nâng cao.

XCSSET là phần mềm độc hại trên macOS có cấu trúc mô-đun hoạt động như một infostealer và kẻ đánh cắp tiền điện tử, đánh cắp Notes, ví tiền điện tử và dữ liệu trình duyệt từ các thiết bị bị lây nhiễm. Phần mềm độc hại lây lan bằng cách tìm kiếm và nhiễm các dự án Xcode khác có trên thiết bị, sao cho phần mềm độc hại được thực thi khi dự án được build.

"Phần mềm độc hại XCSSET được thiết kế để lây nhiễm các dự án Xcode, thường được sử dụng bởi các nhà phát triển phần mềm, và chạy trong khi một dự án Xcode đang được build," Microsoft giải thích.

"Chúng tôi đánh giá rằng phương thức lây nhiễm và lan truyền này dựa trên việc các tệp dự án được chia sẻ giữa các nhà phát triển đang xây dựng các ứng dụng liên quan đến Apple hoặc macOS."

Trong một biến thể mới được Microsoft quan sát, các nhà nghiên cứu đã ghi nhận một số thay đổi.

Nó hiện cố gắng đánh cắp dữ liệu trình duyệt Firefox bằng cách cài đặt một build đã được sửa đổi của công cụ mã nguồn mở [HackBrowserData](https://github.com/moonD4rk/HackBrowserData/tree/main), công cụ được dùng để giải mã và xuất dữ liệu trình duyệt từ các kho dữ liệu trình duyệt.

Biến thể mới cũng bao gồm một bản cập nhật thành phần chiếm dụng clipboard, giám sát clipboard của macOS để tìm các mẫu biểu thức chính quy liên quan đến địa chỉ tiền điện tử.

Khi phát hiện một địa chỉ tiền điện tử, nó sẽ thay thế địa chỉ đó bằng một địa chỉ thuộc về kẻ tấn công. Điều này khiến bất kỳ khoản tiền điện tử nào được gửi bởi người dùng trên thiết bị bị nhiễm sẽ được gửi cho kẻ tấn công thay vì người nhận dự định.

![Attacker's cryptocurrency addresses used with the Clipboard hijacker](https://www.bleepstatic.com/images/news/security/x/xcsset/crypto-address-xcsset.jpg)

**Địa chỉ tiền điện tử của kẻ tấn công được sử dụng với công cụ chiếm dụng Clipboard**  
_Source: Microsoft_

Phần mềm độc hại cũng bao gồm các phương thức duy trì mới, chẳng hạn như tạo các mục LaunchDaemon thực thi một payload ~/.root và tạo một System Settings.app giả trong /tmp để ngụy trang hoạt động của nó.

Biến thể mới hiện chưa lan rộng, và Microsoft báo cáo rằng họ chỉ quan sát thấy nó trong các cuộc tấn công hạn chế. Các nhà nghiên cứu cũng đã chia sẻ phát hiện của họ với Apple và đang làm việc với GitHub để xóa các repository liên quan.

Để bảo vệ chống lại loại phần mềm độc hại này, khuyến nghị giữ macOS và ứng dụng luôn được cập nhật, nhất là khi XCSSET trước đây đã khai thác các lỗ hổng, bao gồm các lỗ hổng zero-day.

Microsoft cũng khuyến nghị rằng các nhà phát triển luôn kiểm tra các dự án Xcode trước khi build chúng, đặc biệt khi các dự án đó được người khác chia sẻ cho bạn.