# Google: Phần mềm độc hại Brickstone được sử dụng để đánh cắp dữ liệu của các tổ chức U.S. trong hơn một năm

![Google: Phần mềm độc hại Brickstone được sử dụng để đánh cắp dữ liệu của các tổ chức U.S. trong hơn một năm](https://www.bleepstatic.com/content/hl-images/2025/05/28/China.jpg)

Những kẻ tấn công tình nghi có liên quan đến Trung Quốc đã sử dụng phần mềm độc hại Brickstorm trong các chiến dịch gián điệp có tính bền bỉ kéo dài nhằm vào các tổ chức ở U.S. trong các lĩnh vực công nghệ và pháp lý.

Brickstorm là một backdoor viết bằng Go [documented by Google](https://cloud.google.com/blog/topics/threat-intelligence/ivanti-post-exploitation-lateral-movement) vào tháng 4 năm 2024 sau những vụ xâm nhập liên quan đến Trung Quốc bắt nguồn từ nhiều thiết bị edge khác nhau và trung bình đã không bị phát hiện trong môi trường nạn nhân hơn một năm.

Phần mềm độc hại này hoạt động như một máy chủ web, công cụ thao tác tệp, dropper, SOCKS relay và công cụ thực thi lệnh shell.

Theo [Google Threat Intelligence Group](https://cloud.google.com/blog/topics/threat-intelligence/brickstorm-espionage-campaign) (GTIG), các kẻ tấn công đã sử dụng Brickstorm để lặng lẽ rút dữ liệu từ mạng của nạn nhân với thời gian lưu trú trung bình là 393 ngày trước khi bị phát hiện.

Các nhà nghiên cứu xác nhận tổ chức bị xâm nhập thuộc các lĩnh vực pháp lý và công nghệ, các nhà cung cấp phần mềm như một dịch vụ (SaaS), và cả Business Process Outsourcers (BPOs).

Google lưu ý rằng việc xâm nhập những thực thể như vậy có thể giúp một tác nhân đe dọa phát triển khai thác zero-day và mở rộng cuộc tấn công sang các nạn nhân hạ nguồn, đặc biệt là những tổ chức không được bảo vệ bởi các giải pháp endpoint detection and response (EDR).

Các nhà nghiên cứu quy những cuộc tấn công này cho cụm hoạt động UNC5221, nổi tiếng với việc khai thác các zero-days của Ivanti để [tấn công các cơ quan chính phủ](https://www.bleepingcomputer.com/news/security/ivanti-epmm-flaw-exploited-by-chinese-hackers-to-breach-govt-agencies/) bằng phần mềm độc hại tùy chỉnh như [Spawnant](https://www.bleepingcomputer.com/news/security/google-chinese-hackers-likely-behind-ivanti-vpn-zero-day-attacks/) và [Zipline](https://www.bleepingcomputer.com/news/security/ivanti-connect-secure-zero-days-exploited-to-deploy-custom-malware/).

## Hoạt động của Brickstorm

Do thời gian lưu trú dài trên hệ thống nạn nhân và việc UNC5221 sử dụng các script chống pháp y để che mờ đường xâm nhập, GTIG không thể xác định tự tin vector truy cập ban đầu, nhưng các nhà nghiên cứu tin rằng việc khai thác zero-days trên các thiết bị edge có liên quan.

Brickstorm được triển khai trên các appliance không hỗ trợ EDR, bao gồm VMware vCenter/ESXi endpoints, nơi nó thiết lập liên lạc với command and control (C2) trong khi giả mạo trao đổi thành lưu lượng hợp pháp như Cloudflare, Heroku và các lưu lượng khác.

Sau khi tạo được chỗ đứng, kẻ tấn công cố gắng leo thang đặc quyền bằng cách sử dụng một Java Servlet Filter độc hại (Bricksteal) trên vCenter để thu thập thông tin xác thực, cũng như sao chép các VM Windows Server để trích xuất bí mật.

Các thông tin xác thực bị đánh cắp sau đó được sử dụng cho di chuyển ngang và duy trì bền bỉ, bao gồm bật SSH trên ESXi và chỉnh sửa các script khởi động init.d và systemd.

Mục tiêu vận hành chính của Brickstorm là rút dữ liệu email qua Microsoft Entra ID Enterprise Apps, tận dụng SOCKS proxy của nó để tunnel vào hệ thống nội bộ và kho mã nguồn, duy trì mức độ tàng hình cao.

Các quan sát của Google cho thấy UNC5221 tập trung mạnh vào các nhà phát triển, quản trị viên và những cá nhân liên quan đến lợi ích kinh tế và an ninh của Trung Quốc.

Khi chiến dịch hoàn tất, phần mềm độc hại được gỡ bỏ để cản trở các cuộc điều tra pháp y. Điều này càng trở nên phức tạp khi UNC5221 không bao giờ sử dụng lại cùng một tên miền C2 hoặc các mẫu phần mềm độc hại.

Để giúp các bên phòng thủ, Mandiant đã [phát hành một script quét miễn phí](https://github.com/mandiant/brickstorm-scanner) mô phỏng một quy tắc YARA cho Brickstorm trên appliance Linux và BSD. Các quy tắc YARA cho Bricksteal và Slaystyle cũng được bao gồm trong báo cáo.

Mandiant cảnh báo rằng trình quét của họ có thể không phát hiện mọi biến thể của Brickstorm, không đảm bảo phát hiện xâm phạm 100% thời gian, không tìm kiếm các cơ chế duy trì bền bỉ và không cảnh báo về các thiết bị dễ bị tổn thương.