# Gói NPM bị phát hiện sử dụng QR Code để tải phần mềm độc hại đánh cắp cookie

![npm](https://www.bleepstatic.com/content/hl-images/2022/07/05/NPM_headpic.jpg)

Một gói npm mới phát hiện có tên 'fezbox' sử dụng QR code để lấy phần mềm độc hại đánh cắp cookie từ máy chủ của tác nhân đe dọa.

Gói này, ngụy trang như một thư viện tiện ích, lợi dụng kỹ thuật tàng hình sáng tạo này để thu thập dữ liệu nhạy cảm, chẳng hạn như thông tin đăng nhập của người dùng, từ một máy bị xâm nhập.

## QR codes lại tìm thấy một trường hợp sử dụng khác

Trong khi mã vạch 2D như QR code truyền thống được thiết kế cho con người để chứa nội dung tiếp thị hoặc chia sẻ liên kết, các kẻ tấn công đã tìm được một mục đích mới cho chúng: ẩn mã độc bên trong chính QR code.

Tuần này, Socket Threat Research Team đã xác định một gói độc hại, 'fezbox'_,_ được xuất bản lên npmjs.com, kho mã nguồn mở lớn nhất thế giới cho các nhà phát triển JavaScript và Node.js.

Gói bất hợp pháp chứa chỉ dẫn ẩn để tải xuống một ảnh JPG chứa QR code, sau đó nó có thể xử lý tiếp để chạy một payload obfuscated giai đoạn hai như một phần của cuộc tấn công.

Tại thời điểm viết bài, gói này đã nhận ít nhất 327 lượt tải xuống, theo npmjs.com, trước khi quản trị viên registry gỡ bỏ nó.

![fezbox malicious package on npmjs.com](https://www.bleepstatic.com/images/news/u/1164866/2025/Sep/fezbox-qr/fezbox.jpg)

**fezbox malicious package on npmjs.com** (BleepingComputer)

## URL độc hại được lưu ngược để né kiểm tra

BleepingComputer xác nhận rằng payload độc hại chủ yếu nằm trong file [_dist/fezbox.cjs_](https://socket.dev/npm/package/fezbox/files/1.3.0/dist/fezbox.cjs) của gói (lấy version 1.3.0 làm ví dụ).

"Code tự nó được minify trong file. Khi được format lại, nó trở nên dễ đọc hơn," [giải thích](https://socket.dev/blog/malicious-fezbox-npm-package-steals-browser-passwords-from-cookies-via-innovative-qr-code) nhà phân tích mối đe dọa Socket Olivia Brown.

Các điều kiện trong code kiểm tra xem ứng dụng có đang chạy trong môi trường phát triển hay không, như Brown đã giải thích.

"Đây thường là một thủ thuật ẩn mình. Tác nhân đe dọa không muốn bị phát hiện trong môi trường ảo hoặc bất kỳ môi trường không phải sản xuất nào, vì vậy họ thường thêm các rào chắn xung quanh khi và cách khai thác của họ chạy," nhà nghiên cứu cho biết.

"Ngoài ra, sau 120 giây, nó phân tích và thực thi code từ một QR code tại chuỗi được đảo ngược..."

![Malicious link stored backwards in the CJS file](https://www.bleepstatic.com/images/news/u/1164866/2025/Sep/fezbox-qr/fezbox-hidden-link.jpg)

**Malicious link stored backwards in the CJS file** (BleepingComputer)

Chuỗi hiển thị trong ảnh chụp màn hình ở trên, khi lật lại, trở thành:

hxxps://res[.]cloudinary[.]com/dhuenbqsq/image/upload/v1755767716/b52c81c176720f07f702218b1bdc7eff_h7f6pn.jpg

Lưu URL theo chiều ngược là một kỹ thuật tàng hình được sử dụng bởi kẻ tấn công để vượt qua các công cụ phân tích tĩnh tìm kiếm các URL (bắt đầu bằng 'http(s)://') trong code, Brown giải thích.

QR code được trả về bởi URL được trình bày dưới đây:

**QR code returned by the malicious URL** (Socket)

Khác với các QR code mà chúng ta thường thấy trong tiếp thị hoặc môi trường kinh doanh, QR này có mật độ dữ liệu cao bất thường, chứa nhiều dữ liệu hơn bình thường. Thực tế, trong các thử nghiệm của BleepingComputer, nó không thể đọc đáng tin cậy bằng camera điện thoại tiêu chuẩn. Các tác nhân đe dọa đã thiết kế đặc biệt mã vạch này để gửi mã obfuscated có thể được package phân tích.

Payload obfuscated, nhà nghiên cứu giải thích, sẽ đọc một cookie thông qua _document.cookie_.

"Sau đó nó lấy username và password, mặc dù một lần nữa chúng ta thấy thủ thuật obfuscation là đảo chuỗi (drowssap trở thành password)."

"Nếu có cả username và password trong cookie bị đánh cắp, nó gửi thông tin qua một yêu cầu HTTPS POST tới _https://my-nest-app-production\[.\]up\[.\]railway\[.\]app/users_. Nếu không, nó không làm gì và thoát im lặng."

Chúng ta đã thấy vô số trường hợp QR code được triển khai trong các chiêu trò tấn công xã hội—từ khảo sát giả tới "vé đậu xe" giả—nhưng những trường hợp này yêu cầu can thiệp của con người, tức là quét mã và bị dẫn tới một trang lừa đảo, ví dụ.

Phát hiện tuần này của Socket cho thấy một biến thể khác của QR code: một máy bị xâm nhập có thể sử dụng chúng để giao tiếp với máy chủ command-and-control (C2) theo cách mà, đối với một proxy hoặc công cụ bảo mật mạng, có thể trông chỉ như lưu lượng ảnh thông thường.

Trong khi steganography truyền thống thường ẩn mã độc bên trong hình ảnh, file media, hoặc metadata, phương pháp này đi xa hơn một bước, cho thấy các tác nhân đe dọa sẽ khai thác bất kỳ phương tiện nào có sẵn.