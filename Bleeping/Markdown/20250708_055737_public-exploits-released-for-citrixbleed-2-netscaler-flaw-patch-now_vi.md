# Các lỗ hổng công khai được phát hành cho lỗi CitrixBleed 2 NetScaler, hãy vá ngay

![Citrix](https://www.bleepstatic.com/content/hl-images/2023/07/20/Citrix-headpic.jpg)

Các nhà nghiên cứu đã phát hành các exploit proof-of-concept (PoC) cho một lỗ hổng nghiêm trọng trên Citrix NetScaler, được theo dõi với mã CVE-2025-5777 và được gọi là CitrixBleed2, cảnh báo rằng lỗ hổng này dễ dàng bị khai thác và có thể đánh cắp thành công các token phiên người dùng.

Lỗ hổng CitrixBleed 2, ảnh hưởng đến các thiết bị Citrix NetScaler ADC và Gateway, cho phép kẻ tấn công truy suất nội dung bộ nhớ chỉ bằng cách gửi các yêu cầu POST bị định dạng sai trong quá trình cố gắng đăng nhập.

Lỗi này được đặt tên là CitrixBleed2 vì nó có điểm tương đồng với lỗi [CitrixBleed](https://www.bleepingcomputer.com/news/security/citrix-bleed-exploit-lets-hackers-hijack-netscaler-accounts/) (CVE-2023-4966) gốc từ năm 2023, đã bị [các băng nhóm ransomware khai thác](https://www.bleepingcomputer.com/news/security/lockbit-ransomware-exploits-citrix-bleed-in-attacks-10k-servers-exposed/) và trong [các cuộc tấn công vào chính phủ](https://www.bleepingcomputer.com/news/security/hackers-use-citrix-bleed-flaw-in-attacks-on-govt-networks-worldwide/) để chiếm đoạt phiên người dùng và xâm nhập vào các mạng lưới.

Trong các phân tích kỹ thuật được công bố lần đầu bởi watchTowr và sau đó là Horizon3, các nhà nghiên cứu xác nhận rằng lỗ hổng có thể bị khai thác bằng cách gửi một yêu cầu đăng nhập không chính xác, trong đó tham số login= được sửa đổi để gửi mà không có dấu "=" hoặc giá trị.

Điều này khiến thiết bị NetScaler hiển thị nội dung bộ nhớ cho đến ký tự null đầu tiên trong phần <InitialValue></InitialValue> của phản hồi, như được minh họa bên dưới.

![Đọc dữ liệu từ bộ nhớ với yêu cầu đăng nhập NetScaler không hợp lệ](https://www.bleepstatic.com/images/news/security/vulnerabilities/c/citrixbleed2/watchtowr-demonstration.png)

**Đọc dữ liệu từ bộ nhớ với yêu cầu đăng nhập NetScaler không hợp lệ**  
_Nguồn: WatchTowr_

Lỗi này là do việc sử dụng hàm `snprintf` cùng với một chuỗi định dạng chứa chuỗi định dạng `%.*s`.

"Chuỗi định dạng %.*s cho hàm snprintf: “In ra tối đa N ký tự, hoặc dừng lại tại byte null đầu tiên (\\0) - cái nào đến đầu tiên.” Byte null cuối cùng cũng xuất hiện đâu đó trong bộ nhớ, vì vậy trong khi việc rò rỉ không chạy vô hạn, bạn vẫn nhận được một số byte với mỗi lần gọi," theo báo cáo của [watchTowr](https://labs.watchtowr.com/how-much-more-must-we-bleed-citrix-netscaler-memory-disclosure-citrixbleed-2-cve-2025-5777/).

"Vì vậy, mỗi khi bạn truy cập vào endpoint đó mà không có dấu '=', bạn sẽ lấy thêm dữ liệu ngăn xếp chưa được khởi tạo vào phản hồi."

Theo [Horizon3](https://horizon3.ai/attack-research/attack-blogs/cve-2025-5777-citrixbleed-2-write-up-maybe/), mỗi yêu cầu rò rỉ khoảng 127 byte dữ liệu từ bộ nhớ, cho phép kẻ tấn công thực hiện các yêu cầu HTTP lặp đi lặp lại để trích xuất thêm nội dung bộ nhớ cho đến khi họ tìm thấy dữ liệu nhạy cảm mà họ đang tìm kiếm.

Trong khi các nỗ lực của WatchTowr không thành công, Horizon3 đã chứng minh trong video dưới đây rằng họ có thể khai thác lỗi này để đánh cắp các token phiên người dùng.

Ngoài các điểm cuối NetScaler, Horizon3 cho biết rằng lỗi này cũng có thể bị khai thác đối với các công cụ cấu hình được sử dụng bởi các quản trị viên.

## Có bị khai thác hay không?

Citrix vẫn khẳng định rằng lỗ hổng này không đang bị khai thác tích cực, và khi BleepingComputer trước đó đã hỏi về tình trạng của nó, công ty đã dẫn chúng tôi đến một [bài đăng blog](http://Citrix%20has%20not%20acknowledged%20any%20exploitation%20of%20the%20flaw%20and%20did%20not%20respond%20to%20our%20questions%20about%20its%20status,%20instead%20referring%20us%20back%20to%20a%20blog%20post%20about%20the%20vulnerability.) về lỗ hổng.

"Hiện tại, không có bằng chứng nào cho thấy việc khai thác **CVE-2025-5777**," bài đăng blog viết.

Tuy nhiên, một báo cáo tháng Sáu của công ty an ninh mạng ReliaQuest cho thấy có bằng chứng cho thấy CVE-2025-5777 có thể đã bị khai thác trong các cuộc tấn công, với công ty đã thấy sự gia tăng trong các vụ chiếm đoạt phiên người dùng.

Hơn nữa, nhà nghiên cứu an ninh [Kevin Beaumont phản bác tuyên bố của Citrix](https://infosec.exchange/@GossiTheDog@cyberplace.social/114811856550190017), nói rằng lỗ hổng đã bị khai thác tích cực từ giữa tháng Sáu, với kẻ tấn công lợi dụng lỗi này để trút rò rỉ bộ nhớ và chiếm đoạt các phiên.

Ông đã nêu bật các chỉ số thỏa hiệp sau đây:

* Trong các nhật ký Netscaler, các yêu cầu POST lặp lại đến \*doAuthentication\* - mỗi yêu cầu cho ra 126 byte RAM
* Trong các nhật ký Netscaler, các yêu cầu đến doAuthentication.do với "Content-Length: 5"
* Trong các nhật ký người dùng Netscaler, các dòng có \*LOGOFF\* và user = "\*#\*" (tức là ký tự # trong tên người dùng). RAM bị phối vào trường sai.

"Đáng chú ý là tôi chỉ có thể tìm thấy hoạt động khai thác nhờ vào các bài viết của WatchTowr và Horizon3," ông cảnh báo.

"Hỗ trợ của Citrix không tiết lộ bất kỳ IOC nào và đã sai lầm khi tuyên bố (một lần nữa — đã xảy ra với CitrixBleed) rằng không có khai thác nào \[đang\] diễn ra. Citrix cần phải cải thiện điều này, họ đang gây hại cho khách hàng."

Citrix đã phát hành các bản vá để khắc phục CVE-2025-5777, và tất cả các tổ chức đều được khuyến nghị áp dụng chúng ngay lập tức khi các exploit công khai đã có.

Mặc dù Citrix khuyến nghị chấm dứt tất cả các phiên ICA và PCoIP đang hoạt động, các quản trị viên nên đầu tiên xem xét lại các phiên hiện có để tìm kiếm bất kỳ hoạt động đáng nghi ngờ trước khi thực hiện điều này.