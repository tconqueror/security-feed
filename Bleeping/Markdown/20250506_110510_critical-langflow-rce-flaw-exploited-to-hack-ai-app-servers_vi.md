# Lỗ hổng RCE quan trọng của Langflow bị khai thác để hack máy chủ ứng dụng AI

![CISA](https://www.bleepstatic.com/content/hl-images/2024/01/17/CISA.jpg)

Cơ quan An ninh mạng và Cơ sở hạ tầng Hoa Kỳ (CISA) đã ghi nhận một lỗ hổng thực thi mã từ xa (RCE) trong Langflow là đang bị khai thác tích cực, kêu gọi các tổ chức áp dụng các bản cập nhật bảo mật và biện pháp giảm thiểu càng sớm càng tốt.

Lỗ hổng này được theo dõi là CVE-2025-3248 và là một lỗ hổng RCE quan trọng không yêu cầu xác thực, cho phép bất kỳ kẻ tấn công nào trên internet chiếm hoàn toàn quyền kiểm soát các máy chủ Langflow bị tổn thương bằng cách khai thác một lỗ hổng ở điểm cuối API.

Langflow là một công cụ lập trình trực quan mã nguồn mở để xây dựng các quy trình làm việc sử dụng LLM thông qua các thành phần LangChain. Nó cung cấp một giao diện kéo và thả để tạo, thử nghiệm và triển khai các tác nhân hoặc pipeline AI mà không cần viết mã backend hoàn chỉnh.

Công cụ này, có gần 60.000 sao và 6.300 fork trên GitHub, được các nhà phát triển AI, nhà nghiên cứu và các công ty khởi nghiệp sử dụng để tạo mẫu chatbot, pipeline dữ liệu, hệ thống tác nhân và các ứng dụng AI.

Langflow tiết lộ một điểm cuối (/api/v1/validate/code) được thiết kế để xác thực mã do người dùng gửi. Trong các phiên bản bị tổn thương, điểm cuối này không an toàn khi sandbox hoặc vệ sinh đầu vào, cho phép một kẻ tấn công gửi mã độc đến điểm cuối đó và thực thi trực tiếp trên máy chủ.

CVE-2025-3248 đã được khắc phục trong [phiên bản 1.3.0](https://github.com/langflow-ai/langflow/releases/tag/1.3.0), phát hành vào ngày 1 tháng 4 năm 2025, vì vậy được khuyến nghị nâng cấp lên phiên bản đó hoặc phiên bản sau để giảm thiểu các rủi ro phát sinh từ lỗ hổng này.

Bản vá [là tối thiểu](https://github.com/langflow-ai/langflow/pull/6911), chỉ thêm xác thực cho điểm cuối bị tổn thương, không bao gồm việc sandbox hay củng cố.

Phiên bản Langflow mới nhất, [1.4.0](https://github.com/langflow-ai/langflow/releases/tag/1.4.0), đã được phát hành vào ngày hôm nay và chứa một danh sách dài các bản sửa lỗi, vì vậy người dùng nên nâng cấp lên phiên bản này.

Các nhà nghiên cứu của Horizon3 đã xuất bản một [bài viết kỹ thuật chi tiết](https://horizon3.ai/attack-research/disclosures/unsafe-at-any-speed-abusing-python-exec-for-unauth-rce-in-langflow-ai/) về lỗ hổng vào ngày 9 tháng 4 năm 2025, bao gồm một khai thác proof-of-concept.

Các nhà nghiên cứu đã cảnh báo về khả năng cao bị khai thác đối với CVE-2025-3248, xác định ít nhất 500 phiên bản bị lộ trên internet vào thời điểm đó.

![Khai thác PoC của Horizon3 đang hoạt động](https://www.bleepstatic.com/images/news/u/1220909/2025/May/poc.jpg)

**Khai thác PoC của Horizon3 đang hoạt động**  
_Nguồn: Horizon3_

Những ai không thể nâng cấp lên phiên bản an toàn ngay lập tức được khuyên hạn chế quyền truy cập mạng vào Langflow bằng cách đặt nó sau một tường lửa, proxy đảo ngược có xác thực hoặc VPN. Ngoài ra, cũng không được khuyến nghị để nó tiếp xúc trực tiếp với internet.

CISA đã [cung cấp cho các cơ quan liên bang](http://www.cisa.gov/news-events/alerts/2025/05/05/cisa-adds-one-known-exploited-vulnerability-catalog) thời hạn đến ngày 26 tháng 5 năm 2025 để áp dụng bản cập nhật bảo mật hoặc các biện pháp giảm thiểu hoặc ngừng sử dụng phần mềm này.

CISA chưa cung cấp bất kỳ chi tiết cụ thể nào về hoạt động khai thác đã được quan sát và cho biết hiện chưa rõ liệu các nhóm tấn công ransomware có đang khai thác lỗ hổng này hay không.

Đối với người dùng Langflow, điều quan trọng là phải ghi nhớ những nhận xét của Horizon3 về thiết kế của công cụ, mà theo họ, có phân tách đặc quyền kém, không có sandbox và có lịch sử về các lỗ hổng RCE "theo thiết kế" do tính chất và chức năng dự kiến của nó.

CVE-2025-3248 là lỗ hổng RCE không yêu cầu xác thực đầu tiên thực sự trong Langflow, và với tình trạng khai thác tích cực của nó, hành động ngay lập tức là cần thiết.