# Đội ngũ gián điệp mạng Curly COMrades tấn công các tổ chức chính phủ bằng malware tùy chỉnh

![đội ngũ gián điệp mạng Curly COMrades tấn công các tổ chức chính phủ bằng malware tùy chỉnh](https://www.bleepstatic.com/content/hl-images/2025/02/11/intelligence.jpg)

Một nhóm đe dọa gián điệp mạng mới đã sử dụng malware backdoor mới cung cấp quyền truy cập bền bỉ thông qua một tác vụ được lên lịch có vẻ không hoạt động.

Các hoạt động của tác nhân đe dọa có vẻ như hỗ trợ lợi ích của Nga bằng cách nhắm mục tiêu vào các cơ quan chính phủ và tư pháp ở Georgia, và các công ty năng lượng ở Moldova.

Tác nhân tấn công hiện đang được theo dõi là Curly COMrades và đã hoạt động từ giữa năm 2024, sử dụng một thành phần malware ba giai đoạn tùy chỉnh mà các nhà nghiên cứu gọi là MucorAgent.

## Chuỗi tấn công của Curly COMrades

Trong một báo cáo hôm nay, công ty an ninh mạng Bitdefender mô tả MucorAgent là một phần mềm độc hại “phức tạp” được “thiết kế như một công cụ .NET kín đáo có khả năng thực thi một tập lệnh PowerShell được mã hóa bằng AES và tải kết quả đầu ra lên một máy chủ đã chỉ định.”

Các nhà nghiên cứu đã đặt tên cho tác nhân đe dọa là Curly COMrades do việc sử dụng nặng nề công cụ curl.exe để lấy dữ liệu và giao tiếp với máy chủ chỉ huy và kiểm soát (C2), và do việc chiếm đoạt các đối tượng Component Object Model (COM) trong suốt cuộc tấn công.

Mặc dù không tìm thấy sự trung hợp mạnh mẽ với các nhóm APT của Nga đã biết, các nhà nghiên cứu nói rằng các hoạt động của nhóm “phù hợp với các mục tiêu địa chính trị của Liên bang Nga.”

Các nhà nghiên cứu không thể xác định vectơ truy cập ban đầu nhưng đã quan sát thấy việc cài đặt nhiều proxy agent, bao gồm Resocks dựa trên Go, trên các hệ thống nội bộ.

Resocks được lấy qua curl.exe và được đăng ký như các tác vụ đã lên lịch hoặc dịch vụ Windows để bền bỉ, giao tiếp với C2 qua TCP 443 hoặc 8443.

Để đảm bảo tính dự phòng, các hacker cũng triển khai các máy chủ SOCKS5 tùy chỉnh và SSH + Stunnel để chuyển tiếp cổng từ xa.

Một số kết nối SSH được định tuyến qua một công cụ tùy chỉnh, CurlCat, sử dụng thư viện _libcurl_ và một bảng chữ cái Base64 tùy chỉnh để làm mờ lưu lượng bằng cách chuyển tiếp qua các trang web hợp pháp đã bị xâm nhập.

![Mạng A (tác nhân tấn công), Mạng B (nạn nhân)](https://www.bleepstatic.com/images/news/u/1220909/2025/August/resocks.jpg)

**Mạng A (tác nhân tấn công), Mạng B (nạn nhân)**  
_Nguồn: Bitdefender_

### Cơ chế bền bỉ không nhất quán

Bitdefender lưu ý rằng cơ chế bền bỉ mà họ phát hiện là một cơ chế không nhất quán vì nó được thực hiện bằng cách chiếm đoạt các CLSID để nhắm đến NGEN (Native Image Generator).

NGEN là một thành phần mặc định của Windows .NET Framework để biên dịch trước các assembly, và có thể cung cấp tính bền bỉ thông qua một tác vụ đã lên lịch bị tắt.

Tuy nhiên, ngay cả khi tác vụ có vẻ không hoạt động, hệ điều hành vẫn cho phép và thực thi nó ở các khoảng thời gian ngẫu nhiên (ví dụ: thời gian nhàn rỗi, khi triển khai một ứng dụng mới), các nhà nghiên cứu giải thích.

“Với sự khó lường này, có thể rằng tồn tại một cơ chế thứ cấp, đáng dự đoán hơn để thực thi tác vụ cụ thể này” - [Bitdefender](https://businessinsights.bitdefender.com/curly-comrades-new-threat-actor-targeting-geopolitical-hotbeds)

Trong một số trường hợp, các kẻ tấn công cũng cài đặt phần mềm giám sát từ xa hợp pháp, Remote Utilities (RuRat), để duy trì quyền kiểm soát tương tác.

Ngoài ra, họ đã sử dụng công cụ Remote Monitoring and Management (RMM), một tiện ích hợp pháp được sử dụng rộng rãi bởi các chuyên gia CNTT để giám sát, quản lý và bảo trì tài sản CNTT của khách hàng, chẳng hạn như máy chủ, máy tính để bàn và thiết bị di động.

### Backdoor MucorAgent .NET kín đáo

Backdoor MucorAgent bao gồm ba thành phần, có thể chiếm đoạt một trình xử lý COM hợp pháp và tải lên một giai đoạn .NET thứ hai thực thi một thành phần để vượt qua Giao diện Quét phần mềm độc hại (AMSI) trong Windows.

Gói thứ ba tìm kiếm ở các vị trí cụ thể cho các tệp index.png và icon.png, đó là các khối dữ liệu được mã hóa (có thể là tập lệnh) được tải xuống từ các trang web đã bị xâm nhập.

Theo Bitdefender, kẻ tấn công đã thu thập thông tin xác thực hợp lệ, có thể nhằm mục đích di chuyển xung quanh mạng, đánh cắp và khai thác dữ liệu.

Họ lưu ý rằng tác nhân đe dọa “đã nhiều lần cố gắng lấy cơ sở dữ liệu NTDS từ các bộ điều khiển miền” và “đã thử nghiệm để dump bộ nhớ LSASS từ các hệ thống cụ thể để phục hồi các thông tin xác thực người dùng đang hoạt động.”

Bitdefender cũng đã quan sát thấy việc thực thi các lệnh living-off-the-land như netstat, tasklist, systeminfo, wmic và ipconfig, cùng với các cmdlet liệt kê Active Directory PowerShell, và các script batch được sử dụng cho tự động hóa.

Mặc dù các hoạt động của Curly COMrades là một phần của một chiến dịch gián điệp lớn hơn, các nhà nghiên cứu nhấn mạnh rằng tác nhân đe dọa đã bỏ ra nỗ lực lớn để duy trì quyền truy cập vào mục tiêu.

Tuy nhiên, mặc dù sử dụng các LOLbins và công cụ mã nguồn mở hòa trộn tốt với lưu lượng thông thường, và cơ chế bền bỉ thông minh, các động thái độc hại của nhóm vẫn tạo ra âm thanh đủ để bị các cảm biến EDR/XDR hiện đại phát hiện.