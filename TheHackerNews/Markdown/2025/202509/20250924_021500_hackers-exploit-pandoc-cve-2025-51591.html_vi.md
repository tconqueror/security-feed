# Tin tặc lợi dụng Pandoc CVE-2025-51591 để nhắm vào AWS IMDS và đánh cắp thông tin đăng nhập IAM của EC2

[](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgcKyurAVwFl0xbW7fxmPHdNxWeLJgY1Yae%5Fr4IUGEvwD8a0825wBZI1ntXPxDQhyphenhyphenEgh7Z-mVsIjOCPPsb9Both7X-Qp9fvn6CS-2zXBQcRP5i55%5F6Zh89eY9LFRBQ1Ac6Cov-299GYptQgS59qKr%5FjDculJRDg94OoGe1PAHwe3MR5Poy3nKqQ7Fe0ydfU/s728-rw-e365/aws-hack.jpg)

Công ty bảo mật đám mây Wiz đã [tiết lộ](https://www.wiz.io/blog/imds-anomaly-hunting-zero-day) rằng họ phát hiện các vụ khai thác thực tế của một lỗ hổng trong tiện ích Linux có tên **Pandoc** như một phần của các cuộc tấn công nhằm xâm nhập vào Amazon Web Services (AWS) Instance Metadata Service (IMDS).

Lỗ hổng được đề cập là **[CVE-2025-51591](https://nvd.nist.gov/vuln/detail/CVE-2025-51591)** (điểm CVSS: 6.5), liên quan đến một trường hợp Server-Side Request Forgery (SSRF) cho phép kẻ tấn công xâm phạm hệ thống mục tiêu bằng cách chèn một phần tử HTML iframe được chế tạo đặc biệt.

[EC2 IMDS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html) là một thành phần quan trọng của môi trường đám mây AWS, cung cấp thông tin về các phiên bản đang chạy, cũng như thông tin xác thực tạm thời có thời hạn ngắn nếu một vai trò identity and access management (IAM) được gán cho phiên bản. Metadata của phiên bản có thể được truy cập bởi bất kỳ ứng dụng nào chạy trên một phiên bản EC2 thông qua địa chỉ link-local (169.254.169[.]254).

Những thông tin đăng nhập này sau đó có thể được sử dụng để tương tác an toàn với các dịch vụ AWS khác như S3, RDS, hoặc DynamoDB, cho phép ứng dụng xác thực mà không cần lưu trữ thông tin đăng nhập trên máy, từ đó giảm rủi ro phơi bày không cố ý.

Một trong những [phương pháp phổ biến](https://securitylabs.datadoghq.com/articles/misconfiguration-spotlight-imds/) mà kẻ tấn công có thể dùng để đánh cắp thông tin đăng nhập IAM từ IMDS là thông qua các lỗ hổng SSRF trong các ứng dụng web. Điều này về cơ bản liên quan đến việc lừa ứng dụng chạy trên một phiên bản EC2 gửi yêu cầu truy vấn thông tin đăng nhập IAM từ dịch vụ IMDS thay cho kẻ tấn công.

[](https://thehackernews.uk/exec-guide-d)

"Nếu ứng dụng có thể tiếp cận endpoint IMDS và dễ bị SSRF, kẻ tấn công có thể thu thập các thông tin đăng nhập tạm thời mà không cần truy cập trực tiếp vào host (như RCE hoặc path traversal)," các nhà nghiên cứu của Wiz, Hila Ramati và Gili Tikochinski, cho biết.

Do đó, một kẻ thủ có ý định nhắm vào hạ tầng AWS có thể tìm kiếm các lỗ hổng SSRF trong các ứng dụng web chạy trên các phiên bản EC2 và, khi tìm được, truy cập metadata của phiên bản và đánh cắp thông tin đăng nhập IAM. Đây không phải là một mối đe dọa mang tính lý thuyết.

Ngay từ đầu năm 2022, Mandiant thuộc Google đã [phát hiện](https://cloud.google.com/blog/topics/threat-intelligence/cloud-metadata-abuse-unc2903/) rằng một tác nhân đe dọa mà họ theo dõi với tên UNC2903 đã tấn công các môi trường AWS bằng cách lạm dụng các thông tin đăng nhập thu được thông qua IMDS từ tháng 7 năm 2021, khai thác một lỗi SSRF ([CVE-2021-21311](https://nvd.nist.gov/vuln/detail/cve-2021-21311), điểm CVSS: 7.2) trong Adminer, một công cụ quản lý cơ sở dữ liệu mã nguồn mở, để hỗ trợ việc đánh cắp dữ liệu.

Vấn đề, về cơ bản, bắt nguồn từ việc IMDS, hay cụ thể hơn là IMDSv1, là một giao thức yêu cầu và phản hồi, khiến nó trở thành một mục tiêu hấp dẫn cho những kẻ xấu nhắm vào các ứng dụng web có thể bị khai thác và cũng chạy IMDSv1.

Trong một báo cáo được công bố tháng trước, Resecurity cảnh báo rằng khi SSRF bị khai thác chống lại hạ tầng đám mây như AWS, nó có thể gây ra hậu quả "nghiêm trọng và kéo dài", dẫn đến việc đánh cắp thông tin đăng nhập đám mây, trinh sát mạng và truy cập trái phép vào các dịch vụ nội bộ.

"Vì SSRF phát sinh từ bên trong máy chủ, nó có thể tiếp cận các endpoint được bảo vệ bởi tường lửa biên. Điều này về cơ bản biến ứng dụng dễ bị tổn thương thành một proxy, cho phép kẻ tấn công: Vượt qua danh sách trắng IP [và] tiếp cận các tài nguyên nội bộ không thể truy cập được," họ [nói](https://www.resecurity.com/blog/article/ssrf-to-aws-metadata-exposure-how-attackers-steal-cloud-credentials).

Những phát hiện mới nhất từ Wiz cho thấy các cuộc tấn công nhắm vào dịch vụ IMDS vẫn tiếp tục diễn ra, khi kẻ tấn công lợi dụng các lỗ hổng SSRF trong những ứng dụng ít được biết đến như Pandoc để thực hiện.

"Lỗ hổng, được theo dõi là CVE-2025-51591, phát sinh từ việc Pandoc hiển thị thẻ <iframe> trong các tài liệu HTML," các nhà nghiên cứu của Wiz cho biết. "Điều này cho phép kẻ tấn công chế tạo một <iframe> trỏ tới server IMDS, hoặc các tài nguyên riêng tư khác."

"Kẻ tấn công đã gửi các tài liệu HTML được chế tạo chứa các phần tử <iframe> mà thuộc tính src nhắm tới endpoint AWS IMDS tại 169.254.169\[.\]254\. Mục tiêu là hiển thị và chiết xuất nội dung của các đường dẫn nhạy cảm, cụ thể là /latest/meta-data/iam/info và /latest/meta-data/iam."

Wiz cho biết cuộc tấn công cuối cùng đã không thành công do việc áp dụng [IMDSv2](https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service/), vốn theo hướng phiên làm việc và giảm thiểu tấn công SSRF bằng cách yêu cầu người dùng trước tiên lấy một token và sử dụng token đó trong tất cả các yêu cầu tới IMDS thông qua một header đặc biệt (X-aws-ec2-metadata-token).

[](https://thehackernews.uk/cis-security-suite)

Công ty nói với The Hacker News rằng họ quan sát thấy các nỗ lực khai thác "trong tự nhiên" từ "bắt đầu từ tháng Tám và tiếp diễn trong vài tuần," và thêm rằng họ cũng tìm thấy những nỗ lực liên tục từ các tác nhân mối đe dọa không rõ danh tính nhằm lạm dụng một lỗ hổng SSRF khác trong ClickHouse để tấn công không thành công vào môi trường Google Cloud Platform của một mục tiêu.

Để giảm thiểu rủi ro do CVE-2025-51591 gây ra trong môi trường đám mây, người ta khuyến nghị [sử dụng](https://github.com/jgm/pandoc/commit/67edf7ce7cd3563a180ae44bd122b012e22364f8) tùy chọn "-f html+raw\_html" hoặc tùy chọn "--sandbox" để ngăn Pandoc bao gồm nội dung của các phần tử iframe thông qua thuộc tính src.

"[Pandoc maintainers] quyết định rằng việc hiển thị iframe là hành vi mong đợi và người dùng chịu trách nhiệm hoặc là làm sạch đầu vào hoặc sử dụng các cờ sandbox khi xử lý đầu vào từ người dùng," Wiz nói.

"Mặc dù Amazon khuyến nghị triển khai IMDSv2 với các cải tiến GuardDuty, các phiên bản EC2 được tạo bởi khách hàng Amazon mà thay vào đó sử dụng IMDSv1 có thể gặp rủi ro khi kết hợp với việc chạy phần mềm bên thứ ba dễ bị tấn công chưa được vá," các nhà nghiên cứu Mandiant đã cảnh báo vào thời điểm đó.

Các tổ chức được khuyến nghị thực thi IMDSv2 trên tất cả các phiên bản EC2 và đảm bảo rằng các phiên bản được gán các vai trò tuân thủ nguyên tắc quyền ít nhất (PoLP) để giới hạn phạm vi ảnh hưởng trong trường hợp IMDS bị xâm phạm.