# BadIIS Malware Spreads via SEO Poisoning — Redirects Traffic, Plants Web Shells

[](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEirdKfCc8HShMN7EGpgQG5yltyAaQJauvEcasz01SXuoSQ8wd6eCr8dTYDTvo1H4XDpfZ4iaGshW7IXhHa2CmHi4m73apl6FFJs9swY03Fqaz-SlqTVthbxaRu9Vsbba-GhWkqCg7yCk%5FWmu2fIyBplzyVI1pHBJtMm-%5FcGmWhtzhd4a7PrXbmgat14nzgG/s728-rw-e365/seo-malware.jpg)

Các nhà nghiên cứu an ninh mạng đang cảnh báo về một chiến dịch đầu độc công cụ tìm kiếm (SEO poisoning) có khả năng được thực hiện bởi một tác nhân đe dọa nói tiếng Trung sử dụng phần mềm độc hại có tên **BadIIS** trong các cuộc tấn công nhắm vào Đông và Đông Nam Á, đặc biệt tập trung vào Việt Nam.

Hoạt động này, được gọi là **Operation Rewrite**, đang được Palo Alto Networks Unit 42 theo dõi dưới bí danh CL-UNK-1037, trong đó "CL" đại diện cho cluster và "UNK" ám chỉ động cơ không rõ ràng. Tác nhân đe dọa này được phát hiện có dùng chung cơ sở hạ tầng và có những điểm trùng lặp về kiến trúc với một thực thể được ESET gọi là [Group 9](https://thehackernews.com/2021/08/several-malware-families-targeting-iis.html) và [DragonRank](https://thehackernews.com/2025/02/dragonrank-exploits-iis-servers-with.html).

"Để thực hiện đầu độc SEO, kẻ tấn công thao túng kết quả của công cụ tìm kiếm nhằm lừa người dùng truy cập vào các trang web không mong muốn hoặc bất ngờ (ví dụ: các trang cờ bạc và khiêu dâm) để thu lợi về tài chính," nhà nghiên cứu an ninh Yoav Zemah [cho biết](https://unit42.paloaltonetworks.com/operation-rewrite-seo-poisoning-campaign/). "Cuộc tấn công này sử dụng một module gốc của Internet Information Services ([IIS](https://learn.microsoft.com/en-us/iis/get-started/introduction-to-iis/iis-modules-overview)) độc hại có tên BadIIS."

[](https://thehackernews.uk/exec-guide-d)

BadIIS được thiết kế để chặn và sửa đổi lưu lượng HTTP đến với mục tiêu cuối cùng là phục vụ nội dung độc hại cho khách truy cập trang bằng cách tận dụng các máy chủ hợp lệ đã bị xâm phạm. Nói cách khác, ý tưởng là thao túng kết quả công cụ tìm kiếm để điều hướng lưu lượng tới một đích họ chọn bằng cách chèn từ khóa và cụm từ vào các trang web hợp pháp có độ uy tín tên miền cao.

Module IIS này được trang bị khả năng đánh dấu khách truy cập có xuất xứ từ trình thu thập dữ liệu của công cụ tìm kiếm bằng cách kiểm tra header User-Agent trong yêu cầu HTTP, cho phép nó liên hệ với một máy chủ bên ngoài để lấy nội dung bị đầu độc nhằm thay đổi SEO và khiến công cụ tìm kiếm lập chỉ mục trang bị tổn hại như một kết quả phù hợp cho các thuật ngữ được trả về trong phản hồi từ máy chủ command-and-control (C2).

Khi các trang đã bị đầu độc theo cách này, tất cả những gì cần làm để hoàn tất kế hoạch là làm cho nạn nhân tìm kiếm các thuật ngữ đó trên công cụ tìm kiếm và cuối cùng nhấp vào trang hợp pháp nhưng đã bị xâm phạm, dẫn đến việc chuyển hướng họ tới một trang lừa đảo thay vào đó.

Trong ít nhất một sự cố do Unit 42 điều tra, các kẻ tấn công được cho là đã lợi dụng quyền truy cập vào một trình thu thập dữ liệu của công cụ tìm kiếm để luân chuyển sang các hệ thống khác, tạo tài khoản người dùng cục bộ mới và thả web shell nhằm thiết lập truy cập từ xa bền vững, trích xuất mã nguồn và tải lên các implant BadIIS.

"Cơ chế trước tiên xây dựng mồi rồi mới bật bẫy," Unit 42 cho biết. "Mồi được xây dựng bằng cách kẻ tấn công cung cấp nội dung bị thao túng cho các trình thu thập dữ liệu của công cụ tìm kiếm. Điều này khiến trang web bị xâm phạm xếp hạng cho các thuật ngữ bổ sung mà lẽ ra nó không liên quan. Máy chủ web bị xâm phạm sau đó đóng vai trò như một reverse proxy — một máy chủ trung gian lấy nội dung từ các máy chủ khác và trình bày nó như của chính nó."

Một số công cụ khác được các tác nhân đe dọa triển khai trong các cuộc tấn công bao gồm ba biến thể khác nhau của module BadIIS -

* Một bộ xử lý trang ASP.NET nhẹ đạt được cùng mục tiêu đầu độc SEO bằng cách proxy nội dung độc hại từ một máy chủ C2 từ xa
* Một module IIS quản lý .NET có thể kiểm tra và sửa đổi mọi yêu cầu đi qua ứng dụng để chèn các liên kết spam và từ khóa từ một máy chủ C2 khác, và
* Một script PHP tổng hợp tất cả kết hợp việc chuyển hướng người dùng và đầu độc SEO động

[](https://thehackernews.uk/cis-security-suite)

"Tác nhân đe dọa đã tùy biến tất cả các implant nhằm mục tiêu thao túng kết quả công cụ tìm kiếm và kiểm soát luồng lưu lượng," Unit 42 cho biết. "Chúng tôi đánh giá với độ tin cậy cao rằng một tác nhân nói tiếng Trung đang vận hành hoạt động này, dựa trên bằng chứng ngôn ngữ trực tiếp, cũng như các liên kết cơ sở hạ tầng và kiến trúc giữa tác nhân này và cụm Group 9."

Tiết lộ này được công bố vài tuần sau khi ESET mô tả một cụm mối đe dọa trước đây chưa được tài liệu hóa có tên [GhostRedirector](https://thehackernews.com/2025/09/ghostredirector-hacks-65-windows.html) đã xâm phạm ít nhất 65 máy chủ Windows chủ yếu đặt tại Brazil, Thailand, và Vietnam bằng một module IIS độc hại mang tên mã Gamshen để tạo điều kiện cho gian lận SEO.